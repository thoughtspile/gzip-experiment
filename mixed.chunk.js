(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{724:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(6),r=n.n(a),o=n(0),i=n.n(o),l=n(10),c=n.n(l),u=n(749),s={insert:"head",singleton:!1},d=(c()(u.a,s),u.a.locals,n(1)),_=n(20),m=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},f=function(e){var t=e.className,n=e.noShadow,a=e.noMargin,o=e.fixed,l=e.sticky,c=e.children,u=m(e,["className","noShadow","noMargin","fixed","sticky","children"]),s=Object(d.Ib)().viewWidth,f=Object(_.b)(s);return i.a.createElement("footer",r()({className:Object(d.Fb)(t,"ModalPageFooter",{"ModalPageFooter--shadow":!n,"ModalPageFooter--fixed":o&&!f,"ModalPageFooter--sticky":l})},u),i.a.createElement(d.r,{className:Object(d.Fb)("ModalPageFooter__in","ModalPageFooter__in--main",{"ModalPageFooter__in--margin":!a})},c),o&&!f&&i.a.createElement(d.r,{className:"ModalPageFooter__in ModalPageFooter__in--hidden"},c))},b=Object(o.memo)(f)},728:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(0),r=n.n(a),o=n(10),i=n.n(o),l=n(750),c={insert:"head",singleton:!1},u=(i()(l.a,c),l.a.locals,n(1)),s=n(739),d=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},_=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},m=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(e){var t=e.multiple,n=e.selectable,o=e.users,i=e.selectedUsers,l=e.disabledUsers,c=e.className,f=e.onSelectChange,b=e.onSelectUser,h=e.grouping,p=void 0===h||h,v=e.showHeaderSeparator,g=void 0===v||v,E=e.checkById,C=d(Object(a.useState)(new Set),2),y=C[0],O=C[1],j=d(Object(a.useState)(new Set(l||[])),1)[0],k=o.reduce((function(e,t){var n,a=null===(n=t.last_name[0])||void 0===n?void 0:n.toUpperCase();return a&&(e[a]||(e[a]=[]),e[a].push(t)),e}),{}),D=Object.keys(k).map((function(e){return{letter:e,users:k[e].sort((function(e,t){return e.last_name>t.last_name?1:-1}))}})).sort((function(e,t){return e.letter>t.letter?1:-1})),S=function(e){return function(){j.has(e)||(y.has(e)&&t?y.delete(e):(y.add(e),b&&b(e)),O(new Set(y)),f(_(y)))}},F=function(e){return function(){t||j.has(e)||(O(new Set([e])),f([e]),b&&b(e))}},x=function(e){var t,n,a=!1;try{for(var r=m(y.values()),o=r.next();!o.done;o=r.next()){o.value.id===e.id&&(a=!0)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return a};Object(a.useEffect)((function(){var e=new Set(i);O(e)}),[i]);var A=function(e){return e.map((function(e){return r.a.createElement(s.a,{key:e.id,user:e,onChange:S(e),onClick:F(e),selectable:n,multiple:t,checked:E?x(e):y.has(e),disabled:j.has(e)})}))};return r.a.createElement("div",{className:Object(u.Fb)(c,"UsersAlphabetList")},p?D.map((function(e,t){var n=e.letter,a=e.users;return r.a.createElement("section",{key:t,className:"UsersAlphabetList__group"},(g||!!t)&&r.a.createElement(u.kb,{wide:!0}),r.a.createElement(u.C,{weight:"medium",className:"UsersAlphabetList__header"},n),r.a.createElement("div",null,A(a)))})):A(o).map((function(e){return r.a.createElement("section",{key:e.key+"_no-group",className:Object(u.Fb)({UsersAlphabetList__group:t})},e)})))}},730:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s}));var a=n(60),r=function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};function i(e,t){var n=0,a=-1;return t.replace(/#/g,(function(t,r){return n>=e.length?"#":(a=r,e[n++])})).substring(0,a+1)}function l(e){if(void 0===e)return{from:"",to:""};var t=o(e,2),n=t[0],r=t[1];return{from:0===n?"0000":""+Object(a.j)(Math.floor(n/60))+Object(a.j)(n%60),to:0===r?"0000":""+Object(a.j)(Math.floor(r/60))+Object(a.j)(r%60)}}function c(e){return e?[60*(Number(e.from.substring(0,2))||0)+Number(e.from.slice(2)),60*(Number(e.to.substring(0,2))||0)+Number(e.to.slice(2))]:[0,0]}function u(e){return e?e.reduce((function(e,t){var n;return r(r({},e),((n={})[t.day_num]=[t.start,t.finish],n))}),{}):{}}function s(e){return e?Object.keys(e).map((function(t){var n=o(e[t],2),a=n[0],r=n[1];return{day_num:Number(t),start:a,finish:r}})):[]}},731:function(e,t,n){"use strict";function a(e){return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}function r(){var e=new Date;return e.setFullYear(e.getFullYear()-6),e}function o(e){if(!e||"0.0.0"===e)return{year:0,month:0,day:0};var t=e.split(".").map((function(e){return Number(e)}));return{year:t[2],month:t[1],day:t[0]}}function i(e){return e?e.day+"."+e.month+"."+e.year:""}n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}))},735:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};function o(e){var t,n=r(Object(a.useState)(e.defaultValue||""),2),o=n[0],i=n[1],l=Object(a.useRef)(e.value||e.defaultValue||""),c=Object(a.useRef)(e.hasOwnProperty("value"));Object(a.useEffect)((function(){void 0!==e.defaultValue&&l.current!==e.defaultValue&&(l.current=e.defaultValue,i(e.defaultValue))}),[e.defaultValue]);var u=c.current?null!==(t=e.value)&&void 0!==t?t:"":o;return[{value:u,onChange:function(t){l.current=t.target.value,c.current&&e.onChange?e.onChange(t):i(t.target.value)}},l,u,i]}},736:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0),r=n(823),o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};function i(e){var t=o(Object(a.useState)(e.defaultValue||r.a.UNKNOWN),2),n=t[0],i=t[1],l=Object(a.useRef)(e.value||e.defaultValue||r.a.UNKNOWN),c=Object(a.useRef)(e.hasOwnProperty("value"));Object(a.useEffect)((function(){void 0!==e.defaultValue&&e.defaultValue!==l.current&&(l.current=e.defaultValue,i(e.defaultValue))}),[e.defaultValue]);var u=c.current?e.value:n;return[{value:u,onChange:function(t){var n=Number(t.target.value);isNaN(n)||(l.current=n,c.current&&e.onChange?e.onChange(n):i(n))}},l,u]}},737:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0),r=n(731),o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};function i(e){var t=Object(a.useMemo)((function(){return Object(r.c)(new Date(1901,0,1))}),[]),n=Object(a.useMemo)((function(){return Object(r.c)(Object(r.d)())}),[]),i=Object(a.useRef)(e.hasOwnProperty("value")),l=o(Object(a.useState)((function(){return Object(r.a)(e.defaultValue)})),2),c=l[0],u=l[1],s=Object(a.useRef)(e.value||e.defaultValue);Object(a.useEffect)((function(){void 0!==e.defaultValue&&s.current!==e.defaultValue&&(s.current=e.defaultValue,u(Object(r.a)(e.defaultValue)))}),[e.defaultValue]);var d=i.current?Object(r.a)(e.value):c;return[{min:t,max:n,defaultValue:d,onDateChange:function(t){s.current=Object(r.b)(t),i.current&&e.onChange?e.onChange(s.current):u(t)}},s,d]}},739:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(0),r=n.n(a),o=n(1),i=n(166),l=n(10),c=n.n(l),u=n(751),s={insert:"head",singleton:!1},d=(c()(u.a,s),u.a.locals,function(e){var t=e.user,n=t.id,a=t.photo_100,l=t.photo_200,c=t.first_name,u=t.last_name,s=t.letters,d=t.color,_=e.selectable,m=e.multiple,f=e.checked,b=e.disabled,h=e.description,p=e.onClick,v=e.onChange,g=function(){var e=a||l;return e?r.a.createElement(o.h,{className:"UsersAlphabetList__avatar",size:40,src:e}):s&&d?r.a.createElement("div",{className:"UsersAlphabetList__avatar"},r.a.createElement(i.a,{letters:s,size:40,color:d})):null};return _&&!m?r.a.createElement(o.cb,{className:"UsersAlphabetList__radio",name:"user_"+n,checked:f,onChange:function(){return null},onClick:p},r.a.createElement("div",{className:"UsersAlphabetList__item"},g(),r.a.createElement("div",null,c," ",u))):r.a.createElement(o.l,{className:Object(o.Fb)({"UsersAlphabetList__item--disabled":b}),name:"user_"+n,selectable:_,checked:f,onChange:v,onClick:p,disabled:b,description:h,before:g()},c," ",u)})},748:function(e,t,n){"use strict";var a=n(131),r=n(23),o=n.n(r),i=n(1),l=n(0),c=n.n(l),u=n(19),s=n(103),d=n(3),_=n(826),m=n(694),f=n(198),b=n(22),h=function(e){var t=e.id,n=e.userTitle,r=e.name,h=e.city,p=e.editable,v=e.getProfileSchools,g=e.disabled,E=e.sizeX,C=Object(l.useContext)(u.a),y=C.showActionSheet,O=C.apiRequest,j=Object(l.useContext)(s.a).getLangKey,k=Object(b.b)().accountInfo.id,D=Object(l.useCallback)((function(e){e.preventDefault();var n=e.currentTarget;y(n,[{mode:"destructive",text:j("vkui_edu_profile_leave_school"),onClick:function(){O("education.leaveSchool",{group_id:t}).then((function(){v(),Object(f.a)({event_type:"leave_school",school_id:t,edu_user_id:k}),o.a.isWebView()&&o.a.send("VKWebAppCustomMessage",{action:"updateSchools"})}))},before:c.a.createElement(_.a,null)}])}),[O,j,y,v,t]);return c.a.createElement(i.lb,{sizeX:E,key:t,before:c.a.createElement(m.a,null),description:n,after:p?c.a.createElement(a.a,{onClick:D}):null,href:d.b.buildUrl(d.h.SCHOOL,{schoolId:t}),disabled:g},r,h?", "+h.title:"")};h.defaultProps={editable:!1},t.a=c.a.memo(h)},749:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ModalPageFooter__in{background-color:#fff;background-color:var(--background_content);box-sizing:border-box;display:flex;flex-direction:row-reverse;flex-wrap:wrap;border-bottom-right-radius:8px;border-bottom-left-radius:8px}.ModalPageFooter__in--margin{margin-top:8px}.ModalPageFooter--shadow .ModalPageFooter__in{box-shadow:0 -1px 0 rgba(0,0,0,.08);box-shadow:0 -1px 0 var(--image_border)}.ModalPageFooter--fixed .ModalPageFooter__in--main{position:absolute;left:0;bottom:0;right:0;z-index:12}.ModalPageFooter--sticky{position:-webkit-sticky;position:sticky;left:0;bottom:0;right:0;z-index:12}.ModalPageFooter__in--hidden{opacity:0;pointer-events:none;position:static}",""]),t.a=r},750:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".UsersAlphabetList__group{padding-bottom:16px}.UsersAlphabetList__header{padding:10px 0;color:#818c99;color:var(--header_text_secondary)}.UsersAlphabetList__group .Cell--android{margin:0 -16px}.UsersAlphabetList__group .Cell--ios{margin:0 -12px}",""]),t.a=r},751:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".UsersAlphabetList__item{display:flex;align-items:center}.UsersAlphabetList__item--disabled .Cell__marker{opacity:.4}.UsersAlphabetList__radio{margin:0 -16px}.UsersAlphabetList__avatar{padding-right:12px}",""]),t.a=r},828:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".EditMember__checkbox .Checkbox__container{align-items:center}.EditMember__caption{color:#818c99;color:var(--text_placeholder)}.EditMember__separator{margin-top:8px}.EditMember__fieldError{color:#e64646;color:var(--destructive)}",""]),t.a=r},829:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".SelectSchool__search{margin-bottom:6px}",""]),t.a=r},830:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".SelectClasses__search{margin-bottom:6px}@media (max-width:767px){.SelectClasses__search{margin-bottom:14px}}.SelectClasses__checkbox{padding-right:18px;padding-left:18px}@media (max-width:767px){.SelectClasses__checkbox{padding-right:10px;padding-left:10px}.SelectClasses__list{min-height:310px}}",""]),t.a=r},831:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".Registration__settingsHeader{padding-bottom:8px}",""]),t.a=r},832:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".RegistrationProfileComplete{display:flex;flex-direction:column;align-items:center;padding:60px 40px 38px}.RegistrationProfileComplete__icon{margin-bottom:8px;color:#99a2ad;color:var(--icon_secondary)}.RegistrationProfileComplete__description{margin-top:8px;font-size:16px;line-height:20px;color:#818c99;color:var(--text_secondary);text-align:center}.RegistrationSelectSchool{padding:0 8px 12px}.RegistrationSelectSchool__submit{height:44px}",""]),t.a=r},833:function(e,t,n){"use strict";var a=n(11),r=n.n(a),o=n(33),i=n.n(o),l=n(834),c=n.n(l),u=n(835),s=n.n(u),d=n(836),_=n.n(d),m=n(837),f=n.n(m),b=n(838),h=n.n(b),p=n(839),v=n.n(p),g=n(840),E=n.n(g),C=n(841),y=n.n(C),O=r()(!1),j=i()(c.a),k=i()(s.a),D=i()(_.a),S=i()(f.a),F=i()(h.a),x=i()(v.a),A=i()(E.a),w=i()(y.a);O.push([e.i,".OnboardingModal__slide{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;text-align:center}.OnboardingModal__slide--title{margin:16px 0}.OnboardingModal__button{margin-top:18px}@media (min-width:768px){.OnboardingModal__slide--description{max-width:368px}.OnboardingModal__slide::before{content:'';display:block;height:224px;width:368px;margin-top:6px}.OnboardingModal__slide_1::before{background-image:url("+j+")}.OnboardingModal__slide_2::before{background-image:url("+k+")}.OnboardingModal__slide_3::before{background-image:url("+D+")}.OnboardingModal__slide_4::before{background-image:url("+S+")}}@media (max-width:767px){.OnboardingModal .vkuiModalCard__in{box-sizing:border-box}.OnboardingModal .vkuiGroup__inner{padding-bottom:0}.OnboardingModal__slide::before{content:'';display:block;height:160px;width:255px}.OnboardingModal__slide_1::before{background-image:url("+F+")}.OnboardingModal__slide_2::before{background-image:url("+x+")}.OnboardingModal__slide_3::before{background-image:url("+A+")}.OnboardingModal__slide_4::before{background-image:url("+w+")}}",""]),t.a=O},834:function(e,t,n){e.exports=n.p+"static/desktop_step_1.a21c22bceaf3c6f0161beb9054fc6772.svg"},835:function(e,t,n){e.exports=n.p+"static/desktop_step_2.2b1855d2a086dc3e14594f18649953c8.svg"},836:function(e,t,n){e.exports=n.p+"static/desktop_step_3.406c4ea2683100192ae806e91ceac496.svg"},837:function(e,t,n){e.exports=n.p+"static/desktop_step_4.ecea756e319e04fc8aee7f2a31d67c8b.svg"},838:function(e,t,n){e.exports=n.p+"static/mobile_step_1.5ac0b05476ffd6612499ffd6a7f46dfd.svg"},839:function(e,t,n){e.exports=n.p+"static/mobile_step_2.38c44c972eb788ad3fcae4cc52518a98.svg"},840:function(e,t,n){e.exports=n.p+"static/mobile_step_3.ddd40cce8ec6f9556843b8c15a9216cc.svg"},841:function(e,t,n){e.exports=n.p+"static/mobile_step_4.faec1a6156f7839345e3fb4171dacfcb.svg"},842:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".FormLayout--android .SchoolRequestForm__classes{margin:-12px -16px;box-sizing:content-box}.FormLayout .SchoolRequestForm__classes{margin:-12px;box-sizing:content-box}@media (max-width:767px){.SchoolRequestForm__classes .SimpleCell__children{color:#3f8ae0;color:var(--accent)}}.SchoolRequestForm__classes--error .SimpleCell__children{color:#e64646;color:var(--field_error_border)}.SchoolRequestForm__classes--disabled{opacity:.3;cursor:default;pointer-events:none}.SchoolRequestForm__hint{color:#6d7885;color:var(--text_subhead)}",""]),t.a=r},843:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ChatAccessRestricted .ModalCard__container{max-width:416px;margin:auto;padding:12px 24px 24px}.ChatAccessRestricted .ModalCard__title{font-weight:500;font-size:20px}.ChatAccessRestricted .ModalCard__icon{margin:20px auto 12px}.ChatAccessRestricted .Button{padding:4px 16px}",""]),t.a=r},844:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".DocumentBlank{-webkit-user-select:text;user-select:text}.DocumentBlank h1{font-size:16px;font-weight:500;line-height:21px;margin:0}.DocumentBlank p{font-size:13px;line-height:21px;margin:12px 0}.DocumentBlank b{font-weight:500}.DocumentBlank .listing b{font-weight:400}",""]),t.a=r},845:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".PrivacyModal .ModalPage__in{width:100%;max-width:720px}",""]),t.a=r},846:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".AgreementModal .ModalPage__in{width:100%;max-width:720px}",""]),t.a=r},847:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".EditClasses__search{margin-bottom:6px}.EditClasses__checkbox{padding-right:18px;padding-left:18px}",""]),t.a=r},848:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ColorSelector__row{display:flex;flex-direction:row;flex-wrap:wrap}@media (min-width:767px){.ColorSelector__row{justify-content:space-between}}.ColorSelector__row+.ColorSelector__row{margin-top:12px}.ColorSelector__item{background:0 0;width:44px;height:44px;padding:0;display:flex;align-items:center;justify-content:center;border:2px solid #fff;border:2px solid var(--background_content);border-radius:50%;color:#fff;color:var(--background_content);font-style:normal;font-weight:600;font-size:26px;cursor:pointer;outline:0;margin:2px;overflow:hidden}.ColorSelector__item:focus:not(.ColorSelector__item--selected){box-shadow:0 0 0 2px rgba(0,0,0,.04);box-shadow:0 0 0 2px var(--background_hover)}.ColorSelector__item--selected{box-shadow:0 0 0 2px #3f8ae0;box-shadow:0 0 0 2px var(--accent)}",""]),t.a=r},849:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".SelectParticipants__search{margin-bottom:8px}.SelectParticipants__checkbox{padding-right:18px;padding-left:18px}.SelectParticipants__selected{margin-bottom:8px}.SelectParticipants__selectedIn{display:flex;height:102px}.SelectParticipants__selectedPlaceholder{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.SelectParticipants__list{padding:0 24px}",""]),t.a=r},850:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".SmallOwnerItem{box-sizing:border-box;width:72px;min-width:72px;padding:4px;position:relative;display:flex;flex-direction:column;align-items:center}.SmallOwnerItem__removeBtn{position:absolute;left:7px;top:3px;border:0;border-radius:50%;width:20px;height:20px;background:#99a2ad;background:var(--icon_secondary);color:var(--white);cursor:pointer;outline:0;z-index:2;padding:0;display:flex;justify-content:center;align-items:center}.SmallOwnerItem__name{margin-top:6px;max-height:28px;overflow:hidden;text-overflow:ellipsis;text-align:center;max-width:100%}",""]),t.a=r},851:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".DocumentUpload__center{text-align:center;margin:50px 18px}.DocumentUpload__text{text-align:center;color:#6d7885;color:var(--text_subhead);margin:8px 0}.DocumentUpload__header{height:0}",""]),t.a=r},852:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ProfileCompact__header{position:relative;display:flex;align-items:center;flex-direction:column;padding:32px 0}.ProfileCompact__close{position:absolute;top:4px;right:4px}.ProfileCompact__name{margin-top:20px}.ProfileCompact__role{margin-top:8px;color:#818c99;color:var(--text_secondary)}.ProfileCompact__actions{margin-top:24px;display:flex;flex-direction:column}.ProfileCompact__actionsRow{display:flex;align-items:flex-start;margin-bottom:12px}.ProfileCompact__actionsRow .Button:not(:first-child){margin-left:12px}.ProfileCompact--regular .ProfileCompact__content{padding:8px 8px 0}.ProfileCompact__actionsText{color:#818c99;color:var(--text_secondary);text-align:center;margin-top:16px}.ProfileCompact__roles{padding:0 24px}.ProfileCompact__roles .Roles__list{text-align:center;justify-content:center}.ProfileCompact__classmate{text-align:center}",""]),t.a=r},853:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,"",""]),t.a=r},855:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".MessagesExternal__iframe{display:block;position:absolute;width:100%;left:0;top:0;height:100%;border:0}.MessagesExternal .ModalPage__content-in{position:relative!important}.MessagesExternal__container{position:relative;min-height:450px}.MessagesExternal__container[data-page=flush_history]{min-height:154px}.MessagesExternal__container[data-page=leave_chat]{min-height:144px}.MessagesExternal__container[data-page=invite_link]{min-height:210px}.MessagesExternal__container[data-page=reset_link]{min-height:210px}.MessagesExternal__container[data-page=unpin]{min-height:100px}.MessagesExternal__container[data-page=edit_chat]{min-height:110px}@media (max-width:767px) and (max-height:570px){.MessagesExternal__container[data-page=new_chat]{min-height:211px}}",""]),t.a=r},856:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".CreateChat{padding:0 8px}",""]),t.a=r},857:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".SelectChatMembers__search{margin-bottom:8px}.SelectChatMembers__selectedIn{display:flex;height:102px}.SelectChatMembers__selectedPlaceholder{display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:#818c99;color:var(--text_secondary)}.SelectChatMembers__selectedPlaceholder--error{color:#e64646;color:var(--field_error_border)}.SelectChatMembers__tabsItems{display:flex}.SelectChatMembers__list{padding:0 16px}",""]),t.a=r},858:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ChatAddMembers .ModalPage__content-wrap{min-height:584px}.ChatAddMembers__link{padding:0 24px}.ChatAddMembers .ModalPageHeader__in{padding:0 12px}.ChatAddMembers__link .SimpleCell__description{font-size:16px;color:#4986cc;color:var(--text_link)}.ChatAddMembers__separator{padding:10px 12px}.ChatAddMembers__search{margin-bottom:2px;padding:8px 24px}.ChatAddMembers__selectedIn{display:flex;height:102px;padding:0 14px 8px}.ChatAddMembers__selectedPlaceholder{display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:#818c99;color:var(--text_secondary)}.ChatAddMembers__selectedPlaceholder--error{color:#e64646;color:var(--field_error_border)}.ChatAddMembers__tabsItems{display:flex}.ChatAddMembers__list{padding:0 24px}.ChatAddMembers__footer{font-size:16px;display:flex;flex-direction:column;justify-content:center;align-items:center}",""]),t.a=r},859:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".CellItemSkeleton{pointer-events:none}.CellItemSkeleton .Cell__marker{border:1px solid transparent;background:rgba(0,28,61,.08);background:var(--placeholder_icon_background)}.CellItemSkeleton .Cell__in{margin:8px}",""]),t.a=r},860:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ListUsersSkeleton__letter{height:15px;width:14px;background:rgba(0,28,61,.08);background:var(--placeholder_icon_background)}.ListUsersSkeleton__header{margin:0 24px;padding:10px 0}",""]),t.a=r},862:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ChatInfo__content{padding:0 8px}.ChatInfo__content--withBottom{padding-bottom:8px}.ChatInfo__separator{padding:12px 0}.ChatInfo__headline{color:#818c99;color:var(--text_secondary)}.ChatInfo__input::before{position:absolute;top:0;right:0;bottom:0;left:0;z-index:10;display:block;content:''}",""]),t.a=r},863:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ChatInfoLnk__separator{padding:12px 0}.ChatInfoLnk__separator--header{padding:0 8px}.ChatInfoLink__description{padding-bottom:4px;padding-top:16px;color:#6d7885;color:var(--text_subhead)}.ChatInfoLink__button{margin-bottom:16px}",""]),t.a=r},864:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ChatAttachments__modalContent{height:300px;overflow-y:auto}.ChatAttachments__photos,.ChatAttachments__videos{padding:2px;overflow:hidden}.ChatAttachments__photo,.ChatAttachments__video{position:relative;display:inline-block;width:24%;max-height:77px;height:77px;margin:.5%;background-color:rgba(0,28,61,.08);background-color:var(--placeholder_icon_background);text-align:center;overflow:hidden;vertical-align:top;cursor:pointer}.ChatAttachments__image{max-width:100%;vertical-align:top}.ChatAttachments__doc{display:block;text-decoration:none}",""]),t.a=r},865:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".UserSchedule .FormLayout__container{padding:0}.UserSchedule .FormLayout__row-bottom{padding:0 16px}",""]),t.a=r},866:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".ScheduleControl__сheckbox{padding-right:16px;padding-left:16px}@media (max-width:767px){.ScheduleControl__сheckbox{padding:10px}}.ScheduleControl__row{box-sizing:border-box;display:flex;width:100%;padding:8px 16px}@media (max-width:767px){.ScheduleControl__row{padding:8px 12px}}.ScheduleControl__row>.ScheduleControl__cell+.ScheduleControl__cell{margin-left:28px}.ScheduleControl__cell{position:relative;flex:1 0}.ScheduleControl__cell:not(:first-child)::before{position:absolute;top:50%;left:-24px;-webkit-transform:translateY(-50%);transform:translateY(-50%);display:block;content:'–';width:20px;text-align:center}",""]),t.a=r},867:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".VideoUpload__center{text-align:center;margin:56px 24px}.VideoUpload__text{text-align:center;color:#6d7885;color:var(--text_subhead);margin:8px 0}",""]),t.a=r},868:function(e,t,n){e.exports=n.p+"static/no_avatar.012eb0587a2e9445e52fc49acd3cc1a7.png"},869:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".CreateCalls__list--no-grouping{padding:16px 16px 0}.CreateCalls__list--grouping{padding:0 16px}.CreateCalls__selectedIn{display:flex;height:102px}",""]),t.a=r},870:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".Conversation__center{padding:40px 24px;display:flex;flex-direction:column;align-items:center}.Сonversation .ModalCard__container{max-width:416px;margin-right:auto;margin-left:auto}.Conversation .ModalCard .UsersStack{margin-top:8px}.Conversation__avatar{display:flex;align-items:center;justify-content:center}.Conversation__title{text-align:center;margin:16px 0 8px 0}.Conversation__text{text-align:center;font-size:14px;color:#6d7885;color:var(--text_subhead);margin:0}.Conversation__users{margin-bottom:20px}",""]),t.a=r},872:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".QRCode svg{display:block}",""]),t.a=r},873:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".QRCodePreview{display:flex;flex-direction:column;align-items:center;text-align:center}.QRCodePreview__description{margin-top:8px;color:#6d7885;color:var(--text_subhead)}.QRCodePreview__button{margin-top:28px}@media (min-width:768px){.QRCodePreview{padding:32px 32px 44px 32px}.QRCodePreview__title{margin-top:8px}}",""]),t.a=r},875:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".CallsListModal__container{padding-bottom:24px}@media (min-width:768px){.CallsListModal .ModalPage__in{width:560px}.CallsListModal__content{padding:0 8px}.CallsListModal__action{padding:0 16px}.CallsListModal__button{margin-top:24px}}@media (max-width:767px){.CallsListModal__action{margin-bottom:12px;padding:0 12px}.CallsListModal__button{margin-top:8px}}",""]),t.a=r},876:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".JoinCallModal__action{margin-top:32px;margin-bottom:32px}.JoinCallModal__text{color:#6d7885;color:var(--text_subhead);text-align:center}.JoinCallModal__text:not(:last-of-type){margin-bottom:12px}.JoinCallModal__snackbarIcon{color:#3f8ae0;color:var(--accent)}",""]),t.a=r},877:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".MobileJoinCallModal__gradient{margin:-16px -16px 0 -16px;padding:24px 16px 20px 16px;text-align:center}.MobileJoinCallModal__content{padding-top:10px}.MobileJoinCallModal__cell{margin:0 -16px;padding:6px 0}.MobileJoinCallModal__icon{width:48px;height:48px;margin-right:12px}img.MobileJoinCallModal__icon{border-radius:8px;border:.5px solid rgba(0,0,0,.08);border:.5px solid var(--image_border)}.MobileJoinCallModal__subhead{margin-top:8px;color:#6d7885;color:var(--text_subhead)}",""]),t.a=r},878:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".DownloadAppModal{display:flex;flex-direction:column;align-items:center;text-align:center}.DownloadAppModal__title{max-width:360px}.DownloadAppModal__description{margin-top:18px;color:#6d7885;color:var(--text_subhead);margin-bottom:32px;max-width:360px;font-size:16px}.DownloadAppModal__link{margin-bottom:28px}.DownloadAppModal__qr{margin-top:20px;margin-bottom:12px}",""]),t.a=r},879:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".DownloadAppSelectModal__button{padding:0 16px}.DownloadAppSelectModal__button:not(:first-child){margin-top:10px}.DownloadAppSelectModal__button:first-child{margin-top:2px}.DownloadAppSelectModal__button:last-child{margin-bottom:12px}.DownloadAppSelectModal__group{margin-bottom:4px}",""]),t.a=r},880:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".JoinSchoolModal__content{display:flex;flex-direction:column;align-items:center;padding-top:30px}.JoinSchoolModal__description{margin-top:8px;text-align:center;color:#6d7885;color:var(--text_subhead);font-size:14px;line-height:18px}.JoinSchoolModal__joinRoles{margin-top:8px}.JoinSchoolModal__icon{color:#3f8ae0;color:var(--accent);margin-bottom:8px}.JoinSchoolModal__footer{margin-top:16px;padding:16px}.JoinSchoolModal__footerButton{height:44px}.JoinSchoolModal__footerButton+.JoinSchoolModal__footerButton{margin-top:8px}.JoinSchoolModal__loader{display:flex;align-items:center;justify-content:center;height:330px}",""]),t.a=r},882:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".WrongInvite .WarningContent__button{margin-top:32px;min-height:44px}",""]),t.a=r},883:function(e,t,n){"use strict";var a=n(11),r=n.n(a)()(!1);r.push([e.i,".CallJoinModal__header{position:absolute;top:0;left:0;width:100%}",""]),t.a=r},915:function(e,t,n){"use strict";n.r(t),n.d(t,"Modals",(function(){return hl}));var a=n(6),r=n.n(a),o=n(0),i=n.n(o),l=n(1),c=n(3),u=n(103),s=n(43),d=n(478),_=n(700),m=n(54),f=n(724),b=n(20),h=n(59),p=n(56),v=n(19),g=n(22),E=n(21),C=n(721),y=n(693),O=function(e){var t=e.onClose,n=e.onSubmit,a=e.children,r=Object(u.c)().getLangKey,o=Object(l.Ib)().viewWidth,c=Object(b.b)(o),s=Object(l.Jb)(),d=i.a.createElement(l.U,{onClick:t},s===l.a?i.a.createElement(C.a,null):r("vkui_edu_edit_member_mobile_header_cancel")),_=i.a.createElement(l.U,{onClick:n},s===l.a?i.a.createElement(y.a,null):r("vkui_edu_edit_member_mobile_header_apply"));return i.a.createElement(l.O,{left:c&&d,right:c&&_},a)},j=Object(o.memo)(O),k=n(164),D=n(10),S=n.n(D),F=n(828),x={insert:"head",singleton:!1},A=(S()(F.a,x),F.a.locals,function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}),w=function(e){var t=e.id,n=e.onClose,a=e.dynamicContentHeight,r=e.params.schoolId,C=Object(u.c)().getLangKey,y=Object(l.Ib)().viewWidth,O=Object(o.useContext)(v.a).go,D=Object(g.a)(),S=Object(g.b)(),F=S.accountInfo,x=S.schoolInfo,w=S.memberEditInfo,N=Object(b.a)(y),I=A(Object(o.useState)(!1),2),M=I[0],L=I[1],T=A(Object(o.useState)(!1),2),B=T[0],P=T[1],R=Object(o.useMemo)((function(){return Object(p.g)(x)}),[x]),U=Object(o.useMemo)((function(){return w.mode===m.c.Request}),[null==w?void 0:w.mode]),z=Object(o.useMemo)((function(){return(null==w?void 0:w.role)===s.a.TEACHER||(null==w?void 0:w.role)===s.a.CLASS_TEACHER}),[null==w?void 0:w.role]),H=Object(o.useMemo)((function(){return(null==w?void 0:w.role)===s.a.CLASS_TEACHER?s.a.TEACHER:null==w?void 0:w.role}),[null==w?void 0:w.role]),q=Object(o.useMemo)((function(){return null==w?void 0:w.grades.map(h.b).join(", ")}),[null==w?void 0:w.grades]),W=Object(o.useMemo)((function(){return[{label:C("vkui_edu_member_role_teacher"),value:s.a.TEACHER},{label:C("vkui_edu_member_role_pupil"),value:s.a.STUDENT}]}),[]),J=function(){var e=w.onSubmit,t=w.role,n=w;U&&0===n.grades.length?L(!0):t?(z&&!n.managerRole&&(n.managerRole=d.a.EDITOR),t===s.a.STUDENT&&(n.lesson="",n.managerRole=null),e(n)):P(!0)};return i.a.createElement(l.N,{id:t,dynamicContentHeight:a,onClose:n,header:i.a.createElement(j,{onClose:n,onSubmit:J},null==w?void 0:w.user.first_name," ",null==w?void 0:w.user.last_name)},i.a.createElement(l.u,{top:C("vkui_edu_edit_member_role"),bottom:B&&C("vkui_edu_edit_member_role_placeholder"),status:B?"error":"default"},i.a.createElement(l.ib,{placeholder:C("vkui_edu_edit_member_role_placeholder"),name:"role",disabled:!!(null==w?void 0:w.role),value:H,onChange:function(e){var t=e.currentTarget.value;P(!1),D(Object(E.db)({role:Number(t)}))},options:W})),z&&i.a.createElement(l.u,{top:C("vkui_edu_edit_member_object")},i.a.createElement(l.I,{name:"lesson",value:null==w?void 0:w.lesson,onChange:function(e){var t=e.currentTarget.value;D(Object(E.db)({lesson:t}))}})),i.a.createElement(l.lb,{before:i.a.createElement(_.a,null),description:q,onClick:function(){D(Object(E.R)({schoolId:r,selectedClasses:null==w?void 0:w.grades,onSubmit:function(e){D(Object(E.db)({grades:e})),L(!1),Object(k.c)("grade",null==e?void 0:e.map((function(e){return e.id})),"school")}})),O(c.g.SELECT_CLASSES,{schoolId:r})}},i.a.createElement("span",{className:Object(l.Fb)({EditMember__fieldError:M})},C("vkui_edu_edit_member_classes"))),!U&&R&&z&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.kb,{className:"EditMember__separator"}),i.a.createElement(l.u,{top:C("vkui_edu_edit_member_level")},i.a.createElement(l.n,{className:"EditMember__checkbox",name:"manageRole",defaultChecked:w.managerRole===d.a.ADMINISTRATOR,disabled:(null==w?void 0:w.user.id)===F.id,onChange:function(e){var t=e.currentTarget.checked;D(Object(E.db)({managerRole:t?d.a.ADMINISTRATOR:null}))}},i.a.createElement(l.zb,{level:"3",weight:"regular"},C("vkui_edu_edit_member_level_admin")),i.a.createElement(l.j,{className:"EditMember__caption",level:"1",weight:"regular"},C("vkui_edu_edit_member_level_admin_description"))))),N&&i.a.createElement(f.a,{noShadow:!N},i.a.createElement(l.i,{type:"button",size:"m",onClick:J},C(U?"vkui_edu_edit_member_accept_request":"vkui_edu_edit_member_save"))))},N=Object(o.memo)(w),I=n(829),M={insert:"head",singleton:!1},L=(S()(I.a,M),I.a.locals,n(689)),T=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},B=function(e){var t=e.onClose,n=e.children,a=T(e,["onClose","children"]),o=Object(l.Ib)().viewWidth,c=Object(b.b)(o),u=Object(l.Jb)();return i.a.createElement(l.O,r()({left:c&&u===l.a&&i.a.createElement(l.U,{onClick:t},i.a.createElement(C.a,null)),right:c&&u===l.F&&i.a.createElement(l.U,{onClick:t},i.a.createElement(L.a,null))},a),n)},P=function(){return(P=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},R=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},U=function(e){var t=e.style,n=e.minHeight,a=R(e,["style","minHeight"]);return i.a.createElement("div",r()({},a,{style:P({minHeight:n},t)}),e.children)};U.defaultProps={minHeight:450};var z=n(107),H=n(106),q=function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey,r=Object(o.useContext)(v.a),c=r.apiRequest,s=r.showError,d=r.back,_=Object(g.b)().selectSchoolInfo,m=_.method,f=_.cityId,b=_.onSelect,h=Object(o.useRef)(null),p=Object(z.a)({fetch:function(e){var t=e.itemsCount,n=e.search;return c(m,{offset:t,q:n,city_id:f,v:"5.130",extended:1}).then((function(e){return e.items})).catch((function(e){return s(e)}))}}),E=p.isLoaded,C=p.isFetching,y=p.canLoadMore,O=p.items,j=p.handleLoadMore,k=p.search,D=p.handleSearch,S=function(e){var t=Number(e.currentTarget.dataset.id);if(!isNaN(t)){var n=O.find((function(e){return e.id===t}));n&&(b(n),d())}};return i.a.createElement(l.N,{getModalContentRef:h,id:t,header:i.a.createElement(B,{onClose:n},a("vkui_edu_select_school_header")),onClose:n},i.a.createElement(U,null,i.a.createElement(l.hb,{className:"SelectSchool__search",autoComplete:"off",value:k,onChange:D,placeholder:a("vkui_edu_search_placeholder")}),!E&&i.a.createElement(l.Y,null),E&&i.a.createElement(i.a.Fragment,null,0===O.length&&!C&&i.a.createElement(l.t,null,a("vkui_common_nothing_found")),i.a.createElement(H.a,{canLoad:y,outerContainer:h.current,isFetching:C,onLoadMore:j},O.length>0&&O.map((function(e){return i.a.createElement(l.lb,{key:e.id,"data-id":e.id,onClick:S},e.name)}))))))},W=Object(o.memo)(q),J=n(830),K={insert:"head",singleton:!1},V=(S()(J.a,K),J.a.locals,function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i});var G,Y,Q,X,Z,$,ee,te,ne,ae,re=n(105),oe=n(80),ie=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},le=function(e){var t=Object(u.c)().getLangKey,n=Object(o.useContext)(v.a).back,a=Object(g.b)().selectClassesInfo,r=Object(l.Ib)().viewWidth,c=Object(b.a)(r),s=r<l.Cb.TABLET,d=a.schoolId,_=a.isSingle,m=a.selectedClasses,h=a.onSubmit,p=ie(function(e){var t=V(Object(o.useState)((function(){return e||[]})),2),n=t[0],a=t[1],r=Object(o.useRef)(e||[]);return[n,function(e){var t=e.target.checked,n=Number(e.target.value);isNaN(n)||a((function(e){var a=t?e.concat([n]):e.filter((function(e){return e!==n}));return r.current=a,a}))},r]}(m.map((function(e){return e.id}))),3),E=p[0],C=p[1],y=p[2],O=Object(oe.a)(d).getGrades,j=ie(Object(o.useState)(!0),2),k=j[0],D=j[1],S=Object(o.useRef)([]),F=ie(Object(o.useState)([]),2),x=F[0],A=F[1],w=ie(Object(o.useState)(""),2),N=w[0],I=w[1];Object(o.useEffect)((function(){O().then((function(e){D(!1),S.current=e,A(e)}))}),[]);var M=function(e){var t=Number(e.currentTarget.dataset.id);if(!isNaN(t)){var a=S.current.find((function(e){return e.id===t}));a&&(h([a]),n())}};return i.a.createElement(l.N,{className:"SelectClasses",id:e.id,header:i.a.createElement(B,{onClose:e.onClose},t(_?"vkui_edu_select_class_header":"vkui_edu_select_classes_header")),onClose:e.onClose},i.a.createElement(U,null,i.a.createElement(re.a,{className:"SelectClasses__search",value:N,onChange:function(e){I(e.target.value);var t=e.target.value.trim().toLowerCase(),n=t.length>0?S.current.filter((function(e){return(""+e.number+e.liter+(e.name?" "+e.name:"")).toLowerCase().includes(t)})):S.current;A(n)}}),k&&i.a.createElement(l.Y,null),0===x.length&&!k&&i.a.createElement(l.t,null,t("vkui_common_nothing_found")),i.a.createElement("div",{className:"SelectClasses__list"},x.length>0?_?x.map((function(e){return i.a.createElement(l.lb,{key:e.id,"data-id":e.id,onClick:M},e.number,e.liter,e.name&&" · "+e.name)})):x.map((function(e){return i.a.createElement(l.n,{className:"SelectClasses__checkbox",key:e.id,value:e.id,checked:E.includes(e.id),onChange:C},e.number,e.liter,e.name&&" · "+e.name)})):null),x.length>0&&!_&&i.a.createElement(f.a,{fixed:!0,sticky:s,noShadow:s},i.a.createElement(l.i,{stretched:!c,size:c?"m":"l",onClick:function(){h&&h(y.current.reduce((function(e,t){var n=S.current.find((function(e){return e.id===t}));return n?e.concat([n]):e}),[])),n()}},t("vkui_edu_select_classes_save")))))},ce=Object(o.memo)(le),ue=n(823),se=n(733),de=n(736),_e=n(737),me=n(731),fe=n(831),be={insert:"head",singleton:!1},he=(S()(fe.a,be),fe.a.locals,n(734)),pe=n(121),ve=function(){return(ve=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ge=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},Ee=function(e,t,n){var a=t.first_name,r=t.last_name,o=t.nick_name,i=t.sex,l=t.bdate,c=t.country_id,u=t.city_id,s=ge(t,["first_name","last_name","nick_name","sex","bdate","country_id","city_id"]);return e("account.saveProfileInfo",{first_name:a,last_name:r,nick_name:o,sex:i,bdate:l,country_id:c,city_id:u},{showSpinner:!0}).then((function(){return e("education.gradeRequest",s,{showSpinner:!0})})).catch(n)},Ce=function(e,t){return e("execute",ve(ve({},t),{code:"return [\n      API.account.saveProfileInfo({\n        first_name: Args.first_name,\n        last_name: Args.last_name,\n        nick_name: Args.nick_name,\n        sex: Args.sex,\n        bdate: Args.bdate,\n        country_id: Args.country_id,\n        city_id: Args.city_id,\n      }),\n      API.education.applyInviteLink({\n        link_id: Args.link_id,\n        grade_ids: Args.grade_ids,\n      })\n    ];"}),{showSpinner:!0})},ye=n(37),Oe=n(24),je=function(){var e=Object(g.a)();return function(){Object(ye.b)(Oe.w),e(Object(E.V)(void 0))}},ke=n(198),De=function(){return(De=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Se=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},Fe=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},xe=function(e){var t=e.id,n=e.onClose,a=Se(e,["id","onClose"]),d=Object(u.c)().getLangKey,_=Object(l.Ib)().viewWidth,m=Object(b.a)(_),h=_<l.Cb.TABLET,p=Object(g.b)(),C=p.registeredAccountInfo,y=p.inviteLink,O=Object(g.a)(),j=Object(o.useContext)(v.a),D=j.go,S=j.apiRequest,F=j.showError,x=j.getUserSchools,A=j.getUserOnboardingStatus,w=je(),N=Fe(Object(o.useState)({}),2),I=N[0],M=N[1],L=Object(o.useCallback)((function(e){O(Object(E.gb)(e))}),[O]),T=function(e){var t,n,a=e.target,r=a.name,o=a.value,i=null!==(n={firstName:"first_name",lastName:"last_name",middleName:"nickname"}[r])&&void 0!==n?n:r;Object(k.c)(i,o,"personal_data"),O(Object(E.gb)(((t={})[r]=o,t))),M((function(e){var t;return De(De({},e),((t={})[r]=null,t))}))},B=Object(o.useCallback)((function(e){Object(k.c)("sex",e,"personal_data"),O(Object(E.gb)({sex:e})),M((function(e){return De(De({},e),{sex:null})}))}),[O]),P=Object(o.useCallback)((function(e){Object(k.c)("bday",e,"personal_data"),O(Object(E.gb)({bdate:e})),M((function(e){return De(De({},e),{bdate:null})}))}),[O]),R=Object(se.a)({ownerId:C.id,hasPhoto:!!C.hasPhoto,photoUrl:C.photo||"",photoRawId:C.photoRawId||"",onUpdate:L}).uploadControl,U=Fe(Object(de.a)({value:C.sex||0,onChange:B}),1)[0],z=Fe(Object(_e.a)({value:C.bdate||"",onChange:P}),1)[0],H=Object(o.useMemo)((function(){return d("vkui_common_months_short_of").map((function(e){return e[0].toUpperCase()+e.slice(1)}))}),[d]),q=i.a.createElement(l.u,{top:d("vkui_edu_settings_first_name"),bottom:I.firstName,status:I.firstName?"error":"default",key:"firstName"},i.a.createElement(l.I,{name:"firstName",placeholder:d("vkui_edu_settings_first_name_placeholder"),value:C.firstName,onChange:T})),W=i.a.createElement(l.u,{top:d("vkui_edu_settings_last_name"),bottom:I.lastName,status:I.lastName?"error":"default",key:"lastName"},i.a.createElement(l.I,{name:"lastName",placeholder:d("vkui_edu_settings_last_name_placeholder"),value:C.lastName,onChange:T})),J=i.a.createElement(l.u,{top:d("vkui_edu_settings_middle_name"),key:"middleName"},i.a.createElement(l.I,{name:"middleName",placeholder:d("vkui_edu_settings_middle_name_placeholder"),value:C.middleName,onChange:T})),K=i.a.createElement(l.u,{top:d("vkui_edu_settings_sex"),bottom:I.sex,status:I.sex?"error":"default",key:"sex"},i.a.createElement(l.ib,r()({name:"sex",placeholder:d("vkui_edu_settings_sex_select")},U,{options:[{label:d("vkui_edu_settings_sex_male"),value:ue.a.MALE},{label:d("vkui_edu_settings_sex_female"),value:ue.a.FEMALE}]})));return i.a.createElement(l.N,r()({id:t,header:i.a.createElement(l.O,{left:i.a.createElement(l.T,{onClick:n})},d("vkui_edu_info")),onClose:n},a),i.a.createElement(l.r,{className:"Registration__settingsHeader"},i.a.createElement(he.a,{photo:R,caption:d("vkui_edu_settings_title")})),i.a.createElement(l.v,null,m?[i.a.createElement(l.w,{key:"0",mode:"horizontal"},q,W),i.a.createElement(l.w,{key:"1",mode:"horizontal"},J,K)]:[q,W,J,K],i.a.createElement(l.u,{top:d("vkui_edu_settings_birthday_date"),status:I.bdate?"error":"default",bottom:I.bdate},i.a.createElement(l.q,r()({name:"bdate",sizeX:l.mb.REGULAR},z,{monthNames:H,popupDirection:"top",dayPlaceholder:d("vkui_edu_settings_datepicker_day_placeholder"),monthPlaceholder:d("vkui_edu_settings_datepicker_month_placeholder"),yearPlaceholder:d("vkui_edu_settings_datepicker_year_placeholder")})))),i.a.createElement(f.a,{sticky:h,noShadow:h},i.a.createElement(l.i,{stretched:!m,size:m?"m":"l",onClick:function(){var e=C.firstName,t=C.lastName,n=C.middleName,a=void 0===n?"":n,r=C.sex,o=C.bdate,i=!0,l={};""===e.trim()&&(i=!1,l=De(De({},l),{firstName:d("vkui_edu_settings_first_name_placeholder")})),""===t.trim()&&(i=!1,l=De(De({},l),{lastName:d("vkui_edu_settings_last_name_placeholder")})),r||(i=!1,l=De(De({},l),{sex:d("vkui_edu_settings_sex_select")}));var u=Object(me.a)(o);if(u.year&&u.month&&u.day||(i=!1,l=De(De({},l),{bdate:d("vkui_edu_settings_birthday_date")})),i)if(y){var _={link_id:y.linkId,fields:"city,country"};S("education.getInviteLinkPreview",_,{grouping:!1}).then((function(e){return Object(pe.a)((function(){O(Object(E.gb)({isInvite:!0})),O(Object(E.V)({linkId:y.linkId,isLoaded:!0,preview:e}))})),e})).then((function(n){var i=n.school,l=n.invite_link,u=l.role===s.a.TEACHER,d={user_id:C.id,school_id:i.id,first_name:e,last_name:t,nick_name:a,sex:r,bdate:o,country_id:i.country.id,city_id:i.city.id,role:l.role,link_id:y?y.linkId:void 0,grade_ids:y?l.grade_ids.join(","):""};u?(O(Object(E.E)(De(De(De({},d),n),{classes:n.grades}))),D(c.g.REGISTRATION_TEACHER)):(y?Ce(S,d):Ee(S,d,F)).then((function(){return O(Object(E.Y)({firstName:e,lastName:t,middleName:a,sex:r,bdate:o,signupRequired:!1})),Object(k.b)({event_type:"registration_success",registration_type:(null==y?void 0:y.linkId)?"by_invitation":"by_yourself",invite_link_id:null==y?void 0:y.linkId}),Object(ke.a)({event_type:"registration",edu_user_id:d.user_id,school_id:d.school_id}),w(),x().then((function(){D(c.a),setTimeout((function(){A()}),500)}))}))})).catch(F)}else D(c.g.REGISTRATION_STEP_2);else M(l)}},d("vkui_edu_continue"))))},Ae=n(906),we=n(735),Ne=n(126),Ie=function(e){if(e){var t=new RegExp(/(?:[\0-\x1F!-'\*\+\.<-@\[-`\{-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u036F\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482-\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u05CF\u05EB-\u05EE\u05F3-\u061F\u064B-\u065F\u066A-\u066D\u0670\u06D4\u06D6-\u06E4\u06E7-\u06ED\u06FD\u06FE\u0700-\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07BF\u07EB-\u07F3\u07F6-\u07F9\u07FB-\u07FF\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u083F\u0859-\u085F\u086B-\u089F\u08B5\u08C8-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962-\u0965\u0970\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09E5\u09F2-\u09FB\u09FD-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A65\u0A70\u0A71\u0A75-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AE5\u0AF0-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B65\u0B70\u0B72-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0BE5\u0BF0-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B-\u0C5F\u0C62-\u0C65\u0C70-\u0C7F\u0C81-\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDD\u0CDF\u0CE2-\u0CE5\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D4F-\u0D53\u0D57-\u0D5E\u0D62-\u0D65\u0D70-\u0D79\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DE5\u0DF0-\u0E00\u0E31\u0E34-\u0E3F\u0E47-\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F1F\u0F2A-\u0F3F\u0F48\u0F6D-\u0F87\u0F8D-\u0FFF\u102B-\u103E\u104A-\u104F\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u1680\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u170D\u1712-\u171F\u1732-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u17DF\u17EA-\u180F\u181A-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DA-\u19FF\u1A17-\u1A1F\u1A55-\u1A7F\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1B04\u1B34-\u1B44\u1B4C-\u1B4F\u1B5A-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BFF\u1C24-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C89-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u215F\u2189-\u2BFF\u2C2F\u2C5F\u2CE5-\u2CEA\u2CEF-\u2CF1\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2E2E\u2E30-\u3004\u3008-\u3020\u302A-\u3030\u3036\u3037\u303D-\u3040\u3097-\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31C0-\u31EF\u3200-\u33FF\u4DC0-\u4DFF\u9FFD-\u9FFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA66F-\uA67E\uA69E\uA69F\uA6F0-\uA716\uA720\uA721\uA789\uA78A\uA7C0\uA7C1\uA7CB-\uA7F4\uA802\uA806\uA80B\uA823-\uA83F\uA874-\uA881\uA8B4-\uA8CF\uA8DA-\uA8F1\uA8F8-\uA8FA\uA8FC\uA8FF\uA926-\uA92F\uA947-\uA95F\uA97D-\uA983\uA9B3-\uA9CE\uA9DA-\uA9DF\uA9E5\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAADE\uAADF\uAAEB-\uAAF1\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABE3-\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFE6F\uFE75\uFEFD-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDD3F\uDD75-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEFF\uDF20-\uDF2C\uDF4B-\uDF4F\uDF76-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0\uDFD6-\uDFFF]|\uD801[\uDC9E\uDC9F\uDCAA-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56-\uDC5F\uDC77-\uDC7F\uDC9F-\uDCDF\uDCF3\uDCF6-\uDCFF\uDD16-\uDD1F\uDD3A-\uDD7F\uDDB8-\uDDBD\uDDC0-\uDDFF\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE5F\uDE7D-\uDE7F\uDE9D-\uDEBF\uDEC8\uDEE5-\uDEFF\uDF36-\uDF3F\uDF56-\uDF5F\uDF73-\uDF7F\uDF92-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCFF\uDD24-\uDD2F\uDD3A-\uDE7F\uDEAA-\uDEAF\uDEB2-\uDEFF\uDF1D-\uDF26\uDF28-\uDF2F\uDF46-\uDFAF\uDFC5-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC65\uDC70-\uDC82\uDCB0-\uDCCF\uDCE9-\uDCEF\uDCFA-\uDD02\uDD27-\uDD35\uDD40-\uDD43\uDD45\uDD46\uDD48-\uDD4F\uDD73-\uDD75\uDD77-\uDD82\uDDB3-\uDDC0\uDDC5-\uDDCF\uDDDB\uDDDD-\uDDFF\uDE12\uDE2C-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEDF-\uDEEF\uDEFA-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDFFF]|\uD805[\uDC35-\uDC46\uDC4B-\uDC4F\uDC5A-\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC6\uDCC8-\uDCCF\uDCDA-\uDD7F\uDDAF-\uDDD7\uDDDC-\uDDFF\uDE30-\uDE43\uDE45-\uDE4F\uDE5A-\uDE7F\uDEAB-\uDEB7\uDEB9-\uDEBF\uDECA-\uDEFF\uDF1B-\uDF2F\uDF3A-\uDFFF]|\uD806[\uDC2C-\uDC9F\uDCEA-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42-\uDD4F\uDD5A-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE2\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE9C\uDE9E-\uDEBF\uDEF9-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC41-\uDC4F\uDC5A-\uDC71\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD4F\uDD5A-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDD9F\uDDAA-\uDEDF\uDEF3-\uDFAF\uDFB1-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC6F-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD80B\uD80E-\uD810\uD812-\uD819\uD824-\uD82B\uD82D\uD82E\uD830-\uD834\uD836\uD837\uD839\uD83C\uD83D\uD83F\uD87B-\uD87D\uD87F\uD885-\uDBFF][\uDC00-\uDFFF]|\uD80D[\uDC2F-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F\uDE6A-\uDECF\uDEEE-\uDEFF\uDF30-\uDF3F\uDF44-\uDF4F\uDF5A-\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDE3F\uDE80-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE2\uDFE4-\uDFFF]|\uD821[\uDFF8-\uDFFF]|\uD823[\uDCD6-\uDCFF\uDD09-\uDFFF]|\uD82C[\uDD1F-\uDD4F\uDD53-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC\uDFCD]|\uD838[\uDC00-\uDCFF\uDD2D-\uDD36\uDD3E\uDD3F\uDD4A-\uDD4D\uDD4F-\uDEBF\uDEEC-\uDEEF\uDEFA-\uDFFF]|\uD83A[\uDCC5-\uDCFF\uDD44-\uDD4A\uDD4C-\uDD4F\uDD5A-\uDFFF]|\uD83B[\uDC00-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD83E[\uDC00-\uDFEF\uDFFA-\uDFFF]|\uD869[\uDEDE-\uDEFF]|\uD86D[\uDF35-\uDF3F]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEA2-\uDEAF]|\uD87A[\uDFE1-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g),n=e.trim();if(n.length>0){var a=n.match(t);return[null===a,Object(Ne.f)(a)]}}return[!0,[]]},Me=n(832),Le={insert:"head",singleton:!1},Te=(S()(Me.a,Le),Me.a.locals,n(143)),Be=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Pe=function(e){var t=e.submit,n=e.classes,a=Object(l.Ib)().viewWidth,s=Object(b.a)(a),d=Object(o.useContext)(v.a).go,m=Object(u.c)(),f=m.getLangKey,p=m.replaceVar,C=Object(g.a)(),y=Object(o.useMemo)((function(){return n&&n.length?n.map((function(e){return Object(h.d)(e)})).join(", "):""}),[n]),O=Be(Object(we.a)({value:e.object,onChange:function(t){var n,a;C(e.update(((n={})[t.target.name]=t.target.value,n.errors=((a={})[t.target.name]=null,a),n))),Object(k.c)(t.target.name,t.target.value,"school")}}),1)[0],j=Be(Ie(O.value),2),D=j[0],S=j[1],F=D?null:f("vkui_edu_validation_school_subject").replace("{characters}",S.map(Te.c).join(", ")),x=!!O.value&&n.length&&D;return i.a.createElement(i.a.Fragment,null,i.a.createElement("section",{className:"RegistrationProfileComplete"},i.a.createElement(Ae.a,{width:48,height:48,className:"RegistrationProfileComplete__icon"}),i.a.createElement(l.zb,{weight:"medium",level:"2"},e.title),i.a.createElement("div",{className:"RegistrationProfileComplete__description"},p(f("vkui_edu_registration_join_info"),"name",e.school.name))),i.a.createElement("form",{onSubmit:function(e){e.nativeEvent.preventDefault(),x&&t()},className:"RegistrationSelectSchool"},i.a.createElement(l.w,{mode:"vertical"},i.a.createElement(l.u,{top:f("vkui_edu_registration_object_label"),bottom:F||"",status:F?"error":"default"},i.a.createElement(l.I,r()({placeholder:f("vkui_edu_edit_member_object_placeholder"),name:"object"},O))),i.a.createElement(l.u,{top:f("vkui_edu_registration_which_grades")},i.a.createElement(l.lb,{className:Object(l.Fb)("SchoolRequestForm__classes",{"SchoolRequestForm__classes--error":!!e.errors.classes,"SchoolRequestForm__classes--disabled":!e.school}),before:s||(null==n?void 0:n.length)?i.a.createElement(_.a,null):null,description:y,onClick:function(){e.school&&(C(Object(E.R)({isSingle:!1,schoolId:e.school.id,selectedClasses:n||[],onSubmit:function(t){C(e.update({classes:t})),Object(k.c)("class",null==t?void 0:t.map((function(e){return e.id})),"school")}})),d(c.g.SELECT_CLASSES,{schoolId:e.school.id}))}},n&&n.length?f("vkui_edu_classes"):f("vkui_edu_choose_classes"))),i.a.createElement(l.u,null,i.a.createElement(l.i,{disabled:!x,className:"RegistrationSelectSchool__submit",type:"submit",size:"l",stretched:!0},f("vkui_edu_registration_continue"))))))},Re=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},Ue=function(e){var t=e.id,n=e.onClose,a=Re(e,["id","onClose"]),d=Object(o.useContext)(v.a),_=d.go,m=d.apiRequest,f=d.getUserSchools,b=d.getUserOnboardingStatus,h=d.showError,p=Object(g.b)(),C=p.registeredAccountInfo,y=p.inviteLink,O=Object(g.a)(),j=Object(u.c)().getLangKey,D=je();return i.a.createElement(l.N,r()({id:t,header:"",onClose:n},a),i.a.createElement(Pe,r()({},C,{title:j("vkui_edu_registration_profile_complete"),update:E.gb,submit:function(){var e=C.firstName,t=C.lastName,n=C.middleName,a=void 0===n?"":n,r=C.sex,o=C.bdate,i=C.school,l=C.classes,u=C.role,d=u===s.a.TEACHER?C.object:"",p=l.map((function(e){return e.id})).join(","),v={user_id:C.id,school_id:i.id,first_name:e,last_name:t,nick_name:a,sex:r,bdate:o,country_id:i.country.id,city_id:i.city.id,role:u,link_id:y?y.linkId:void 0,grade_ids:y?p:"",role_description:d};(y?Ce(m,v):Ee(m,v,h)).then((function(){return Object(k.b)({event_type:"registration_success",registration_type:(null==y?void 0:y.linkId)?"by_invitation":"by_yourself",invite_link_id:null==y?void 0:y.linkId}),Object(ke.a)({event_type:"registration",edu_user_id:v.user_id,school_id:v.school_id}),!y&&p&&Object(k.b)({event_type:"join_request_send"}),D(),O(Object(E.Y)({firstName:e,lastName:t,middleName:a,sex:r,bdate:o,signupRequired:!1})),f().then((function(){_(c.a),setTimeout((function(){b()}),500)}))})).catch(h)}})))},ze=n(415),He=n(98),qe=n(110);!function(e){e[e.Teacher=2]="Teacher",e[e.Student=1]="Student",e[e.Parent=5]="Parent"}(ne||(ne={})),function(e){e[e.Step1=1]="Step1",e[e.Step2=2]="Step2",e[e.Step3=3]="Step3",e[e.Step4=4]="Step4"}(ae||(ae={}));var We=((G={})[ae.Step1]="vkui_edu_onboarding_student_title_step_1",G[ae.Step2]="vkui_edu_onboarding_student_title_step_2",G[ae.Step3]="vkui_edu_onboarding_student_title_step_3",G[ae.Step4]="vkui_edu_onboarding_student_title_step_4",G),Je=((Y={})[ae.Step1]="vkui_edu_onboarding_student_description_step_1",Y[ae.Step2]="vkui_edu_onboarding_student_description_step_2",Y[ae.Step3]="vkui_edu_onboarding_student_description_step_3",Y[ae.Step4]="vkui_edu_onboarding_student_description_step_4",Y),Ke=((Q={})[ae.Step1]="vkui_edu_onboarding_teacher_title_step_1",Q[ae.Step2]="vkui_edu_onboarding_teacher_title_step_2",Q[ae.Step3]="vkui_edu_onboarding_teacher_title_step_3",Q[ae.Step4]="vkui_edu_onboarding_teacher_title_step_4",Q),Ve=((X={})[ae.Step1]="vkui_edu_onboarding_teacher_description_step_1",X[ae.Step2]="vkui_edu_onboarding_teacher_description_step_2",X[ae.Step3]="vkui_edu_onboarding_teacher_description_step_3",X[ae.Step4]="vkui_edu_onboarding_teacher_description_step_4",X),Ge=((Z={})[ae.Step1]="vkui_edu_onboarding_parent_title_step_1",Z[ae.Step2]="vkui_edu_onboarding_parent_title_step_2",Z[ae.Step3]="vkui_edu_onboarding_parent_title_step_3",Z[ae.Step4]="",Z),Ye=(($={})[ae.Step1]="vkui_edu_onboarding_parent_description_step_1",$[ae.Step2]="vkui_edu_onboarding_parent_description_step_2",$[ae.Step3]="vkui_edu_onboarding_parent_description_step_3",$[ae.Step4]="",$),Qe=((ee={})[ne.Teacher]=Ke,ee[ne.Student]=We,ee[ne.Parent]=Ge,ee),Xe=((te={})[ne.Teacher]=Ve,te[ne.Student]=Je,te[ne.Parent]=Ye,te),Ze=n(833),$e={insert:"head",singleton:!1},et=(S()(Ze.a,$e),Ze.a.locals,function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}),tt=function(e){var t=e.id,n=e.role,a=e.onClose,r=Object(l.Ib)().viewWidth,c=Object(b.a)(r),s=Object(u.c)().getLangKey,d=Object(o.useContext)(v.a),_=d.showPopout,m=d.hidePopout,f=d.getAsyncAccessToken,h=et(Object(o.useState)(0),2),g=h[0],E=h[1],C=Object(o.useMemo)((function(){return n===ne.Parent?3:4}),[n]),y=function(e){e?m():a()},O=Object(o.useCallback)((function(e,t){return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.zb,{level:"1",weight:"semibold",className:"OnboardingModal__slide--title"},s(e)),i.a.createElement(l.C,{weight:"regular",className:"OnboardingModal__slide--description"},s(t)))}),[]),j=Object(o.useCallback)((function(e,t){return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.zb,{level:"2",weight:"semibold",className:"OnboardingModal__slide--title"},s(e)),i.a.createElement(l.xb,{weight:"regular"},s(t)))}),[]),k=Object(o.useCallback)((function(e,t){return c?O(e,t):j(e,t)}),[c]),D=Object(o.useMemo)((function(){return s(g===C-1?"vkui_edu_onboarding_button_finish":"vkui_edu_onboarding_button_next")}),[g]),S=Object(o.useMemo)((function(){return n===ne.Parent?[i.a.createElement("div",{key:"step1",className:"OnboardingModal__slide OnboardingModal__slide_1"},k(Qe[n][ae.Step1],Xe[n][ae.Step1])),i.a.createElement("div",{key:"step2",className:"OnboardingModal__slide OnboardingModal__slide_3"},k(Qe[n][ae.Step2],Xe[n][ae.Step2])),i.a.createElement("div",{key:"step3",className:"OnboardingModal__slide OnboardingModal__slide_4"},k(Qe[n][ae.Step3],Xe[n][ae.Step3]))]:[i.a.createElement("div",{key:"step1",className:"OnboardingModal__slide OnboardingModal__slide_1"},k(Qe[n][ae.Step1],Xe[n][ae.Step1])),i.a.createElement("div",{key:"step2",className:"OnboardingModal__slide OnboardingModal__slide_2"},k(Qe[n][ae.Step2],Xe[n][ae.Step2])),i.a.createElement("div",{key:"step3",className:"OnboardingModal__slide OnboardingModal__slide_3"},k(Qe[n][ae.Step3],Xe[n][ae.Step3])),i.a.createElement("div",{key:"step4",className:"OnboardingModal__slide OnboardingModal__slide_4"},k(Qe[n][ae.Step4],Xe[n][ae.Step4]))]}),[n]);return i.a.createElement(l.M,{id:t,className:"OnboardingModal",onClose:function(){return y(!1)}},i.a.createElement(l.A,{mode:"plain"},i.a.createElement(l.y,{slideWidth:"100%",style:{height:c?406:306},slideIndex:g,isDraggable:!1,bullets:"dark"},S),i.a.createElement(l.i,{className:"OnboardingModal__button",size:"l",stretched:!0,onClick:function(){g===C-1?f().then((function(e){a(),Object(pe.a)((function(){_(i.a.createElement(He.a,{onClose:function(){return y(!0)}},i.a.createElement(qe.a,{src:Object(p.d)(ze.a,e)})))}))})):g!==C-1&&E(g+1)}},D)))},nt=Object(o.memo)(tt),at=n(73),rt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};var ot=n(842),it={insert:"head",singleton:!1},lt=(S()(ot.a,it),ot.a.locals,function(){return(lt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),ct=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},ut=function(e){var t,n=Object(u.c)().getLangKey,a=Object(g.b)().inviteLink,d=ct(Object(o.useState)(!1),2),m=d[0],p=d[1],C=Object(g.a)(),y=Object(o.useContext)(v.a),O=y.go,j=y.apiRequest,D=Object(l.Ib)().viewWidth,S=Object(b.a)(D),F=D<l.Cb.TABLET,x=at.b.parse(window.location.href).schoolId,A=e.role===s.a.TEACHER;Object(o.useEffect)((function(){return x&&(e.school||(p(!0),j("education.getSchoolById",{school_id:+x,fields:"city,country",v:"5.124"}).then((function(t){C(e.update({country:t.country,city:t.city,school:t}))})).finally((function(){p(!1)})))),function(){if(a&&a.linkId&&!a.isLoaded){p(!0);var t={link_id:a.linkId,fields:"city,country"};j("education.getInviteLinkPreview",t,{grouping:!1}).then((function(t){Object(pe.a)((function(){C(Object(E.gb)({isInvite:!0})),C(Object(E.V)({linkId:a.linkId,isLoaded:!0,preview:t})),C(e.update({country:t.school.country,city:t.school.city,school:t.school,role:t.invite_link.role,classes:t.grades}))}))})).catch((function(e){e.err_code===Oe.e&&C(Object(E.V)(void 0))})).finally((function(){p(!1)}))}}(),Object(ye.b)(Oe.w),function(){C(e.update({errors:{}}))}}),[]);var w=ct(function(e){var t=rt(Object(o.useState)(e.defaultValue||""),2),n=t[0],a=t[1],r=Object(o.useRef)(e.value||e.defaultValue||""),i=Object(o.useRef)(e.hasOwnProperty("value"));Object(o.useEffect)((function(){void 0!==e.defaultValue&&e.defaultValue!==r.current&&a(e.defaultValue)}),[e.defaultValue]);var l=i.current?e.value:n;return[{value:l,onChange:function(t){r.current=t.target.value,i.current&&e.onChange?e.onChange(t):a(t.target.value)}},r,l]}({value:e.role,onChange:function(t){var n,a=Number(t.target.value),r=a===s.a.STUDENT?(null===(n=e.classes)||void 0===n?void 0:n.length)?[e.classes[0]]:[]:e.classes;C(e.update({role:a,classes:r,errors:{role:null}})),Object(k.c)("role",a,"school"),Object(k.c)("grade",null==r?void 0:r.map((function(e){return e.id})),"school")}}),1)[0],N=ct(Object(we.a)({value:e.object,onChange:function(t){var n,a;C(e.update(((n={})[t.target.name]=t.target.value,n.errors=((a={})[t.target.name]=null,a),n)));var r=t.target.name;"object"===r&&(r="subject"),Object(k.c)(r,t.target.value,"school")}}),1)[0],I=function(){e.school&&(C(Object(E.R)({isSingle:!A,schoolId:e.school.id,selectedClasses:e.classes||[],onSubmit:function(t){C(e.update({classes:t,errors:{classes:null}})),Object(k.c)("grade",null==t?void 0:t.map((function(e){return e.id})),"school")}})),O(c.g.SELECT_CLASSES,{schoolId:e.school.id}))},M=Object(o.useMemo)((function(){return A&&e.classes&&e.classes.length?e.classes.map((function(e){return Object(h.d)(e)})).join(", "):""}),[e.classes,A]);if(m)return i.a.createElement(l.Y,null);var L=i.a.createElement(l.u,{key:"country",top:n("vkui_edu_contry"),bottom:e.errors.country,status:e.errors.country?"error":"default"},i.a.createElement(l.jb,{placeholder:n("vkui_edu_contry_select"),disabled:e.disabled,onClick:function(){var t=e.country;C(Object(E.S)({onSelect:function(n){t&&n.id===t.id||(C(e.update({country:n,city:void 0,school:void 0,classes:[],errors:{country:null,city:null,school:null,classes:null}})),Object(k.c)("country",null==n?void 0:n.id,"region"))}})),O(c.g.SELECT_COUNTRY)}},e.country?e.country.title:null)),T=i.a.createElement(l.u,{key:"city",top:n("vkui_edu_city"),bottom:e.errors.city,status:e.errors.city?"error":"default"},i.a.createElement(l.jb,{placeholder:n("vkui_edu_city_select"),disabled:e.disabled||!e.country,onClick:function(){if(e.country){var t=e.city;C(Object(E.Q)({countryId:e.country.id,onSelect:function(n){t&&n.id===t.id||(C(e.update({city:n,school:void 0,classes:[],errors:{city:null,school:null,classes:null}})),Object(k.c)("city",null==n?void 0:n.id,"region"))}})),O(c.g.SELECT_CITY)}}},e.city?e.city.title:null)),B=i.a.createElement(l.u,{key:"educational_institution",top:n("vkui_edu_educational_institution"),bottom:e.errors.school,status:e.errors.school?"error":"default"},i.a.createElement(l.jb,{placeholder:n("vkui_edu_educational_institution_select"),disabled:e.disabled||!e.city,onClick:function(){if(e.city){var t=e.school;C(Object(E.U)({method:"education.searchSchools",cityId:e.city.id,onSelect:function(n){t&&n.id===t.id||(C(e.update({school:n,classes:[],errors:{school:null,classes:null}})),Object(k.c)("school_name",null==n?void 0:n.name,"school"))}})),O(c.g.SELECT_SCHOOL)}}},e.school?e.school.name:null)),P=i.a.createElement(l.u,{key:"member_role",top:n("vkui_edu_edit_member_role"),bottom:e.errors.role,status:e.errors.role?"error":"default"},i.a.createElement(l.ib,r()({placeholder:n("vkui_edu_edit_member_role_placeholder"),name:"role",disabled:e.disabled,options:[{label:n("vkui_edu_member_role_teacher"),value:s.a.TEACHER},{label:n("vkui_edu_member_role_pupil"),value:s.a.STUDENT}]},w)));return i.a.createElement(o.Fragment,null,i.a.createElement(l.v,null,S?[i.a.createElement(l.w,{key:"0",mode:"horizontal"},L,T),i.a.createElement(l.w,{key:"1",mode:"horizontal",className:"RegistrationStep2__group"},B,P)]:[L,T,B,P],A&&i.a.createElement(l.u,{top:n("vkui_edu_edit_member_object"),bottom:e.errors.object,status:e.errors.object?"error":"default"},i.a.createElement(l.I,r()({placeholder:n("vkui_edu_edit_member_object_placeholder"),name:"object"},N))),e.role&&!A&&i.a.createElement(l.u,{top:n("vkui_edu_class"),bottom:e.errors.classes,status:e.errors.classes?"error":"default"},i.a.createElement(l.jb,{placeholder:n("vkui_edu_class_select"),disabled:e.disabled||!e.school,onClick:I},e.classes&&e.classes.length>0?Object(h.d)(e.classes[0]):null)),e.role&&A&&i.a.createElement(l.u,null,i.a.createElement(l.lb,{className:Object(l.Fb)("SchoolRequestForm__classes",{"SchoolRequestForm__classes--error":!!e.errors.classes,"SchoolRequestForm__classes--disabled":!e.school}),before:S||(null===(t=e.classes)||void 0===t?void 0:t.length)?i.a.createElement(_.a,null):null,description:M,onClick:I},e.classes&&e.classes.length?n("vkui_edu_classes"):n("vkui_edu_choose_classes"))),e.hint&&i.a.createElement(l.u,null,i.a.createElement(l.x,{className:"SchoolRequestForm__hint"},e.hint))),i.a.createElement(f.a,{sticky:F,noShadow:!0},i.a.createElement(l.i,{stretched:!S,size:S?"m":"l",onClick:function(){var t=e.country,a=e.city,r=e.school,o=e.role,i=e.classes,l=e.object,c=!0,u={};t||(c=!1,u=lt(lt({},u),{country:n("vkui_edu_contry_error")})),a||(c=!1,u=lt(lt({},u),{city:n("vkui_edu_city_error")})),r||(c=!1,u=lt(lt({},u),{school:n("vkui_edu_educational_institution_error")})),o||(c=!1,u=lt(lt({},u),{role:n("vkui_edu_role_error")})),i&&0!==i.length||(c=!1,u=lt(lt({},u),{classes:n("vkui_edu_class_error")}));var s=ct(Ie(l),2),d=s[0],_=s[1];if(d||(c=!1,u=lt(lt({},u),{object:n("vkui_edu_validation_school_subject").replace("{characters}",_.map(Te.c).join(", "))})),!c)return C(e.update({errors:u})),void Object(k.b)({event_type:"field_input",is_failed:!0,failed_reason:JSON.stringify(u)});e.submit(),e.clean&&C(e.clean())}},e.submitText)))},st=n(353),dt=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},_t=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},mt=function(e){var t=e.id,n=e.onClose,a=dt(e,["id","onClose"]),d=Object(u.c)().getLangKey,_=Object(o.useContext)(v.a),m=_.go,f=_.back,b=_.apiRequest,h=_.getUserSchools,p=_.getUserOnboardingStatus,C=_.showError,y=Object(g.b)(),O=y.registeredAccountInfo,j=y.inviteLink,D=Object(g.a)(),S=je();return i.a.createElement(l.N,r()({id:t,header:i.a.createElement(l.O,{left:i.a.createElement(l.T,{onClick:f})},d("vkui_edu_educational_institution")),onClose:n},a),i.a.createElement(ut,r()({},O,{update:E.gb,submit:function(){var e=O.firstName,t=O.lastName,n=O.middleName,a=void 0===n?"":n,r=O.sex,o=O.bdate,i=O.country,l=O.city,u=O.school,d=O.classes,_=O.role,f=_===s.a.TEACHER?O.object:"",v=d.map((function(e){return e.id})).join(","),g={user_id:O.id,first_name:e,last_name:t,nick_name:a,sex:r,bdate:o,country_id:i.id,city_id:l.id,school_id:u.id,role_description:f,role:_,grade_ids:v},y=function(e){m(c.g.REGISTRATION_STEP_1),setTimeout((function(){return C(e)}),0)};Ee(b,g,y).then((function(){return D(Object(E.Y)({firstName:e,lastName:t,middleName:a,sex:r,bdate:o,signupRequired:!1})),Object(k.b)({event_type:"registration_success",registration_type:(null==j?void 0:j.linkId)?"by_invitation":"by_yourself",invite_link_id:null==j?void 0:j.linkId}),Object(ke.a)({event_type:"registration",edu_user_id:g.user_id,school_id:g.school_id}),!j&&v&&Object(k.b)({event_type:"join_request_send"}),S(),Promise.all([b("education.getGradeRequests",{},{grouping:!1}),h()]).then((function(e){var t=_t(e,1)[0];D(Object(E.r)(Object(st.a)(t))),m(c.a),setTimeout((function(){p()}),500)}))})).catch(y)},disabled:O.isInvite,hint:d(O.isInvite?"vkui_edu_registration_message_invite":"vkui_edu_registration_message"),submitText:d("vkui_edu_register_now")})))},ft=function(){return(ft=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},bt=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},ht=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},pt=function(e){var t=e.id,n=e.onClose,a=bt(e,["id","onClose"]),s=Object(u.c)().getLangKey,d=Object(l.Ib)().viewWidth,_=Object(b.a)(d),m=d<l.Cb.TABLET,h=Object(g.b)().registeredAccountInfo,p=Object(g.a)(),C=Object(o.useContext)(v.a),y=C.go,O=C.apiRequest,j=C.getUserSchools,D=C.getUserOnboardingStatus,S=C.showError,F=ht(Object(o.useState)({}),2),x=F[0],A=F[1],w=Object(o.useCallback)((function(e){p(Object(E.gb)(e))}),[p]),N=function(e){var t,n,a=e.target,r=a.name,o=a.value,i=null!==(n={firstName:"first_name",lastName:"last_name",middleName:"nickname"}[r])&&void 0!==n?n:r;Object(k.c)(i,o,"personal_data"),p(Object(E.gb)(((t={})[r]=o,t))),A((function(e){var t;return ft(ft({},e),((t={})[r]=null,t))}))},I=Object(o.useCallback)((function(e){p(Object(E.gb)({sex:e})),Object(k.c)("sex",e,"personal_data"),A((function(e){return ft(ft({},e),{sex:null})}))}),[p]),M=Object(o.useCallback)((function(e){p(Object(E.gb)({bdate:e})),Object(k.c)("bday",e,"personal_data"),A((function(e){return ft(ft({},e),{bdate:null})}))}),[p]),L=Object(se.a)({ownerId:h.id,hasPhoto:!!h.hasPhoto,photoUrl:h.photo||"",photoRawId:h.photoRawId||"",onUpdate:w}).uploadControl,T=ht(Object(de.a)({value:h.sex||0,onChange:I}),1)[0],B=ht(Object(_e.a)({value:h.bdate||"",onChange:M}),1)[0],P=Object(o.useMemo)((function(){return s("vkui_common_months_short_of").map((function(e){return e[0].toUpperCase()+e.slice(1)}))}),[s]);return i.a.createElement(l.N,r()({id:t,header:i.a.createElement(l.O,{left:i.a.createElement(l.T,{onClick:n})},s("vkui_edu_info")),onClose:n},a),i.a.createElement(l.r,{className:"Registration__settingsHeader"},i.a.createElement(he.a,{photo:L,caption:s("vkui_edu_settings_title")})),i.a.createElement(l.v,null,i.a.createElement(l.w,{mode:"horizontal"},i.a.createElement(l.u,{top:s("vkui_edu_settings_first_name"),bottom:x.firstName,status:x.firstName?"error":"default"},i.a.createElement(l.I,{name:"firstName",placeholder:s("vkui_edu_settings_first_name_placeholder"),value:h.firstName,onChange:N})),i.a.createElement(l.u,{top:s("vkui_edu_settings_last_name"),bottom:x.lastName,status:x.lastName?"error":"default"},i.a.createElement(l.I,{name:"lastName",placeholder:s("vkui_edu_settings_last_name_placeholder"),value:h.lastName,onChange:N}))),i.a.createElement(l.w,{mode:"horizontal"},i.a.createElement(l.u,{top:s("vkui_edu_settings_middle_name")},i.a.createElement(l.I,{name:"middleName",placeholder:s("vkui_edu_settings_middle_name_placeholder"),value:h.middleName,onChange:N})),i.a.createElement(l.u,{top:s("vkui_edu_settings_sex"),bottom:x.sex,status:x.sex?"error":"default"},i.a.createElement(l.ib,r()({name:"sex",placeholder:s("vkui_edu_settings_sex_select"),options:[{label:s("vkui_edu_settings_sex_male"),value:ue.a.MALE},{label:s("vkui_edu_settings_sex_female"),value:ue.a.FEMALE}]},T)))),i.a.createElement(l.u,{top:s("vkui_edu_settings_birthday_date"),bottom:x.bdate,status:x.bdate?"error":"default"},i.a.createElement(l.q,r()({name:"bdate",sizeX:l.mb.REGULAR},B,{monthNames:P,popupDirection:"top",dayPlaceholder:s("vkui_edu_settings_datepicker_day_placeholder"),monthPlaceholder:s("vkui_edu_settings_datepicker_month_placeholder"),yearPlaceholder:s("vkui_edu_settings_datepicker_year_placeholder")})))),i.a.createElement(f.a,{sticky:m,noShadow:m},i.a.createElement(l.i,{stretched:!_,size:_?"m":"l",onClick:function(){var e=h.firstName,t=h.lastName,n=h.middleName,a=void 0===n?"":n,r=h.sex,o=h.bdate,i=!0,l={};""===e.trim()&&(i=!1,l=ft(ft({},l),{firstName:s("vkui_edu_settings_first_name_placeholder")})),""===t.trim()&&(i=!1,l=ft(ft({},l),{lastName:s("vkui_edu_settings_last_name_placeholder")})),r||(i=!1,l=ft(ft({},l),{sex:s("vkui_edu_settings_sex_select")}));var u=Object(me.a)(o);if(u.year&&u.month&&u.day||(i=!1,l=ft(ft({},l),{bdate:s("vkui_edu_settings_birthday_date")})),i){var d={user_id:h.id,first_name:e,last_name:t,nick_name:a,sex:r,bdate:o};O("execute",ft(ft({},d),{code:"return [\n        API.account.saveProfileInfo({\n          first_name: Args.first_name,\n          last_name: Args.last_name,\n          nick_name: Args.nick_name,\n          sex: Args.sex,\n          bdate: Args.bdate,\n        }),\n        API.education.joinSchools()\n      ];"}),{showSpinner:!0}).then((function(){return p(Object(E.Y)({firstName:e,lastName:t,middleName:a,sex:r,bdate:o,signupRequired:!1})),j().then((function(){y(c.a),setTimeout((function(){D()}),500)}))})).catch(S)}else A(l)}},s("vkui_edu_register_now"))))},vt=n(907),gt=n(843),Et={insert:"head",singleton:!1},Ct=(S()(gt.a,Et),gt.a.locals,function(e){var t=Object(u.c)().getLangKey,n=Object(g.b)().chatAccessRestrictedType;n||(n="school");var a={grade:t("vkui_edu_chat_join_restricted_title_grade"),school:t("vkui_edu_chat_join_restricted_title_school"),private:t("vkui_edu_chat_join_restricted_title_privacy")},o={grade:t("vkui_edu_chat_join_restricted_caption_grade"),school:t("vkui_edu_chat_join_restricted_caption_school"),private:""};return i.a.createElement(l.M,r()({},e,{icon:i.a.createElement(vt.a,null),header:a[n],subheader:o[n],className:"ChatAccessRestricted",actions:i.a.createElement(l.i,{type:"button",size:"m",mode:"secondary",onClick:function(){e.onClose()}},t("vkui_edu_chat_join_restricted_understood"))}))}),yt=n(844),Ot={insert:"head",singleton:!1},jt=(S()(yt.a,Ot),yt.a.locals,function(e){var t=e.children;return i.a.createElement(l.A,{className:"DocumentBlank",mode:"plain"},i.a.createElement(l.r,null,t))}),kt=n(109),Dt=n(845),St={insert:"head",singleton:!1},Ft=(S()(Dt.a,St),Dt.a.locals,function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey;return i.a.createElement(l.N,{header:i.a.createElement(B,{onClose:n},a("vkui_edu_vkedu_privacy_header")),id:t,onClose:n,viewWidth:l.Cb.DESKTOP,className:"PrivacyModal"},i.a.createElement(jt,null,i.a.createElement(kt.a,{Component:"h1"},a("vkui_edu_vkedu_privacy_title")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_1")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_2")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_3")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_4")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_5")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_6")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_7")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_8")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_privacy_9"))))}),xt=n(88),At=n(846),wt={insert:"head",singleton:!1},Nt=(S()(At.a,wt),At.a.locals,function(e){return e.replace(/<a\s+(?:[^>]*?\s+)?href=["']?(\/away\.php\?to=http[s]?%3A%2F%2Fsferum\.ru)/,(function(e,t){return e.replace(t,"https://sferum.ru")})).replace(/<a\s+(?:[^>]*?\s+)?(onclick=(['"]?return goAway\(['"]?http[s]?\:\/\/sferum\.ru['"]?\)"))/,(function(e,t){return e.replace(t,"")}))}),It=function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey;return i.a.createElement(l.N,{header:i.a.createElement(B,{onClose:n},a("vkui_edu_vkedu_terms_header")),id:t,onClose:n,viewWidth:l.Cb.DESKTOP,className:"AgreementModal"},i.a.createElement(xt.a,null,i.a.createElement(jt,null,i.a.createElement(kt.a,{Component:"h1"},a("vkui_edu_vkedu_terms_title")),i.a.createElement(kt.a,{Component:"p"},Nt(a("vkui_edu_vkedu_terms_1"))),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_terms_2")),i.a.createElement(kt.a,{Component:"p"},Nt(a("vkui_edu_vkedu_terms_3"))),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_terms_4")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_terms_5")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_terms_6")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_terms_7")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_terms_8")),i.a.createElement(kt.a,{Component:"p"},a("vkui_edu_vkedu_terms_9")))))},Mt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Lt=function(e){var t=Object(u.c)().getLangKey,n=Object(g.b)(),a=Object(l.Ib)().viewWidth,r=Object(b.a)(a),c=n.docEditInfo,s=c.onEdit,d=c.documentTitle,_=Mt(Object(o.useState)(c.documentTitle),2),m=_[0],h=_[1],p=Mt(Object(o.useState)(!0),2),v=p[0],E=p[1],C=Object(o.useCallback)((function(e){var t=e.target.value;h(t),E(!!t.trim())}),[]),y=Object(o.useCallback)((function(){v&&"function"==typeof s&&s(m).then(e.onClose)}),[s,m,v,e.onClose]);return Object(o.useEffect)((function(){return h(c.documentTitle)}),[c.documentTitle]),Object(o.useEffect)((function(){return h(d)}),[d]),i.a.createElement(l.N,{id:e.id,onClose:e.onClose,header:i.a.createElement(B,{onClose:e.onClose},t("vkui_edu_docs_editing_header"))},i.a.createElement(l.v,null,i.a.createElement(l.u,{bottom:!v&&t("vkui_edu_doc_edit_title_info"),status:v?"default":"error"},i.a.createElement(l.I,{placeholder:t("vkui_edu_doc_edit_title_placeholder"),value:m,onChange:C}))),i.a.createElement(f.a,{noShadow:!0,noMargin:!0},i.a.createElement(l.i,{stretched:!r,type:"submit",size:r?"m":"l",onClick:y},t("vkui_edu_docs_editing_save"))))},Tt=n(847),Bt={insert:"head",singleton:!1},Pt=(S()(Tt.a,Bt),Tt.a.locals,n(848)),Rt={insert:"head",singleton:!1},Ut=(S()(Pt.a,Rt),Pt.a.locals,n(166)),zt=[1,2,3,4,5,6,7,8,9,10,11,12,13,14],Ht=function(e){return e%zt.length},qt=function(e){var t=e.value,n=e.onChange,a=e.className,r=Object(l.Ib)().viewWidth,o=Object(b.a)(r),c=function(e){return function(){n(e)}},u=o?zt.slice(0,7):zt,s=o?zt.slice(7):[];return i.a.createElement("div",{className:Object(l.Fb)(a,"ColorSelector")},i.a.createElement("div",{className:"ColorSelector__row"},u.map((function(e){return i.a.createElement("button",{className:Object(l.Fb)("ColorSelector__item","ColorSelector--color"+e,{"ColorSelector__item--selected":t===e}),key:e,type:"button",onClick:c(e)},i.a.createElement(Ut.a,{size:42,color:e}))}))),i.a.createElement("div",{className:"ColorSelector__row"},s.map((function(e){return i.a.createElement("button",{className:Object(l.Fb)("ColorSelector__item","ColorSelector--color"+e,{"ColorSelector__item--selected":t===e}),key:e,type:"button",onClick:c(e)},i.a.createElement(Ut.a,{size:42,color:e}))}))))},Wt=function(){return(Wt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Jt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Kt=[1,2,3,4,5,6,7,8,9,10,11],Vt=/^[\d]+$/,Gt={id:null,color:1,number:Kt[0],liter:"А",end_year:2021},Yt=function(e){return!!e&&(!Vt.test(e)||e.length>4)},Qt=function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey,r=Object(o.useContext)(v.a).back,c=Object(g.b)().editGradeInfo,s=c.grade,d=void 0===s?Gt:s,_=c.onSubmit,m=Jt(Object(o.useState)(d),2),h=m[0],p=m[1],E=Jt(Object(o.useState)({}),2),C=E[0],y=E[1],O=Object(l.Ib)().viewWidth,j=Object(b.a)(O),k=O<l.Cb.TABLET,D=function(e){e.preventDefault();var t=!0,n={};h.start_year&&(h.start_year<2e3?(t=!1,n=Wt(Wt({},n),{start_year:a("vkui_edu_grade_min_start_year_error")+" 2000"})):h.end_year&&h.start_year>h.end_year&&(t=!1,n=Wt(Wt({},n),{start_year:a("vkui_edu_grade_start_year_large_end_year_error")}))),!h.end_year||h.end_year<2021?(t=!1,n=Wt(Wt({},n),{end_year:a("vkui_edu_grade_min_end_year_error")+" 2021"})):h.end_year<h.start_year&&(t=!1,n=Wt(Wt({},n),{end_year:a("vkui_edu_grade_end_year_less_start_year_error")})),t?_&&_(h):y(n)},S=Object(o.useMemo)((function(){return Kt.map((function(e){return{label:e.toString(),value:e}}))}),[]),F=!!d.id,x=a(F?"vkui_edu_edit_header":"vkui_edu_create_grade_header"),A=a(F?"vkui_edu_select_classes_save":"vkui_edu_select_classes_continue"),w=i.a.createElement(l.u,{key:"vkui_edu_create_grade_number",top:a("vkui_edu_create_grade_number")},i.a.createElement(l.ib,{value:h.number,options:S,onChange:function(e){var t=e.target.value;p((function(e){return Wt(Wt({},e),{number:+t})}))}})),N=i.a.createElement(l.u,{key:"vkui_edu_create_grade_liter",top:a("vkui_edu_create_grade_liter")},i.a.createElement(l.I,{value:h.liter,onChange:function(e){var t=e.currentTarget.value;t=(t=t.toLocaleUpperCase()).replace(/[^A-ZА-Я0-9]/g,""),p((function(e){return Wt(Wt({},e),{liter:t})}))},maxLength:3})),I=i.a.createElement(l.u,{key:"vkui_edu_create_grade_start_year",top:a("vkui_edu_create_grade_start_year"),bottom:C.start_year,status:C.start_year?"error":"default"},i.a.createElement(l.I,{value:h.start_year||"",onChange:function(e){var t=e.currentTarget.value;Yt(t)||(y((function(e){return Wt(Wt({},e),{start_year:void 0})})),p((function(e){return Wt(Wt({},e),{start_year:+t||void 0})})))}})),M=i.a.createElement(l.u,{key:"vkui_edu_create_grade_end_year",top:a("vkui_edu_create_grade_end_year"),bottom:C.end_year,status:C.end_year?"error":"default"},i.a.createElement(l.I,{value:h.end_year||"",onChange:function(e){var t=e.currentTarget.value;Yt(t)||(y((function(e){return Wt(Wt({},e),{end_year:void 0})})),p((function(e){return Wt(Wt({},e),{end_year:+t||2021})})))}}));return i.a.createElement(l.N,{className:"CreateGrade",id:t,header:i.a.createElement(B,{left:"",right:!j&&i.a.createElement(l.U,{onClick:r},a("vkui_edu_cancel")),onClose:n},x),onClose:n},i.a.createElement(l.v,{onSubmit:D},j?i.a.createElement(l.w,{mode:"horizontal"},w,N):[w,N],i.a.createElement(l.w,{mode:"horizontal"},i.a.createElement(l.u,{top:a("vkui_edu_create_grade_name")},i.a.createElement(l.I,{value:h.name,onChange:function(e){var t=e.currentTarget.value;p((function(e){return Wt(Wt({},e),{name:t})}))}}))),j?i.a.createElement(l.w,{mode:"horizontal"},I,M):[I,M],i.a.createElement(l.w,{mode:"horizontal"},i.a.createElement(l.u,{top:a("vkui_edu_create_grade_color")},i.a.createElement(qt,{value:h.color,onChange:function(e){p((function(t){return Wt(Wt({},t),{color:e})}))}})))),i.a.createElement(f.a,{fixed:!0,sticky:k,noShadow:k},i.a.createElement(l.i,{stretched:!j,type:"submit",size:j?"m":"l",onClick:D},A)))},Xt=Object(o.memo)(Qt),Zt=n(849),$t={insert:"head",singleton:!1},en=(S()(Zt.a,$t),Zt.a.locals,n(728));function tn(e){var t=e&&e.current?e.current:document.body;return{x:t.scrollLeft,y:t.scrollTop}}var nn,an=n(174),rn=n(850),on={insert:"head",singleton:!1},ln=(S()(rn.a,on),rn.a.locals,n(908)),cn=function(e){var t=e.photo,n=e.name,a=e.onRemove;return i.a.createElement("div",{className:"SmallOwnerItem"},i.a.createElement("div",{className:"SmallOwnerItem__photo"},i.a.createElement(l.h,{size:56,src:t,alt:"string"==typeof n?n:""}),a&&i.a.createElement("button",{className:"SmallOwnerItem__removeBtn",type:"button",onClick:a},i.a.createElement(ln.a,null))),i.a.createElement(l.j,{className:"SmallOwnerItem__name",weight:"regular",level:"2"},n))},un=function(e){var t=e.spacing,n=e.children,a={minWidth:t};return i.a.createElement(o.Fragment,null,i.a.createElement("div",{style:a}),n,i.a.createElement("div",{style:a}))},sn=function(){return(sn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},dn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},_n=function(e){var t,n=e.memberEditInfo,a=e.objectFixed,r=void 0!==a&&a,c=e.onChange,d=dn(Object(o.useState)(n),2),_=d[0],m=d[1],b=Object(u.c)().getLangKey,p=Object(o.useRef)(null),v=n.role===s.a.TEACHER;Object(o.useEffect)((function(){p.current&&p.current.focus()}),[]);var g=((t={})[s.a.STUDENT]=b("vkui_edu_member_role_pupil"),t[s.a.TEACHER]=b("vkui_edu_member_role_teacher"),t);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.v,{Component:"div"},i.a.createElement(l.u,null,i.a.createElement(l.jb,{disabled:!0},g[n.role])),i.a.createElement(l.u,null,i.a.createElement(l.jb,{disabled:!0},n.grade?Object(h.d)(n.grade):"")),v&&i.a.createElement(l.u,{top:b("vkui_edu_edit_member_object")},i.a.createElement(l.I,{disabled:r,placeholder:b("vkui_edu_edit_member_object_placeholder"),name:"object",getRef:function(e){return p.current=e},value:_.object,onChange:function(e){var t=e.target?e.target.name:null,n=e.target?e.target.value:null;t&&m((function(e){var a;return sn(sn({},e),((a={})[t]=n,a))}))}}))),i.a.createElement(f.a,null,i.a.createElement(l.i,{type:"button",size:"m",onClick:function(){c(_)}},b("vkui_edu_edit_member_save"))))},mn=n(355),fn=function(){return(fn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},bn=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},hn=function(e,t,n){var a=e.grades?e.grades.find((function(e){return e.id===t})):null,r=a&&a.roles?a.roles.find((function(e){return n===e.role})):null;return r?r.role_description:""},pn=Object.freeze({role:mn.a}),vn=function(e){return e.role},gn=function(e){return e.flatMap((function(e){var t=e.roles,n=bn(e,["roles"]);return t?t.map(function(e){return function(t){return fn(fn({},t),{role:t.role||mn.a,gradeId:e.id})}}(n)):[pn]}))},En=function(e){return e.grades&&e.grades.length?gn(e.grades):[pn]},Cn=function(e){return function(t){return t.gradeId===e}},yn=function(e,t){return function(n){return n.inGrade?t.includes(n.role):e.includes(n.role)}},On=function(e,t){var n=e.includeRoles,a=e.excludeRoles;return function(e){var r=En(e),o=r.map(vn),i=r.filter(Cn(t)).map(vn),l=n.some(yn(o,i)),c=!a.some(yn(o,i));return l&&c}},jn=function(e){return function(t){return!e.includes(t.id)}},kn=function(e,t,n){var a=En(e);return n?a.filter(Cn(n)).map(vn).includes(t):a.map(vn).includes(t)},Dn=function(){return(Dn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Sn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Fn=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Sn(arguments[t]));return e},xn=function(e){var t=e.id,n=e.onClose,a=Object(o.useContext)(l.Q).updateModalHeight,r=Object(u.c)().getLangKey,c=Object(g.b)().selectParticipantsInfo,d=c.type,_=c.multiple,m=c.role,h=c.edit,p=c.replaceRole,E=c.grade,C=c.onSubmit,y=c.selectedParticipants,O=c.fromGrade,j=c.gradeId,k=c.schoolId,D=c.filterCase,S=Sn(Object(o.useState)([]),2),F=S[0],x=S[1],A=Sn(Object(o.useState)([]),2),w=A[0],N=A[1],I=Sn(Object(o.useState)(null),2),M=I[0],L=I[1],T=Sn(Object(o.useState)([]),2),P=T[0],R=T[1],U=Sn(Object(o.useState)(!1),2),z=U[0],H=U[1],q=Object(an.a)(k).getSchoolMembers,W=Sn(Object(o.useState)(""),2),J=W[0],K=W[1],V=Object(o.useContext)(v.a),G=V.apiRequest,Y=V.showError,Q=V.back,X=Sn(Object(o.useState)({x:0,y:0}),2),Z=X[0],$=X[1],ee=Object(o.useRef)(null),te=Object(l.Ib)().viewWidth,ne=Object(b.a)(te),ae=te<l.Cb.TABLET;!function(e,t,n,a){void 0===a&&(a=500);var r=Object(o.useRef)(tn(e)),i=null,l=function(){var n=tn(e);t&&t({prevPos:r.current,currPos:n}),r.current=n,i=null};Object(o.useLayoutEffect)((function(){var t=function(){a?null===i&&(i=setTimeout(l,a)):l()},n=e&&e.current?e.current:window;return n.addEventListener("scroll",t),function(){return n.removeEventListener("scroll",t)}}),n),r.current}(ee,(function(e){var t=e.currPos;t.y&&$(t)}));var oe=null===M,ie=Object(o.useCallback)((function(){ee.current&&(ee.current.scrollTop=Z.y)}),[Z.y]);Object(o.useEffect)((function(){ie()}),[oe,ie]),Object(o.useEffect)((function(){q().then((function(e){return O?G("education.getGradeMembers",{group_id:k,grade_id:j}).then((function(t){var n=t.items;return D&&D.type===s.a.TEACHER?e.filter(function(e,t){return function(n){var a=e.includes(n.id),r=kn(n,s.a.STUDENT),o=kn(n,s.a.TEACHER),i=kn(n,s.a.TEACHER,t),l=kn(n,s.a.CLASS_TEACHER,t);return!a&&!r||o&&!i||!i&&l}}(n,j)):"create"===D.type?e.filter(On(D,j)):D?e.filter(jn(n)).filter(On(D,j)):e.filter(jn(n))})):D?e.filter(On(D,j)):e})).then((function(e){H(!0),x(e),y.length&&N(e.filter(function(e){return function(t){return e.includes(t.id)}}(y)))}))}),[]),Object(o.useEffect)((function(){a()}),[J,F,a]);var le,ce=function(){L(null)},ue=Object(o.useCallback)((function(e){var t,n,a;if(!J)return!0;var r=null!==(t=J.toString().toLowerCase())&&void 0!==t?t:"",o=null===(n=e.first_name)||void 0===n?void 0:n.toLowerCase().includes(r),i=null===(a=e.last_name)||void 0===a?void 0:a.toLowerCase().includes(r);return o||i}),[J]),se=function(e){return function(){h&&R(P.filter((function(t){return t.userId===e.id}))),N(w.filter((function(t){return t!==e})))}},de=function(){return M?ce():n()};switch(d){case"select":le="vkui_edu_select_grade_members_select_title";break;case"add":le="vkui_edu_select_grade_members_add_title"}return i.a.createElement(l.N,{className:"SelectParticipants",getModalContentRef:ee,id:t,header:i.a.createElement(B,{left:!ne&&i.a.createElement(l.T,{onClick:Q}),onClose:de},M&&h?M.first_name+" "+M.last_name:r(le)),onClose:de},M&&h?i.a.createElement(_n,{memberEditInfo:{grade:E,userId:M.id,role:m,object:hn(M,j,m)},onChange:function(e){R(Fn(P,[e]));var t=F.find((function(t){return t&&t.id===e.userId}));N((function(e){return Fn(e,[t])})),ce()}}):i.a.createElement(i.a.Fragment,null,i.a.createElement(re.a,{className:"SelectParticipants__search",value:J,onChange:function(e){K(e.currentTarget.value)}}),"select"===d&&i.a.createElement(l.E,{className:"SelectParticipants__selected"},i.a.createElement("div",{className:"SelectParticipants__selectedIn"},0===w.length&&i.a.createElement("div",{className:"SelectParticipants__selectedPlaceholder"},r("vkui_edu_select_grade_members_users_placeholder")),w.length>0&&i.a.createElement(un,{spacing:8},w.map((function(e){return i.a.createElement(cn,{key:e.id,photo:e.photo_200,name:e.first_name+" "+e.last_name,onRemove:se(e)})}))))),z?i.a.createElement(en.a,{selectable:_,multiple:_,className:"SelectParticipants__list",users:F.filter(ue),selectedUsers:w,onSelectUser:function(e){h&&L(e)},onSelectChange:function(e){h||N(e),!_&&C&&C(e.map((function(e){return e.id})),(function(){return Promise.resolve()}))}}):i.a.createElement(l.Y,null),_&&i.a.createElement(f.a,{fixed:!0,sticky:ae,noShadow:ae},i.a.createElement(l.i,{stretched:!ne,size:ne?"m":"l",onClick:function(){C&&(H(!1),h&&P.length?C(w.map((function(e){return e.id})),(function(){return(e=[],P.forEach((function(t){e.push(function(e){var t=e.apiRequest,n=e.schoolId,a=e.gradeId,r=e.userId,o=e.role,i=e.object,l=e.replace;return t("execute",{school_id:n,user_id:r,role:o,code:void 0===l||l?'\n    API.education.editRole({\n      school_id: Args.school_id,\n      grade_ids: "'+a+'",\n      user_id: Args.user_id,\n      role: Args.role,\n      new_role_description: "'+i+'"\n    });\n\n    return true;\n  ':'\n     API.education.addToGrade({\n       group_id: Args.school_id,\n       grade_ids: "'+a+'",\n       user_id: Args.user_id,\n       role: Args.role,\n       role_description: "'+i+'"\n    });\n\n    return true;\n  '},{showSpinner:!0})}(Dn(Dn({},t),{apiRequest:G,gradeId:j,schoolId:k,replace:p})))})),Promise.all(e)).catch((function(e){H(!0),Y(e)}));var e})):(C(w.map((function(e){return e.id})),(function(){return Promise.resolve()})),H(!0)))}},r("vkui_edu_select_classes_save")))))},An=Object(o.memo)(xn),wn=n(851),Nn={insert:"head",singleton:!1},In=(S()(wn.a,Nn),wn.a.locals,function(e){var t=e.id,n=e.onClose,a=Object(g.b)().docUploadInfo,r=Object(u.c)().getLangKey,c=Object(o.useRef)(null);Object(o.useEffect)((function(){c.current=document.createElement("input"),c.current.type="file";var e=function(e){var t,r=e.target.files[0];"function"==typeof(null===(t=null==a?void 0:a.onFileSelectRef)||void 0===t?void 0:t.current)&&(a.onFileSelectRef.current(r),n())};return c.current.addEventListener("change",e),function(){c.current.removeEventListener("change",e)}}),[null==a?void 0:a.onFileSelectRef,n]);var s=Object(o.useCallback)((function(){c.current&&c.current.click()}),[]);return i.a.createElement(l.N,{header:"",id:t,onClose:n},i.a.createElement(B,{className:"DocumentUpload__header",onClose:n}),i.a.createElement(l.r,null,i.a.createElement("div",{className:"DocumentUpload__center"},i.a.createElement(l.zb,{level:"1",weight:"bold"},r("vkui_edu_doc_upload_restrictions_title")),i.a.createElement(l.xb,{className:"DocumentUpload__text",weight:"regular"},r("vkui_edu_docs_upload_size_limit")),i.a.createElement(l.xb,{className:"DocumentUpload__text",weight:"regular"},r("vkui_edu_docs_upload_extensions")),i.a.createElement(l.xb,{className:"DocumentUpload__text",weight:"regular"},r("vkui_edu_docs_upload_copyright")),i.a.createElement("br",null),i.a.createElement(l.i,{size:"m",onClick:s},r("vkui_edu_docs_upload_button")))))}),Mn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Ln=[],Tn=[],Bn=!1,Pn=function(e){var t=Object(u.c)().getLangKey,n=Object(g.b)(),a=Object(o.useContext)(v.a),r=Object(o.useContext)(l.Q).updateModalHeight,c=Mn(Object(o.useState)(!Bn),2),s=c[0],d=c[1],_=Mn(Object(o.useState)(Bn?Ln:[]),2),m=_[0],f=_[1],b=Mn(Object(o.useState)(""),2),h=b[0],p=b[1],E=n.selectCountryInfo,C=Object(o.useCallback)((function(){Bn||a.apiRequest("execute",{code:"return {\n        all: API.database.getCountries({ need_all: 1, count: 1000 }).items,\n        important: API.database.getCountries().items\n      };"}).then((function(e){var t=e.all,n=e.important;Tn=t,Ln=n,Bn=!0,d(!1),f(Ln)}))}),[a]);Object(o.useEffect)((function(){s&&C()}),[s,C]),Object(o.useEffect)((function(){r()}),[m,r]);var y=function(e){var t=Number(e.currentTarget.dataset.id),n=Tn.find((function(e){return e.id===t}));n&&(a.back(),E.onSelect(n))};return i.a.createElement(l.N,{id:e.id,header:i.a.createElement(B,{onClose:e.onClose},t("vkui_edu_select_country_title")),onClose:e.onClose},i.a.createElement(U,null,i.a.createElement(re.a,{value:h,onChange:function(e){var t=e.target.value;p(t);var n=t.length>0?Tn.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())})).slice(0,30):Ln;f(n)}}),s&&i.a.createElement(l.Y,null),0===m.length&&!s&&i.a.createElement(l.t,null,t("vkui_common_nothing_found")),m.length>0&&i.a.createElement(o.Fragment,null,m.map((function(e){return i.a.createElement(l.l,{key:e.id,"data-id":e.id,onClick:y},e.title)})))))},Rn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Un=function(e){var t=Object(u.c)().getLangKey,n=Object(g.b)(),a=Object(o.useContext)(v.a),r=Object(o.useContext)(l.Q).updateModalHeight,c=Rn(Object(o.useState)(!1),2),s=c[0],d=c[1],_=Rn(Object(o.useState)(!0),2),m=_[0],f=_[1],b=Rn(Object(o.useState)([]),2),h=b[0],p=b[1],E=Rn(Object(o.useState)(""),2),C=E[0],y=E[1],O=Object(o.useRef)(null),j=n.selectCityInfo,k=j.countryId,D=Object(o.useCallback)((function(e){a.apiRequest("database.getCities",{country_id:k,q:e}).then((function(e){d(!0),f(!1),p(e.items)}))}),[k,a]);Object(o.useEffect)((function(){s||D()}),[s,D]),Object(o.useEffect)((function(){r()}),[h,r]);var S=function(e){var t=Number(e.currentTarget.dataset.id),n=h.find((function(e){return e.id===t}));n&&(a.back(),j.onSelect({id:n.id,title:n.title}))};return i.a.createElement(l.N,{id:e.id,header:i.a.createElement(B,{onClose:e.onClose},t("vkui_edu_select_city_title")),onClose:e.onClose},i.a.createElement(U,null,i.a.createElement(re.a,{value:C,onChange:function(e){var t=e.target.value;y(t),clearTimeout(O.current),O.current=window.setTimeout((function(){D(t)}),300)}}),m&&i.a.createElement(l.Y,null),0===h.length&&!m&&i.a.createElement(l.t,null,t("vkui_common_nothing_found")),h.length>0&&i.a.createElement(o.Fragment,null,h.map((function(e){return i.a.createElement(l.l,{key:e.id,"data-id":e.id,onClick:S,description:e.region},e.title)})))))},zn=Object(o.memo)(Un),Hn=n(852),qn={insert:"head",singleton:!1},Wn=(S()(Hn.a,qn),Hn.a.locals,n(910)),Jn=n(703),Kn=n(827),Vn=n(824),Gn=n(748),Yn=n(909),Qn=n(85),Xn=n(730),Zn=n(727),$n=n(235),ea=n(65),ta=n(23),na=n.n(ta),aa=n(16),ra=function(){return(ra=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},oa=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},ia=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(oa(arguments[t]));return e},la=Object(o.memo)(Object(l.Kb)((function(e){var t,n=e.sizeX,a=e.viewWidth,s=e.userId,d=e.onClose,_=Object(u.c)(),m=_.getLangKey,f=_.getLangSex,p=Object(g.b)(),C=p.profileCompact,y=p.accountInfo,O=p.profileContacts,j=p.profileBlackList,k=p.profileSchools,D=Object(g.a)(),S=Object(b.b)(a),F=Object(o.useContext)(v.a),x=F.apiRequest,A=F.go,w=F.onCallUser,N=oa(Object(o.useState)(!0),2),I=N[0],M=N[1],L=oa(Object(o.useState)(!1),2),T=L[0],B=L[1];Object(o.useEffect)((function(){M(!0),Promise.all([x("users.get",{user_ids:s,fields:"photo_200,contacts,sex,blacklisted_by_me,first_name_acc"}),x("friends.areFriends",{user_ids:s})]).then((function(e){return x("education.getUserSchedule",{user_id:s}).then((function(t){return ia(e,[t])})).catch((function(){return ia(e)}))})).then((function(e){var t=oa(e,3),n=t[0],a=t[1],r=t[2];D(Object(E.y)(ra(ra({},Object(Qn.f)(n[0])),{friendStatus:a[0].friend_status,schedule:r}),!0)),x("education.getSchools",{user_id:s,extended:!0,fields:"city"},{grouping:!1}).then((function(e){D(Object(E.y)({schools:e.items}))})).catch((function(e){var t;(null===(t=null==e?void 0:e.error_msg)||void 0===t?void 0:t.includes(Oe.f))&&B(!0)})).finally((function(){M(!1)}))}))}),[s]);var P=(null==C?void 0:C.schools)||[],R=Object(o.useMemo)((function(){if(!k||!P)return!1;var e=k.some((function(e){return e.isTeacherInSchool})),t=P.some((function(e){return Object(h.k)(e.grades)}));return e||!t}),[k,P]),U=function(){x("friends.areFriends",{user_ids:s}).then((function(e){D(Object(E.y)({friendStatus:e[0].friend_status}))}))},z=C.friendStatus===Yn.a.IS_FRIEND,H=Number(s)===(null==y?void 0:y.id),q=m("vkui_common_week_days_short"),W=C.blacklistedByUser?"vkui_edu_unban_user":"vkui_edu_ban_user",J=Object(o.useMemo)((function(){if(!P||!P.length)return"";var e;return e=Object(Qn.d)(P).map((function(e,t){var n=m(e);return t>0&&(n=n.toLowerCase()),n})),Object(Te.d)(e.join(", "),Oe.u)}),[null==P?void 0:P.length]);return i.a.createElement(l.N,r()({},e,{header:"",id:e.id,onClose:e.onClose,className:Object(l.Fb)("ProfileCompact","ProfileCompact--"+n)}),i.a.createElement(ea.a,{isLoaded:!I,small:!0},T&&i.a.createElement($n.a,{error:""+m("vkui_edu_profile_user_not_found")}),!T&&i.a.createElement(o.Fragment,null,i.a.createElement(l.z,null,i.a.createElement("div",{className:"ProfileCompact__header"},S&&i.a.createElement(l.U,{className:"ProfileCompact__close",onClick:e.onClose},i.a.createElement(Wn.a,null)),i.a.createElement(l.h,{size:96,src:C.photo}),i.a.createElement(l.zb,{weight:"regular",level:"2",className:"ProfileCompact__name"},C.firstName," ",C.lastName),J&&i.a.createElement(l.C,{weight:"regular",className:"ProfileCompact__role"},J,!1),!H&&i.a.createElement("div",{className:"ProfileCompact__actions"},i.a.createElement("div",{className:"ProfileCompact__actionsRow"},i.a.createElement(l.i,{size:"m",stretched:!0,onClick:function(){var e={act:"show",peer:s},t="/mail?"+at.b.create(e);D(Object(E.t)({isNewMail:!0,path:"/mail",query:e,url:t})),A(c.h.MESSAGES,e)}},m("vkui_edu_write_message")),i.a.createElement(l.i,{size:"m",onClick:function(){na.a.isWebView()?(w(C.id,C.firstName+" "+C.lastName),d()):aa.d.isMobile||aa.d.isIPad?A(c.g.MOBILE_JOIN_CALL,{peerId:C.id}):A(c.g.JOIN_MESSAGE_CALL,{peerId:C.id,peerTitle:C.firstName+" "+C.lastName})},before:i.a.createElement(Jn.a,null)})),[Yn.a.NOT_A_FRIEND,Yn.a.INCOMING_REQUEST].includes(C.friendStatus)&&i.a.createElement(l.i,{size:"m",stretched:!0,onClick:function(){x("friends.add",{user_id:s}).then((function(){U()}))}},m("vkui_edu_add_contact")),[Yn.a.IS_FRIEND,Yn.a.OUTCOMING_REQUEST].includes(C.friendStatus)&&i.a.createElement(l.i,{size:"m",mode:"secondary",stretched:!0,onClick:function(){x("friends.delete",{user_id:s}).then((function(){U()}))}},C.friendStatus===Yn.a.OUTCOMING_REQUEST&&m("vkui_edu_contact_status_request_sent"),z&&m("vkui_edu_contact_status_is_friend")),C.friendStatus===Yn.a.INCOMING_REQUEST&&i.a.createElement(l.xb,{weight:"regular",className:"ProfileCompact__actionsText"},f(C.sex,"vkui_edu_contact_has_added_user").replace("{user}",C.firstName))))),i.a.createElement("div",{className:"ProfileCompact__content"},P.length>0&&i.a.createElement(l.A,{sizeX:l.mb.COMPACT},i.a.createElement(l.B,null,m("vkui_edu_profile_education_list_header")),P.map((function(e){return i.a.createElement(Gn.a,{key:e.id,id:e.id,sizeX:n,city:e.city,name:e.name,userTitle:e.user_title,disabled:!Boolean(e.is_member)})}))),z&&C.phone&&i.a.createElement(l.A,{sizeX:l.mb.COMPACT},i.a.createElement(l.B,null,m("vkui_edu_profile_contact_info")),i.a.createElement(l.lb,{sizeX:n,before:i.a.createElement(Kn.a,null),href:Object(Zn.b)(C.phone),disabled:!Object(Zn.c)(C.phone)},C.phone)),z&&(null===(t=null==C?void 0:C.schedule)||void 0===t?void 0:t.length)>0&&i.a.createElement(l.A,{sizeX:l.mb.COMPACT},i.a.createElement(l.B,null,m("vkui_edu_availability_time")),C.schedule.map((function(e,t){var a=q[e.day_num],r=Object(Xn.d)([e.start,e.finish]),o=r.from,c=r.to;return i.a.createElement(l.lb,{key:t,sizeX:n,before:i.a.createElement(Vn.a,null),disabled:!0},a+" "+Object(Xn.a)(o,"##:##")+" – "+Object(Xn.a)(c,"##:##"))}))),!H&&R&&i.a.createElement(l.A,{sizeX:l.mb.COMPACT},i.a.createElement(l.m,{onClick:function(){x(C.blacklistedByUser?"account.unban":"account.ban",{user_id:s}).then((function(){C.blacklistedByUser?D(Object(E.x)({items:j.items.filter((function(e){return e.id!==Number(s)})),count:j.items.length-1})):(D(Object(E.z)({items:O.items.filter((function(e){return e.id!==Number(s)})),count:O.items.length-1})),D(Object(E.x)({items:ia(j.items,[C]),count:j.items.length+1}))),D(Object(E.y)({blacklistedByUser:!C.blacklistedByUser}))}))}},f(C.sex,W).replace("{name}",C.firstNameAcc)))))))}),{sizeX:!0,viewWidth:!0})),ca=n(853),ua={insert:"head",singleton:!1},sa=(S()(ca.a,ua),ca.a.locals,n(911)),da=n(854),_a=n(785),ma=n(786),fa=n(787),ba=n(912),ha=function(e){var t=e.group,n=t.name,a=t.status,r=t.description,o=t.city,c=t.country,u=t.site,s=t.phone,d=[null==o?void 0:o.title,null==c?void 0:c.title].filter((function(e){return e})).join(", "),_=Object(p.k)(d),m=Object(p.k)(u)||Object(p.k)(s)||_;return i.a.createElement("div",{className:"SchoolExtendedInfo"},i.a.createElement(l.L,{before:i.a.createElement(sa.a,null),textWrap:"full",textLevel:"primary"},n),Object(p.k)(a)&&i.a.createElement(l.L,{before:i.a.createElement(da.a,null),textWrap:"full",textLevel:"primary"},i.a.createElement(kt.a,null,Object(Te.a)(a,{mentions:!0,links:!0}))),Object(p.k)(r)&&i.a.createElement(l.L,{before:i.a.createElement(_a.a,null),textWrap:"full",textLevel:"primary"},i.a.createElement(kt.a,null,Object(Te.a)(r,{mentions:!0,links:!0}))),m&&i.a.createElement(l.kb,{style:{margin:"12px 0"}}),Object(p.k)(u)&&i.a.createElement(l.L,{before:i.a.createElement(ma.a,null)},i.a.createElement(kt.a,null,Object(Te.a)(u,{links:!0}))),Object(p.k)(s)&&i.a.createElement(l.L,{before:i.a.createElement(fa.a,null)},i.a.createElement(l.J,{href:Object(Zn.b)(s)},s)),_&&i.a.createElement(l.L,{before:i.a.createElement(ba.a,null),textWrap:"full"},d))},pa=n(104),va=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},ga=function(e){var t=e.id,n=e.onClose,a=e.schoolId,r=Object(u.c)().getLangKey,c=Object(pa.a)(a),s=c.schoolInfo,d=c.fetchSchoolInfo,_=c.isSchoolInfoLoaded,m=va(Object(o.useState)(),2),f=m[0],b=m[1];return Object(o.useEffect)((function(){s&&s.id===a||d().catch((function(e){return b(e)}))}),[]),i.a.createElement(l.N,{id:t,onClose:n,header:i.a.createElement(B,{onClose:n,separator:!1},r("vkui_edu_school_info_more_title"))},i.a.createElement(l.kb,null),i.a.createElement(l.A,{sizeX:l.mb.COMPACT},i.a.createElement(ea.a,{isLoaded:_,error:f,small:!0},i.a.createElement(ha,{group:s}))))},Ea=n(855),Ca={insert:"head",singleton:!1},ya=(S()(Ea.a,Ca),Ea.a.locals,n(239)),Oa=n(35),ja=n(136),ka=n(354),Da=function(){return(Da=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Sa=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Fa=Object(o.memo)(Object(l.Mb)((function(e){var t,n=e.updateModalHeight,a=Object(l.Ib)(),r=a.sizeX,s=a.viewWidth,d=Object(u.c)().getLangKey,_=Object(g.b)().messagesModal,m=Sa(Object(o.useState)(!0),2),h=m[0],C=m[1],y=Object(ya.a)(_),O=Object(g.a)(),j=Object(o.useContext)(v.a),k=j.go,D=j.getAsyncAccessToken,S=j.back,F=j.showSnackbar,x=Object(o.useRef)(""),A=Object(o.useRef)(null),w=Sa(Object(o.useState)(0),2),N=w[0],I=w[1],M=Object(b.a)(s);if(Object(o.useEffect)((function(){return A.current=new ja.a({name:"mvk_embedded_other",origin:"https://"+Oa.c.mvk_host,onMessage:function(t,n){var a;if(("sak:ready"===t||"ready"===t)&&(C(!1),A.current.sendMessage("config",{testConfig:"config"}),"return_to_chat"===_.query.act))return n.isNewMail=!1,O(Object(E.t)(Da(Da({},_),{reloadChat:!0}))),e.onClose(),null;if("sak:reauth"===t)return D({force:!0}).then((function(e){return{accessToken:e}}));if("nav"===t){if("/attachments"===n.path&&"add"===(null===(a=n.query)||void 0===a?void 0:a.act)&&Object(ka.b)({event_type:"attachment_add",attachment_id:Object(ka.a)(n.query.object),attachment_type:"poll"===n.query.object?"poll":"doc",chat_id:Object(p.c)(Object(ka.a)(n.query.target))}),n.query&&"create_chat"===n.query.act&&(n.isNewMail=!1,setTimeout(e.onClose,200)),n.query&&"leave_chat"===n.query.act&&(O(Object(E.t)(Da(Da({},n),{reloadChat:!0}))),setTimeout(e.onClose,200),Object(ka.b)({event_type:"chat_leave",chat_id:Object(p.c)(+n.query.chat)})),n.query&&"flush_history"===n.query.act&&(n.isNewMail=!1,O(Object(E.t)(Da(Da({},n),{reloadChat:!0}))),e.onClose()),n.query&&"unpin"===n.query.act&&(O(Object(E.t)(Da({},n))),setTimeout(e.onClose,200)),n.query&&"info"===n.query.act&&"leave_chat"===_.query.act&&(n.isNewMail=!1,setTimeout(e.onClose,200)),n.query&&"info"===n.query.act&&_.query.act&&_.query.chat&&setTimeout(e.onClose,200),n.isNewMail)return O(Object(E.t)(n)),e.onClose(),null;var r=Object(ya.a)(n);if(!r){if(/^\/id\d+$/.test(n.path)){var o=Sa(n.path.match(/\d+$/),1)[0];if(o)return k(c.g.PROFILE_COMPACT,{userId:o}),null}return e.onClose(),null}if(r.isNewMail){if("poll"===n.query.object){if(""===n.query.question.trim())return F(d("vkui_edu_msg_attachments_poll_no_title")),null;if(!Object(ya.b)(n))return F(d("vkui_edu_msg_attachments_poll_no_answers")),null}O(Object(E.t)(n)),e.onClose()}else O(Object(E.u)(n)),k(c.g.MESSAGES_EXTERNAL)}return null}}),function(){A.current.destroy(),A.current=void 0}}),[]),Object(o.useEffect)((function(){n()}),[h,n,_]),Object(o.useEffect)((function(){D().then((function(e){var t=at.b.create(Object.assign({},_.query,{forced_color_scheme_mode:"light",_sak_embed_at:e,_sak_embed_origin:"https://"+location.host}));x.current="https://"+Oa.c.mvk_host+_.path+"?"+t,I(N+1)}))}),[_]),"attach_poll"===_.query.act){t=i.a.createElement(f.a,{className:"MessagesExternal__footer",noShadow:!M},i.a.createElement(l.i,{disabled:h,stretched:!M,size:M?"m":"l",onClick:function(){A.current.sendMessage("click",{selector:"#VotingForm_submit"})}},d("vkui_edu_chat_poll_attach")))}else if("new_chat"===_.query.act){t=i.a.createElement(f.a,{className:"MessagesExternal__footer",noShadow:!M},i.a.createElement(l.i,{disabled:h,stretched:!M,size:M?"m":"l",onClick:function(){A.current.sendMessage("click",{selector:'.create_chat_block .button[type="submit"]'}),Object(ka.b)({event_type:"chat_create",chat_type:"group"})}},d("vkui_edu_chat_create")))}return i.a.createElement(l.N,{id:e.id,header:i.a.createElement(B,{left:"",right:!M&&i.a.createElement(l.U,{onClick:S},d("vkui_edu_cancel")),onClose:e.onClose},d(y.title)),onClose:e.onClose,className:Object(l.Fb)("MessagesExternal","MessagesExternal--"+r)},i.a.createElement("div",{className:"MessagesExternal__container","data-page":_.query.act},h&&i.a.createElement(l.Y,{size:"regular"}),x.current&&i.a.createElement("iframe",{key:x.current,src:x.current,scrolling:y.scrolling,className:"MessagesExternal__iframe",onLoad:function(){return C(!1)},style:{opacity:h?"0":"1"}})),t)}))),xa=n(729),Aa=n(165),wa=function(){return(wa=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Na=function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey,d=Object(g.b)(),_=d.profileAddSchool,m=d.accountInfo,f=d.inviteLink,b=Object(g.a)(),h=Object(o.useContext)(v.a),p=h.apiRequest,C=h.showInfoSnackbar,y=h.showError,O=h.hideModal,j=h.getUserOnboardingStatus,D=Object(xa.a)(null==m?void 0:m.id).getProfileSchoolGradeRequests,S=Object(Aa.a)(null==m?void 0:m.id).getProfileSchools,F=!!(null==f?void 0:f.linkId),x=F&&(null==f?void 0:f.isLoaded),A=_.role===s.a.TEACHER,w=function(){n(),O(),setTimeout((function(){Object(pe.a)((function(){b(Object(E.V)(void 0)),b(Object(E.b)()),j()}))}),500)};Object(o.useEffect)((function(){return function(){var e=c.b.getState().modal;F&&!e&&w()}}),[]);return i.a.createElement(l.N,{id:t,onClose:w,header:i.a.createElement(B,{onClose:w},a(F?"vkui_edu_registration_school_title":"vkui_edu_add_school_title"))},i.a.createElement(ut,r()({},_,{update:E.eb,disabled:x,hint:a(x?A?"vkui_edu_registration_message_invite_teacher":"vkui_edu_registration_message_invite":"vkui_edu_add_school_note"),submitText:a(x?"vkui_edu_register_now":"vkui_edu_add_school_submit"),submit:function(){var e,t=A?_.object:"",n={school_id:_.school.id,user_id:m.id,role_description:t},r=_.classes.map((function(e){return e.id})).join(",");x?(n.link_id=f.linkId,n.grade_ids=r,e="API.education.applyInviteLink({\n        link_id: Args.link_id,\n        grade_ids: Args.grade_ids,\n        role_description: Args.role_description,\n      })"):e="API.education.gradeRequest({\n        group_id: Args.school_id,\n        grade_ids: '"+r+"',\n        user_id: Args.user_id,\n        role: "+_.role+",\n        role_description: Args.role_description,\n      })",p("execute",wa(wa({},n),{code:"return ["+e+"];"}),{showSpinner:!0}).then((function(){Object(k.b)({event_type:"join_request_send"}),w(),D().then((function(e){var t=Object(st.a)(e);b(Object(E.r)(t))})),S(),C(a(F?"vkui_edu_grade_request_sent":"vkui_edu_registration_message")),na.a.isWebView()&&na.a.send("VKWebAppCustomMessage",{action:"updateSchools"})})).catch(y)}})))},Ia=function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey,o=Object(g.b)().profileEditSchool;return i.a.createElement(l.N,{id:t,onClose:n,header:i.a.createElement(B,{onClose:n},a("vkui_edu_profile_edit_school_title"))},i.a.createElement(ut,r()({},o,{update:E.fb,hint:a("vkui_edu_add_school_note"),submitText:a("vkui_edu_add_school_submit"),submit:function(){return console.log("submit")}})))},Ma=n(856),La={insert:"head",singleton:!1},Ta=(S()(Ma.a,La),Ma.a.locals,n(443)),Ba=function(){return(Ba=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Pa=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},Ra=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Ua=function(e){var t=Object(u.c)().getLangKey,n=Object(o.useContext)(v.a),a=n.go,s=n.back,d=Object(g.b)().createChatInfo,_=d.errors,p=Pa(d,["errors"]),C=Object(g.a)(),y=Object(l.Ib)().viewWidth,O=Object(b.a)(y),j=y<l.Cb.TABLET;if(!p)return e.onClose(),null;var k=function(e){C(Object(E.bb)({type:e.target.value,grade:void 0,errors:Ba(Ba({},_),{grade:void 0})}))};return i.a.createElement(l.N,r()({},e,{header:i.a.createElement(B,{left:"",right:!O&&i.a.createElement(l.U,{onClick:s},t("vkui_edu_cancel")),onClose:e.onClose},t("vkui_edu_create_chat_header"))}),i.a.createElement(l.v,{className:"CreateChat"},i.a.createElement(l.w,{mode:"horizontal",className:"CreateChat__header"},i.a.createElement(l.u,{top:t("vkui_edu_chat_title"),bottom:_.title,status:_.title?"error":"default"},i.a.createElement(l.I,{placeholder:t("vkui_edu_chat_title_placeholder"),value:p.title||"",onChange:function(e){C(Object(E.bb)({title:e.target.value,errors:Ba(Ba({},_),{title:void 0})}))}}))),i.a.createElement(l.u,{top:t("vkui_edu_chat_type")},i.a.createElement(Ta.a,null,p.isAdmin&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.cb,{description:t("vkui_edu_chat_type_school_description"),value:m.b.SCHOOL,onChange:k,checked:p.type===m.b.SCHOOL},t("vkui_edu_chat_type_school")),i.a.createElement(l.cb,{description:t("vkui_edu_chat_type_grade_description"),value:m.b.GRADE,onChange:k,checked:p.type===m.b.GRADE},t("vkui_edu_chat_type_grade"))),!p.isAdmin&&p.isTeacher&&i.a.createElement(l.lb,{description:t("vkui_edu_chat_type_grade_description"),multiline:!0,disabled:!0},t("vkui_edu_chat_type_grade")))),p.withSchool&&i.a.createElement(l.u,{top:t("vkui_edu_educational_institution"),bottom:_.school,status:_.school?"error":"default"},i.a.createElement(l.jb,{placeholder:t("vkui_edu_educational_institution_select"),onClick:function(){var e=p.school;C(Object(E.U)({method:"education.getSchools",onSelect:function(t){e&&e.id===t.id||C(Object(E.bb)({school:t,grade:void 0,errors:Ba(Ba({},_),{grade:void 0})}))}})),a(c.g.SELECT_SCHOOL)}},p.school?p.school.name:null)),p.type===m.b.GRADE&&p.withGrade&&i.a.createElement(l.u,{top:t("vkui_edu_class"),bottom:_.grade,status:_.grade?"error":"default"},i.a.createElement(l.jb,{placeholder:t("vkui_edu_chat_class_placeholder"),onClick:function(){if(p.school){var e=p.grade;C(Object(E.R)({isSingle:!0,schoolId:p.school.id,selectedClasses:[],onSubmit:function(t){var n=Ra(t,1)[0];e&&e.id===n.id||C(Object(E.bb)({grade:n,errors:Ba(Ba({},_),{grade:void 0})}))}})),a(c.g.SELECT_CLASSES)}},disabled:!p.school||p.disabledGrade},p.grade?Object(h.d)(p.grade):null))),i.a.createElement(f.a,{fixed:!j,sticky:j,noShadow:j},i.a.createElement(l.i,{stretched:!O,type:"submit",size:O?"m":"l",onClick:function(){var e,n=!0,r={};(null!==(e=p.title)&&void 0!==e?e:"").trim()||(n=!1,r={title:t("vkui_edu_chat_title_placeholder")}),p.withSchool&&!p.school&&(n=!1,r=Ba(Ba({},r),{school:t("vkui_edu_educational_institution_error")})),p.type===m.b.GRADE&&p.withGrade&&!p.grade&&(n=!1,r=Ba(Ba({},r),{grade:t("vkui_edu_class_error")})),n?a(c.g.SELECT_CHAT_MEMEBERS):C(Object(E.bb)({errors:r}))}},t("vkui_edu_continue"))))},za=n(857),Ha={insert:"head",singleton:!1},qa=(S()(za.a,Ha),za.a.locals,function(){return(qa=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),Wa=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};!function(e){e.ALL="all",e.ONLY_STUDENTS="only-students",e.ONLY_TEACHERS="only-teachers"}(nn||(nn={}));var Ja=function(e){var t=Object(u.c)().getLangKey,n=Object(o.useContext)(v.a),a=n.back,s=n.apiRequest,d=n.showError,_=Object(g.b)().createChatInfo,m=_.school,p=_.grade,C=_.selectedUserIds,y=_.selectedUsersStorage,O=_.errors,j=_.onSubmit,k=Object(g.a)(),D=Object(l.Ib)().viewWidth,S=Object(b.a)(D),F=D<l.Cb.TABLET,x=!!p,A=Wa(Object(o.useState)(x?nn.ONLY_STUDENTS:nn.ALL),2),w=A[0],N=A[1],I=function(e){return N(e.currentTarget.dataset.id||nn.ALL)},M=Wa(Object(o.useState)(""),2),L=M[0],T=M[1],P=Wa(Object(o.useState)([]),2),R=P[0],U=P[1],z=Wa(Object(o.useState)([]),2),H=z[0],q=z[1],W=Wa(Object(o.useState)([]),2),J=W[0],K=W[1],V=Wa(Object(o.useState)(!1),2),G=V[0],Y=V[1],Q=Object(an.a)(m.id).getSchoolMembers;Object(o.useEffect)((function(){return Q().then((function(e){return p?s("education.getGradeMembers",{group_id:m.id,grade_id:p.id}).then((function(t){return e.filter((function(e){var n=e.id;return t.items.includes(n)}))})):e})).then((function(e){var t=[],n=[];e.forEach((function(e){if(Array.isArray(e.grades)){var a=!1,r=!1;if(p){var o=e.grades.find((function(e){return e.id===p.id}));o&&(a=a||Object(h.j)(o)||Object(h.h)(o),r=r||Object(h.i)(o))}else e.grades.forEach((function(e){a=a||Object(h.j)(e)||Object(h.h)(e),r=r||Object(h.i)(e)}));a&&t.push(e),r&&n.push(e)}})),U(e),K(n),q(t),Y(!0)})),function(){k(Object(E.bb)({selectedUserIds:[],selectedUsersStorage:{}}))}}),[]);var X=w===nn.ALL?R:w===nn.ONLY_STUDENTS?J:H,Z=Wa(Object(o.useState)(!1),2),$=Z[0],ee=Z[1],te=(C||[]).map((function(e){return y[e]}));Object(o.useEffect)((function(){if(0!==C.length)for(var e=0;e<X.length;e++)if(void 0!==y[X[e].id])return void ee(!0);ee(!1)}),[w,C,y]);var ne=function(e){return function(){var t=qa({},y);delete t[e.id],k(Object(E.bb)({selectedUserIds:C.filter((function(t){return t!==e.id})),selectedUsersStorage:t}))}};return i.a.createElement(l.N,r()({},e,{onClose:c.b.closeModal,header:i.a.createElement(B,{left:i.a.createElement(l.T,{onClick:a}),onClose:c.b.closeModal},t("vkui_edu_create_chat_header"))}),i.a.createElement(l.hb,{className:"SelectChatMembers__search",onChange:function(e){T(e.currentTarget.value)}}),i.a.createElement(l.E,null,i.a.createElement(l.z,{className:"SelectChatMembers__selectedIn"},0===te.length&&i.a.createElement("div",{className:Object(l.Fb)("SelectChatMembers__selectedPlaceholder",{"SelectChatMembers__selectedPlaceholder--error":!!O.selectedUserIds})},t("vkui_edu_select_chat_members_placeholder")),te.length>0&&i.a.createElement(un,{spacing:8},te.map((function(e){return i.a.createElement(cn,{key:e.id,photo:e.photo_200,name:e.first_name+" "+e.last_name,onRemove:ne(e)})}))))),!G&&i.a.createElement(l.Y,null),G&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.kb,{wide:!0}),i.a.createElement(l.ub,{className:"SelectChatMembers__tabs",style:{borderBottom:0}},i.a.createElement(l.E,null,i.a.createElement("div",{className:"SelectChatMembers__tabsItems"},!x&&i.a.createElement(l.vb,{"data-id":nn.ALL,selected:w===nn.ALL,onClick:I},t("vkui_edu_all")),i.a.createElement(l.vb,{"data-id":nn.ONLY_STUDENTS,selected:w===nn.ONLY_STUDENTS,onClick:I},p?t("vkui_edu_grade_members_pupils")+" "+Object(h.b)(p):t("vkui_edu_only_pupils")),i.a.createElement(l.vb,{"data-id":nn.ONLY_TEACHERS,selected:w===nn.ONLY_TEACHERS,onClick:I},t("vkui_edu_only_teachers"))))),i.a.createElement(l.kb,null),X.length>0&&i.a.createElement(l.m,{onClick:function(){if($){if(w===nn.ALL)return void k(Object(E.bb)({selectedUserIds:[],selectedUsersStorage:{}}));var e=X.reduce((function(e,t){var n;return qa(qa({},e),((n={})[t.id]=t,n))}),{}),t=qa({},y),n=C.filter((function(n){return void 0===e[n]||(delete t[n],!1)}));k(Object(E.bb)({selectedUserIds:n,selectedUsersStorage:t}))}else{var a=qa({},y),r=X.map((function(e){var t;return a=qa(qa({},a),((t={})[e.id]=e,t)),e.id}));k(Object(E.bb)({selectedUserIds:C.concat(r),selectedUsersStorage:a,errors:qa(qa({},O),{selectedUserIds:!1})}))}}},t($?"vkui_edu_clear_member_list":"vkui_edu_select_all_members")),0===X.length&&i.a.createElement(l.t,null,t("vkui_common_nothing_found")),i.a.createElement(en.a,{multiple:!0,selectable:!0,className:"SelectChatMembers__list",users:X.filter((function(e){var t,n,a;if(!L&&w===nn.ALL)return!0;var r=null!==(t=L.toString().toLowerCase())&&void 0!==t?t:"",o=null===(n=e.first_name)||void 0===n?void 0:n.toLowerCase().includes(r),i=null===(a=e.last_name)||void 0===a?void 0:a.toLowerCase().includes(r);return o||i})),selectedUsers:te,onSelectChange:function(e){k(Object(E.bb)({selectedUserIds:e.map((function(e){return e.id})),selectedUsersStorage:e.reduce((function(e,t){var n;return qa(qa({},e),((n={})[t.id]=t,n))}),{}),errors:qa(qa({},O),{selectedUserIds:!1})}))}})),i.a.createElement(f.a,{fixed:!F,sticky:F,noShadow:F},i.a.createElement(l.i,{stretched:!S,type:"submit",size:S?"m":"l",onClick:function(){var e=_.title,t=_.school,n=_.grade,a=_.selectedUserIds;if(0!==a.length){var r=a.length===R.length&&!x,o={title:e,group_id:t.id,grade_id:n?n.id:void 0,privacy:r?"auto_all":"manual_all",user_ids:a.join()};s("education.addChat",o,{showSpinner:!0}).then((function(e){Object(ka.b)({event_type:"chat_create",chat_id:+e.id,chat_type:"class",chat_create_time:Math.floor(Date.now()/1e3),chat_users_count:e.members_count,grade_id:n?n.id:void 0}),j&&j(e)})).catch(d)}else k(Object(E.bb)({errors:qa(qa({},O),{selectedUserIds:!0})}))}},t("vkui_edu_create_chat"))))},Ka=n(858),Va={insert:"head",singleton:!1},Ga=(S()(Ka.a,Va),Ka.a.locals,function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}),Ya=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ga(arguments[t]));return e},Qa=function(e){return e.items.includes((function(e){return e.is_educational}))},Xa=function(){return(Xa=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Za=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},$a=function(e){var t=Object(g.b)(),n=t.chatInfo,a=t.accountInfo,r=Object(g.a)(),i=Za(Object(o.useState)(!1),2),l=i[0],c=i[1],u=e||{},s=u.selfDeleted,d=u.onUpdate,_=Object(o.useContext)(v.a),m=_.apiRequest,f=_.showError,b=(null==e?void 0:e.chatId)||(null==n?void 0:n.chatId),h=(null==e?void 0:e.peerId)||(null==n?void 0:n.peerId),C=Za(Object(o.useState)(0),2),y=C[0],O=C[1];return Object(o.useEffect)((function(){b&&Promise.all([m("messages.getChat",{chat_id:b,fields:"first_name,photo_200"}),s?null:m("messages.getConversationMembers",{peer_id:h}),m("education.isEducationalChats",{chat_ids:b}),m("education.getSchoolGradeByChatId",{chat_id:b})]).then((function(e){var t=Za(e,4),n=t[0],a=t[1],r=t[2],o=t[3];return n.admin_id<0?m("education.getSchoolById",{school_id:Math.abs(n.admin_id),v:"5.124"}).then((function(e){return[n,e,a,r,o]})).catch((function(){return[n,null,a,r,o]})):[n,null,a,r,o]})).then((function(e){var t=Za(e,5),n=t[0],o=t[1],i=t[2],l=t[3],c=t[4],u=Object(p.g)(o)||Object(p.j)(o)||n.admin_id===a.id,s=function(e,t){var n=[],a=[],r=[];return Array.isArray(e)||(e=Object.values(e)),e.forEach((function(e){var o;e.first_name&&"deleted"!==e.deactivated?n.push(e):"deleted"===e.deactivated?a.push(e):e.name&&r.push(e);var i=null===(o=null==t?void 0:t.items)||void 0===o?void 0:o.find((function(t){return t.member_id===e.id}));i&&(e.is_admin=i.is_admin,e.can_kick=i.can_kick)})),Ya(n,r,a)}(n.users,i),_=Xa(Xa({},n),{users:s,members_count:s.length});r(Object(E.ab)({info:_,school:o,canManage:u,chatSchoolGrade:c,isEduChat:Qa(l)})),d&&d()})).catch(f).finally((function(){return c(!0)}))}),[b,y]),{isLoaded:l,chatInfo:n,reloadChatInfo:function(){O((function(e){return++e}))}}},er=n(7),tr=n(17),nr=n(859),ar={insert:"head",singleton:!1},rr=(S()(nr.a,ar),nr.a.locals,function(){return i.a.createElement(l.l,{className:"CellItemSkeleton",selectable:!0,before:i.a.createElement(tr.a,{size:40}),description:i.a.createElement(er.a,null)})}),or=n(860),ir={insert:"head",singleton:!1},lr=(S()(or.a,ir),or.a.locals,function(e){var t=e.itemsCount,n=e.itemDistance,a=e.className,r=Array.from(Array(t).keys());return Object(l.Ib)().viewWidth<l.Cb.TABLET?i.a.createElement(l.Y,null):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:Object(l.Fb)(a,"ListUsersSkeleton__content"),style:{marginBottom:n}},i.a.createElement(l.C,{weight:"medium",className:"ListUsersSkeleton__header"},i.a.createElement("div",{className:"ListUsersSkeleton__letter"})),r.map((function(e,t){return i.a.createElement("div",{key:"ListUsersSkeleton__contentItem-"+t,className:"ListUsersSkeleton__contentItem ListUsersSkeleton__contentItem-"+t},i.a.createElement(rr,null))}))))});lr.displayName="ListUsersSkeleton";var cr=Object(o.memo)(Object(l.Kb)(lr,{viewWidth:!0})),ur=n(861),sr=function(){return(sr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},dr=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},_r=function(e){var t=Object(u.c)().getLangKey,n=Object(o.useContext)(v.a),a=n.apiRequest,s=n.showError,d=n.go,_=n.back,m=Object(l.Ib)().viewWidth,h=Object(b.a)(m),p=m<l.Cb.TABLET,C=dr(Object(o.useState)(0),2),y=C[0],O=C[1],j=Object(g.a)(),k=dr(Object(o.useState)([]),2),D=k[0],S=k[1],F=Object(o.useRef)(null),x=$a(),A=x.chatInfo,w=x.isLoaded,N=x.reloadChatInfo,I=null==A?void 0:A.chatId,M=(null==A?void 0:A.selectedUsersStorage)||[],L={private:"education.getUserContacts",school:"education.getSchoolMembers",grade:"education.getSchoolMembers"},T=Object(z.a)({initialSearch:"",fetch:function(e){var t=e.itemsCount,n=e.search;if(!w)return Promise.resolve([]);var r=function(e){return(null==e?void 0:e.grade)?"grade":(null==e?void 0:e.school)?"school":"private"}(null==A?void 0:A.chatSchoolGrade),o=A.chatSchoolGrade,i=o.grade,l=o.school,c=L[r],u={offset:t,q:n,fields:"first_name,last_name,photo_200"};return"school"!==r&&"grade"!==r||(u={offset:t,q:n,grade_id:null==i?void 0:i.id,group_id:null==l?void 0:l.id,fields:"first_name,last_name,photo_200"}),a(c,u).then((function(e){return e.items})).catch((function(e){s(e)}))}}),P=T.isLoaded,R=T.isFetching,U=T.canLoadMore,q=T.getItems,W=T.items,J=T.search,K=T.handleSearch,V=T.handleLoadMore;Object(o.useEffect)((function(){var e;S(W.filter(function(e){return function(t){return!e.find((function(e){return e.id===t.id}))}}(null===(e=null==A?void 0:A.info)||void 0===e?void 0:e.users)))}),[W,J,I]),Object(o.useEffect)((function(){q()}),[w]),Object(o.useEffect)((function(){N()}),[I]),Object(o.useEffect)((function(){O((function(e){return++e}))}),[J]),Object(o.useEffect)((function(){return function(){j(Object(E.ab)(sr(sr({},A||{}),{selectedUsersStorage:[]})))}}),[]);var G=function(e){return function(){j(Object(E.ab)(sr(sr({},A||{}),{selectedUsersStorage:M.filter((function(t){return t.id!==e.id}))})))}},Y=D.filter((function(e){var t,n,a;if(!J)return!0;var r=!M.find((function(t){return t.id===e.id})),o=null!==(t=J.toString().toLowerCase())&&void 0!==t?t:"",i=null===(n=e.first_name)||void 0===n?void 0:n.toLowerCase().includes(o),l=null===(a=e.last_name)||void 0===a?void 0:a.toLowerCase().includes(o);return(i||l)&&r}));return i.a.createElement(l.N,r()({},e,{getModalContentRef:F,onClose:_,className:"ChatAddMembers",dynamicContentHeight:e.dynamicContentHeight,header:i.a.createElement(B,{onClose:c.b.closeModal},t("vkui_edu_chat_add_members"))}),i.a.createElement(l.hb,{className:"ChatAddMembers__search",onChange:K}),i.a.createElement(l.lb,{className:"ChatAddMembers__link",onClick:function(){d(c.g.CHAT_INFO_LINK)},before:i.a.createElement(ur.a,null),description:t("vkui_edu_chat_add_user_link")}),i.a.createElement(l.kb,{className:"ChatAddMembers__separator"}),i.a.createElement(l.E,{showArrows:!0},i.a.createElement(l.z,{className:"ChatAddMembers__selectedIn"},0===M.length&&i.a.createElement("div",{className:Object(l.Fb)("ChatAddMembers__selectedPlaceholder")},t("vkui_edu_select_chat_members_placeholder")),M.length>0&&i.a.createElement(un,{spacing:8},M.map((function(e){return i.a.createElement(cn,{key:e.id,photo:e.photo_200,name:e.first_name+" "+e.last_name,onRemove:G(e)})}))))),!P&&i.a.createElement(l.Y,null),P&&i.a.createElement(i.a.Fragment,null,0===Y.length&&!R&&i.a.createElement(l.t,{className:"ChatAddMembers__footer"},t("vkui_common_nothing_found")),i.a.createElement(H.a,{customSpinner:i.a.createElement(cr,{className:"ChatAddMembers__skeleton",itemsCount:5}),outerContainer:F.current,canLoad:U,isFetching:R,onLoadMore:V},i.a.createElement(en.a,{key:y,multiple:!0,selectable:!0,checkById:!0,showHeaderSeparator:!1,className:"ChatAddMembers__list",users:Y,selectedUsers:M,onSelectChange:function(e){j(Object(E.ab)(sr(sr({},A||{}),{selectedUsersStorage:e})))}}))),i.a.createElement(f.a,{fixed:!p,sticky:p,noShadow:p},i.a.createElement(l.i,{stretched:!h,type:"submit",size:h?"m":"l",onClick:function(){var e=M.map((function(e){return"API.messages.addChatUser({\n              chat_id: "+A.chatId+",\n              user_id: "+e.id+",\n            })"})).join();a("execute",{code:"return ["+e+"];"},{showSpinner:!0}).then((function(e){e.some((function(e){return!e}))?s(t("vkui_edu_edit_member_error")):_()})).catch((function(e){s(e)}))}},t("vkui_edu_chat_member_add_btn"))))},mr=n(862),fr={insert:"head",singleton:!1},br=(S()(mr.a,fr),mr.a.locals,n(131)),hr=n(904),pr=(n(913),n(914),n(716)),vr=n(701),gr=(n(697),n(826)),Er=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Cr=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Er(arguments[t]));return e},yr=function(){return(yr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Or=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},jr=function(e){var t=Object(u.c)().getLangKey,n=Object(l.Ib)(),a=n.sizeX,s=n.viewWidth,d=Object(o.useContext)(l.Q).updateModalHeight,_=Object(o.useContext)(v.a),m=_.apiRequest,f=_.go,h=_.back,C=_.showError,y=_.showActionSheet,O=Or(Object(o.useState)(!1),2),j=O[0],k=O[1],D=Or(Object(o.useState)(!1),2),S=D[0],F=D[1],x=Or(Object(o.useState)(!1),2),A=x[0],w=x[1],N=Object(g.b)(),I=N.chatInfo,M=N.accountInfo,L=Object(g.a)(),T=Object(b.a)(s);Object(o.useEffect)((function(){var e,t,n=(null==I?void 0:I.peerId)&&(null===(e=null==I?void 0:I.info)||void 0===e?void 0:e.id)!==Object(p.c)(null==I?void 0:I.peerId)||j,a=Object(p.c)(null==I?void 0:I.peerId);if(n){Object(E.h)(null),F(!0),k(!1);var r=A?null:(t={peer_id:null==I?void 0:I.peerId},new Promise((function(e){m("messages.getConversationMembers",t).then((function(t){e(t)})).catch((function(){e(null)}))})));Promise.all([m("messages.getChat",{chat_id:a,fields:"first_name,photo_200"}),r,m("education.isEducationalChats",{chat_ids:a})]).then((function(e){var t=Or(e,2),n=t[0],a=t[1];return n.admin_id<0?m("education.getSchoolById",{school_id:Math.abs(n.admin_id),v:"5.124"}).then((function(e){return[n,e,a]})).catch((function(){return[n,null,a]})):[n,null,a]})).then((function(e){var t=Or(e,3),n=t[0],a=t[1],r=t[2],o=Object(p.g)(a)||Object(p.j)(a)||n.admin_id===M.id,i=function(e,t){var n=[],a=[],r=[];return Array.isArray(e)||(e=Object.values(e)),e.forEach((function(e){var o;e.first_name&&"deleted"!==e.deactivated?n.push(e):"deleted"===e.deactivated?a.push(e):e.name&&r.push(e);var i=null===(o=null==t?void 0:t.items)||void 0===o?void 0:o.find((function(t){return t.member_id===e.id}));i&&(e.is_admin=i.is_admin,e.can_kick=i.can_kick)})),Cr(n,r,a)}(n.users,r),l=yr(yr({},n),{users:i,members_count:i.length});L(Object(E.ab)({info:l,school:a,canManage:o})),d()})).catch(C).finally((function(){return F(!1)}))}}),[j]);var P=function(){I.info&&(L(Object(E.g)({chatId:I.chatId,peerId:I.peerId,groupId:Math.abs(I.info.admin_id),title:I.info.title,onSubmit:function(e){L(Object(E.ab)({info:yr(yr({},I.info),e)}))}})),f(c.g.EDIT_CHAT_INFO))},R=function(e){f(c.g.PROFILE_COMPACT,{userId:e.currentTarget.dataset.id})},z=function(e){return!!e.name||"deleted"===e.deactivated},H=function(e){e.stopPropagation();var n=Number(e.currentTarget.dataset.id),a=Object(p.c)(I.peerId);y(e.currentTarget,[{text:t("vkui_edu_chat_member_remove"),before:i.a.createElement(hr.a,{fill:"var(--destructive)"}),mode:"destructive",onClick:function(){return m("messages.removeChatUser",{chat_id:a,member_id:n,groupId:Math.abs(I.info.admin_id)}).then((function(){k(!0)})).catch(C)}}])},q=function(e){var t=I.info.admin_id<0;return I.info.admin_id===e.id||!!t&&e.is_admin},W=function(e){var t=e.can_kick,n="profile"===e.type;return I.canManage&&n&&t};return i.a.createElement(l.N,r()({},e,{header:i.a.createElement(B,{left:!T&&i.a.createElement(l.T,{onClick:h}),onClose:e.onClose},i.a.createElement("div",{className:Object(l.Fb)({ChatInfo__content:a!==l.mb.COMPACT})},t("vkui_edu_chat")))}),i.a.createElement(U,{className:"ChatInfo__content ChatInfo__content--withBottom"},S?i.a.createElement(l.Y,null):i.a.createElement(i.a.Fragment,null,I.info&&i.a.createElement(i.a.Fragment,null,I.canManage&&i.a.createElement(l.v,{Component:"div",onClick:P},i.a.createElement(l.u,{top:t("vkui_edu_chat_title")},i.a.createElement(l.I,{className:"ChatInfo__input",value:I.info.title,onChange:function(){},tabIndex:-1}))),i.a.createElement(l.kb,{className:"ChatInfo__separator"}),!1,i.a.createElement(l.m,{before:i.a.createElement(pr.a,null),onClick:function(){f(c.g.CHAT_ATTACHMENTS)}},t("vkui_edu_messages_show_medias_title")),I.canManage&&i.a.createElement(l.m,{before:i.a.createElement(vr.a,null),onClick:function(){f(c.g.CHAT_INFO_LINK)}},t("vkui_edu_chat_invite_link")),I.canManage&&!1,i.a.createElement(l.kb,{className:"ChatInfo__separator"}),i.a.createElement(l.m,{mode:"danger",before:i.a.createElement(gr.a,null),onClick:function(){var e=Object(p.c)(I.peerId);w(!0),m("messages.removeChatUser",{chat_id:e,member_id:M.id}).then((function(){var t,n;Object(ka.b)({event_type:"chat_leave",chat_id:e,chat_users_count:null!==(n=null===(t=I.info)||void 0===t?void 0:t.members_count)&&void 0!==n?n:0}),h()})).catch(C)}},t("vkui_edu_leave_chat")),i.a.createElement(l.kb,{className:"ChatInfo__separator"}),i.a.createElement(l.B,{indicator:I.info.members_count},t("vkui_edu_chat_members")),I.info.users.map((function(e){return i.a.createElement(l.lb,{key:e.id,after:W(e)&&i.a.createElement(br.a,{"data-id":e.id,onClick:H}),before:i.a.createElement(l.h,{size:48,src:e.photo_200}),description:q(e)?t("vkui_edu_edit_member_level_admin"):void 0,"data-id":e.id,onClick:!z(e)&&R,style:{opacity:z(e)?"0.3":"1"},disabled:z(e)},e.name||e.first_name+" "+e.last_name)}))))))},kr=n(706),Dr=n(719),Sr=n(819),Fr=n(707),xr=n(132),Ar=n(863),wr={insert:"head",singleton:!1},Nr=(S()(Ar.a,wr),Ar.a.locals,function(){return(Nr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),Ir=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Mr=function(e){var t=Object(g.a)(),n=Object(b.b)(e.viewWidth),a=Object(u.c)().getLangKey,s=Object(o.useContext)(v.a),d=s.go,_=s.apiRequest,m=s.showInfoSnackbar,f=s.showPopout,h=s.hidePopout,C=Object(g.b)().chatInfo,y=Ir(Object(o.useState)(!1),2),O=y[0],j=y[1],k=Ir(Object(o.useState)(),2),D=k[0],S=k[1],F=function(e){var n,a={chat_id:Object(p.c)(C.peerId),school_id:null===(n=C.school)||void 0===n?void 0:n.id,reset:e};_("education.getChatInviteLink",a).then((function(e){var n=e.link_id,a=""+c.b.buildPath(c.h.MESSAGES,{join:n});t(Object(E.ab)(Nr(Nr({},C),{link:a})))})).catch((function(e){S(e)})).finally((function(){j(!0)}))};Object(o.useEffect)((function(){var e=at.b.parse(window.location.href);C.chatId.toString()!==e.chat&&C.peerId.toString()!==e.peer||!C.link?F(0):j(!0)}),[]);var x=function(){Object(Fr.a)(Object(xr.a)(C.link)),m(a("vkui_edu_link_copied"))},A=Object(o.useMemo)((function(){return i.a.createElement(B,{left:i.a.createElement(l.T,{onClick:e.onClose}),onClose:e.onClose},a("vkui_edu_chat_invite_link"))}),[]);return i.a.createElement(l.N,r()({},e,{header:A}),i.a.createElement(ea.a,{isLoaded:O,error:D,small:!0},i.a.createElement(l.kb,{className:"ChatInfoLnk__separator--header"}),i.a.createElement(l.A,null,i.a.createElement(l.r,{className:"ChatInfoLink__description"},i.a.createElement(l.C,{weight:"regular"},a("vkui_edu_chat_info_invite_to_chat_description"))),i.a.createElement(l.lb,{onClick:x},Object(xr.a)(C.link,!1)),i.a.createElement(l.kb,{className:"ChatInfoLnk__separator"}),i.a.createElement(l.lb,{before:i.a.createElement(kr.a,null),onClick:x},a("vkui_edu_chat_info_link_copy")),i.a.createElement(l.lb,{before:i.a.createElement(Dr.a,null),onClick:function(){var e;t(Object(E.D)({url:Object(xr.a)(C.link),title:a("vkui_edu_chat_info_invite_to_chat")+" «"+C.info.title+"»"})),d(c.g.QR_CODE_PREVIEW,{schoolId:null===(e=C.school)||void 0===e?void 0:e.id})}},a("vkui_edu_chat_info_open_qr_code")),i.a.createElement(l.kb,{className:"ChatInfoLnk__separator"}),i.a.createElement(l.m,{className:"ChatInfoLink__button",mode:"danger",before:i.a.createElement(Sr.a,null),onClick:function(){var e=[{title:a("vkui_edu_chat_info_link_alert_cancel"),autoclose:!0,mode:"cancel"},{title:a("vkui_edu_chat_info_link_delete"),mode:"destructive",autoclose:!0,action:function(){j(!1),F(1)}}];n&&(e=e.reverse()),f(i.a.createElement(l.e,{actions:e,actionsLayout:n?"vertical":"horizontal",onClose:h,header:a("vkui_edu_chat_info_link_alert_header")}))}},a("vkui_edu_chat_info_link_delete")))))},Lr=Object(l.Kb)(Object(o.memo)(Mr),{viewWidth:!0}),Tr=function(){return(Tr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Br=function(e){var t=Object(u.c)().getLangKey,n=Object(o.useContext)(v.a),a=n.apiRequest,c=n.back,s=n.showError,d=Object(g.b)().chatEditInfo,_=Object(g.a)(),m=Object(l.Ib)().viewWidth,h=Object(b.a)(m),p=m<l.Cb.TABLET;d||e.onClose();var C=d.errors,y=d.onSubmit,O=function(){if(d.title.trim()){var e={school_id:d.groupId,peer_id:d.peerId,title:d.title};a("education.editChat",e,{showSpinner:!0}).then((function(){y({title:d.title.trim()}),c()})).catch(s)}else _(Object(E.Z)({errors:{title:t("vkui_edu_chat_title_placeholder")}}))};return i.a.createElement(l.N,r()({},e,{header:i.a.createElement(B,{left:!h&&i.a.createElement(l.U,{onClick:c},t("vkui_edu_cancel")),right:!h&&i.a.createElement(l.U,{onClick:function(){O()}},t("vkui_edu_ready")),onClose:e.onClose},t("vkui_edu_edit_header"))}),i.a.createElement(l.v,null,i.a.createElement(l.u,{top:t("vkui_edu_chat_title"),bottom:C.title,status:C.title?"error":"default"},i.a.createElement(l.I,{placeholder:t("vkui_edu_chat_title_placeholder"),value:d.title||"",onChange:function(e){_(Object(E.Z)({title:e.target.value,errors:Tr(Tr({},C),{title:null})}))}}))),i.a.createElement(f.a,{sticky:p,noShadow:p},i.a.createElement(l.i,{stretched:!h,type:"submit",size:h?"m":"l",onClick:O},t("vkui_common_save"))))},Pr=n(864),Rr={insert:"head",singleton:!1},Ur=(S()(Pr.a,Rr),Pr.a.locals,n(685)),zr=n(424),Hr=n(432),qr=n(423),Wr=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Jr="photo",Kr="doc",Vr="video",Gr=function(e){var t=e.params,n=Object(u.c)(),a=n.getLangKey,c=n.formatFileSize,s=n.getLangDate,d=Object(o.useContext)(l.Q).updateModalHeight,_=Object(o.useContext)(v.a),m=_.apiRequest,f=_.showPopout,h=_.hidePopout,E=_.getAsyncAccessToken,C=_.back,y=Object(g.b)().chatInfo,O=Object(l.Ib)().viewWidth,j=Object(b.a)(O),k=j?Oa.c.vkcom_host:Oa.c.mvk_host,D=Wr(Object(o.useState)(Jr),2),S=D[0],F=D[1],x=function(e){e.currentTarget.dataset.id&&F(e.currentTarget.dataset.id)},A=Object(o.useRef)(!1),w=Wr(Object(o.useState)(!1),2),N=w[0],I=w[1],M=Object(o.useRef)(),L=Wr(Object(o.useState)([]),2),T=L[0],P=L[1],R=Object(o.useRef)(null),z=Object(o.useRef)(!1),H=function(e){void 0===e&&(e={});var n=e.reset;return!y||!n&&A.current?new Promise((function(){})):(I(!1),m("messages.getHistory",{peer_id:y.peerId,count:1}).then((function(e){var a,r=null===(a=e.items[0])||void 0===a?void 0:a.id,o={peer_id:y.peerId,group_id:t.community?Object(p.c)(t.community):void 0,media_type:S,start_from:n?r||void 0:M.current};return m("messages.getHistoryAttachments",o)})).then((function(e){A.current=!e.hasOwnProperty("next_from"),M.current=e.next_from,P((function(t){return n?e.items:t.concat(e.items)})),I(!0),d()})))},q=Object(o.useCallback)((function(){if(!z.current){var e=R.current;!A.current&&e.scrollTop+e.clientHeight+100>e.offsetHeight&&(z.current=!0,H().then((function(){z.current=!1})))}}),[]);Object(o.useEffect)((function(){H({reset:!0})}),[S]);var W=function(e){var t=e.currentTarget.dataset,n=t.link,a=t.ext;if(n){if(S===Kr)return qr.a.includes(a)?void E().then((function(e){f(i.a.createElement(He.a,{onClose:h},i.a.createElement(qe.a,{src:n+"?_sak_embed_at="+e})))})):void(location.href=n);S!==Vr?f(i.a.createElement(He.a,{onClose:h},i.a.createElement("img",{src:n,alt:"",style:{maxWidth:"100%",maxHeight:"100%"}}))):m("video.get",{videos:n}).then((function(e){var t=e.items;if(0!==t.length){var n=Wr(t,1)[0];E().then((function(e){var t=Object(p.f)(n.player,e);f(i.a.createElement(He.a,{onClose:h},i.a.createElement(qe.a,{src:t,allowFullScreen:!na.a.isWebView()})))}))}}))}};return i.a.createElement(l.N,r()({},e,{header:i.a.createElement(B,{left:!j&&i.a.createElement(l.T,{onClick:C}),onClose:e.onClose},a("vkui_edu_messages_show_medias_title"))}),i.a.createElement(l.ub,null,i.a.createElement(l.vb,{"data-id":Jr,selected:S===Jr,onClick:x},a("vkui_edu_messages_choose_photo_title")),i.a.createElement(l.vb,{"data-id":Vr,selected:S===Vr,onClick:x},a("vkui_edu_video")),i.a.createElement(l.vb,{"data-id":Kr,selected:S===Kr,onClick:x},a("vkui_edu_docs"))),i.a.createElement(U,{className:"ChatAttachments__modalContent",onScroll:q},i.a.createElement("div",{ref:R},N&&0===T.length&&i.a.createElement(l.t,null,a("vkui_common_nothing_found")),T.length>0&&i.a.createElement(i.a.Fragment,null,S===Jr&&i.a.createElement("div",{className:"ChatAttachments__photos"},T.map((function(e){if(!e.attachment||!e.attachment.photo)return null;var t=e.attachment.photo,n=Object(Ur.b)(t.sizes,99,99),a=Object(Ur.b)(t.sizes,2e3);return i.a.createElement("div",{key:e.attachment.photo.id,className:"ChatAttachments__photo","data-link":a.url,onClick:W},i.a.createElement("img",{src:n.url,className:"ChatAttachments__image"}))}))),S===Vr&&i.a.createElement("div",{className:"ChatAttachments__videos"},T.map((function(e){if(!e.attachment||!e.attachment.video)return null;var t=e.attachment.video,n=Object(Ur.b)(t.image,99,99),a=t.owner_id+"_"+t.id+(t.access_key?"_"+t.access_key:"");return i.a.createElement("div",{key:e.attachment.video.id,className:"ChatAttachments__video","data-link":a,onClick:W},i.a.createElement("img",{src:n.url,className:"ChatAttachments__image"}))}))),S===Kr&&i.a.createElement("div",{className:"ChatAttachments__docs"},T.map((function(e,t){var n;if(!e.attachment||!e.attachment.doc)return null;var r=e.attachment.doc,o="https://"+k+"/doc"+r.owner_id+"_"+r.id,u=c(r.size),d=s(r.date),_=null===(n=r.ext)||void 0===n?void 0:n.toUpperCase();return i.a.createElement(l.lb,{key:t,before:i.a.createElement(Hr.a,{docData:r,state:"idle"}),description:i.a.createElement(i.a.Fragment,null,_," · ",u," · ",d,i.a.createElement("br",null),a(Object(zr.a)(r.type))),"data-link":o,"data-ext":r.ext,rel:"button",onClick:W},r.title)})))),!N&&i.a.createElement(l.Y,null))))},Yr=n(865),Qr={insert:"head",singleton:!1},Xr=(S()(Yr.a,Qr),Yr.a.locals,n(108)),Zr=function(){return(Zr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},$r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};var eo=n(866),to={insert:"head",singleton:!1},no=(S()(eo.a,to),eo.a.locals,function(){return(no=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),ao=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};function ro(e,t){var n=ao(Object(o.useState)((function(){return Object(Xn.d)(e)})),2),a=n[0],r=n[1],i=function(e,t){var n,o=function(e){return e.replace(/[^\d]/g,"")}(t).substring(0,4);if(o.length>0){var i=Number(o[0]);i>2&&(o="0"+o),o[1]&&2===i&&Number(o[1])>3&&(o=o.substring(0,1)+"3"+o.slice(2)),o[2]&&Number(o[2])>5&&(o=o.substring(0,2)),24===Number(o.substring(0,2))&&(o[2]&&Number(o[2])>0||o[3]&&Number(o[3])>0)&&(o=o.substring(0,2))}var l=no(no({},a),((n={})[e]=o,n));r(l)};return[{value:a,onChange:function(e){return i(e.target.name,e.target.value)},onBlur:function(e){var n=e.target,r=n.name,o=n.value;if(4!==o.length){for(var l=o;l.length<4;)l+="0";i(r,l)}t&&t(Object(Xn.e)(a))}},void 0!==e?e:Object(Xn.e)(a),i]}var oo,io,lo=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},co=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},uo=function(e){var t=e.className,n=e.dayNumber,a=e.time,c=e.dayWeek,s=e.onTimeChange,d=lo(e,["className","dayNumber","time","dayWeek","onTimeChange"]),_=Object(u.c)().getLangKey,m=Object(o.useMemo)((function(){if(s)return function(e){return s(n,e)}}),[s,n]),f=co(ro(a,m),2),b=f[0],h=f[1],p=b.value,v=p.from,g=p.to,E=lo(b,["value"]),C=co(Object(o.useState)(!!a),2),y=C[0],O=C[1];return i.a.createElement("div",r()({className:Object(l.Fb)(t,"ScheduleControl")},d),i.a.createElement(l.n,{className:"ScheduleControl__сheckbox",checked:y,onChange:function(){return O((function(e){return m&&m(e?void 0:h),!e}))}},c),y&&i.a.createElement("div",{className:"ScheduleControl__row"},i.a.createElement("div",{className:"ScheduleControl__cell"},i.a.createElement(l.I,r()({name:"from",placeholder:_("vkui_edu_availability_time_from_placeholder"),value:Object(Xn.a)(v,"##:##"),maxLength:5},E))),i.a.createElement("div",{className:"ScheduleControl__cell"},i.a.createElement(l.I,r()({name:"to",placeholder:_("vkui_edu_availability_time_to_placeholder"),value:Object(Xn.a)(g,"##:##"),maxLength:5},E)))))},so=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},_o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},mo=function(e){var t=e.className,n=e.schedule,a=e.onScheduleChange,c=so(e,["className","schedule","onScheduleChange"]),s=Object(u.c)().getLangKey,d=_o(function(e,t){var n=$r(Object(o.useState)({}),2),a=n[0],r=n[1],i=void 0!==e?Object(Xn.c)(e):a;return[i,function(n,a){var o,l=Zr({},i);void 0===a?delete l[n]:l=Zr(Zr({},l),((o={})[n]=a,o)),void 0===e&&r(l),t&&t(Object(Xn.b)(l))}]}(n,a),2),_=d[0],m=d[1],f=Object(o.useMemo)((function(){return s("vkui_common_week_days").map((function(e){return e[0].toUpperCase()+e.slice(1)}))}),[s]);return i.a.createElement("div",r()({className:Object(l.Fb)(t,"Schedule")},c),f.map((function(e,t){return i.a.createElement(uo,{key:e,dayWeek:e,dayNumber:t,time:_[t],onTimeChange:m})})))},fo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},bo=function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey,r=Object(l.Ib)().viewWidth,c=Object(b.a)(r),s=Object(o.useContext)(l.Q).updateModalHeight,d=Object(o.useContext)(v.a),_=d.apiRequest,m=d.showError,h=d.showErrorMessage,p=d.back,g=Object(Xr.a)(),E=g.accountInfo,C=g.updateAccountInfo,y=fo(Object(o.useState)(E.schedule),2),O=y[0],j=y[1],k=function(){var e=O.filter((function(e){return 0!==e.finish})),t=e.some((function(e){return e.start===e.finish})),r=e.some((function(e){return e.start>e.finish})),o=e.some((function(e){return e.finish>1439}));if(t)h(a("vkui_edu_user_schedule_same_time"));else if(r)h(a("vkui_edu_user_schedule_start_later"));else if(o)h(a("vkui_edu_user_schedule_end_max"));else{var i=e.map((function(e){return e.day_num+"_"+e.start+"_"+e.finish})).join(",");_("education.saveUserSchedule",{period:i},{showSpinner:!0}).then((function(e){C({schedule:e}),n()})).catch(m)}};Object(o.useEffect)((function(){s()}),[O,s]);return i.a.createElement(l.N,{id:t,className:"UserSchedule",header:i.a.createElement(B,{left:!c&&i.a.createElement(l.U,{onClick:p},a("vkui_edu_cancel")),right:!c&&i.a.createElement(l.U,{onClick:function(){k()}},a("vkui_edu_ready")),onClose:n},a(c?"vkui_edu_availability_time":"vkui_edu_availability_time_mobile")),onClose:n},i.a.createElement(l.v,null,i.a.createElement(l.w,null,i.a.createElement(mo,{schedule:O,onScheduleChange:j}))),c&&i.a.createElement(f.a,{fixed:!0},i.a.createElement(l.i,{type:"submit",size:"m",onClick:k},a("vkui_edu_settings_save"))))},ho=n(867),po={insert:"head",singleton:!1},vo=(S()(ho.a,po),ho.a.locals,function(){return(vo=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),go=function(e){var t=e.id,n=e.onClose,a=Object(u.c)().getLangKey,r=Object(o.useContext)(v.a).go,s=Object(g.a)(),d=Object(g.b)().videoUploadInfo,_=Object(o.useRef)(null);Object(o.useEffect)((function(){_.current=document.createElement("input"),_.current.type="file",_.current.accept="video/*";var e=function(e){var t=e.target.files[0],n=t.name||"";s(Object(E.X)(vo(vo({},d),{video:t,title:n,description:""}))),r(c.g.VIDEO_EDIT,{type:"upload"},{replace:!0})};return _.current.addEventListener("change",e),function(){_.current.removeEventListener("change",e)}}),[]);var m=Object(o.useCallback)((function(){_.current&&_.current.click()}),[]);return i.a.createElement(l.N,{header:"",id:t,onClose:n},i.a.createElement(l.A,{separator:"hide"},i.a.createElement("div",{className:"VideoUpload__center"},i.a.createElement(l.zb,{level:"1",weight:"bold"},a("vkui_edu_videos_upload_title")),i.a.createElement(l.xb,{className:"VideoUpload__text",weight:"regular"},a("vkui_edu_videos_upload_size_limit")),i.a.createElement(l.xb,{className:"VideoUpload__text",weight:"regular"},a("vkui_edu_videos_upload_extensions")),i.a.createElement(l.xb,{className:"VideoUpload__text",weight:"regular"},a("vkui_edu_videos_upload_copyright")),i.a.createElement("br",null),i.a.createElement(l.i,{size:"m",onClick:m},a("vkui_edu_videos_upload_button")))))},Eo=function(){return(Eo=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Co=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i};!function(e){e.Upload="upload",e.Edit="edit"}(io||(io={}));var yo,Oo,jo=((oo={})[io.Upload]="vkui_edu_video_add_title",oo[io.Edit]="vkui_edu_video_edit_title",oo),ko=function(e){var t=e.id,n=e.onClose,a=e.onBack,r=e.params,c=e.dynamicContentHeight,s=Object(g.a)(),d=Object(l.Ib)().viewWidth,_=Object(b.a)(d),m=Object(u.c)().getLangKey,h=Object(o.useContext)(v.a),p=h.apiRequest,C=h.showError,y=Object(g.b)(),O=y.videoUploadInfo,j=y.videoEditInfo,k=Co(Object(o.useState)(!0),2),D=k[0],S=k[1],F=Object(o.useMemo)((function(){return r.type===io.Upload?O:r.type===io.Edit?j:null}),[O,j]),x=Object(o.useCallback)((function(e){var t={owner_id:e.ownerId,video_id:e.id,name:e.title,desc:e.description};p("video.edit",t,{showSpinner:!0}).then((function(){var a=e.fileList.get(t.video_id);a&&(a.data.title=t.name,a.data.description=t.desc,e.fileList.set(t.video_id,a)),n()})).catch(C)}),[F]),A=function(e){var t,n,a=e.currentTarget,o=a.name,i=a.value;"title"===o&&S(!0),r.type===io.Upload&&s(Object(E.X)(Eo(Eo({},O),((t={})[o]=i,t)))),r.type===io.Edit&&s(Object(E.W)(Eo(Eo({},j),((n={})[o]=i,n))))};return i.a.createElement(l.N,{id:t,onClose:r.type===io.Upload?a:n,header:i.a.createElement(B,{onClose:r.type===io.Upload?a:n},m(jo[r.type])),dynamicContentHeight:c},i.a.createElement(l.u,{top:m("vkui_edu_video_edit_form_field_title"),status:D?"default":"error",bottom:!D&&m("vkui_edu_video_edit_form_field_title_error")},i.a.createElement(l.I,{name:"title",value:null==F?void 0:F.title,onChange:A})),i.a.createElement(l.u,{top:m("vkui_edu_video_edit_form_field_description")},i.a.createElement(l.yb,{placeholder:m("vkui_edu_video_edit_form_field_description_placeholder"),name:"description",value:null==F?void 0:F.description,onChange:A,grow:!1})),i.a.createElement(f.a,{fixed:!0,noShadow:!_},i.a.createElement(l.i,{type:"submit",stretched:!_,size:_?"m":"l",onClick:function(){var e;""!==(null==F?void 0:F.title.trim())?(r.type===io.Upload&&"function"==typeof(null===(e=O.onFileSelectRef)||void 0===e?void 0:e.current)&&O.video&&(O.onFileSelectRef.current({file:O.video,title:O.title.trim(),description:O.description.trim()}),n()),r.type===io.Edit&&x(j)):S(!1)}},m("vkui_edu_video_edit_form_btn_save"))))},Do=Object(o.memo)(ko),So=n(868),Fo=n.n(So),xo=function(){return(xo=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Ao=function(e){return e.map((function(e){var t,n;return{id:e.id,first_name:e.firstName||e.first_name,last_name:e.lastName||e.last_name,photo_100:e.photo||(null===(t=e)||void 0===t?void 0:t.photo_100),photo_200:e.photo||(null===(n=e)||void 0===n?void 0:n.photo_200),join_link:""}}))},wo=function(e,t){return void 0===t&&(t=!1),e.reduce((function(e,n){var a;return xo(xo({},e),((a={})[n.id]=t?[]:n.grades.filter((function(e){return!Object(h.i)(e)})).map((function(e){return{id:e.id,first_name:Object(h.d)(e),last_name:"",join_link:"",color:e.color||Ht(e.id),letters:Object(h.b)(e)}})),a))}),{})},No=n(869),Io={insert:"head",singleton:!1},Mo=(S()(No.a,Io),No.a.locals,function(){return(Mo=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),Lo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},To=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Lo(arguments[t]));return e};!function(e){e.Contacts="contacts",e.Chats="chats"}(Oo||(Oo={}));var Bo=[{type:Oo.Chats,title:"vkui_edu_calls_chats"},{type:Oo.Contacts,title:"vkui_edu_calls_contacts"}],Po=((yo={})[Oo.Chats]="vkui_edu_calls_continue",yo[Oo.Contacts]="vkui_edu_calls_invite",yo),Ro=function(e){var t,n,a,c,s=Object(u.c)().getLangKey,d=Object(o.useContext)(v.a),_=d.apiRequest,m=d.hideModal,b=d.onCallUser,h=d.onCallGroup,p=d.onCallJoinByLink,E=Object(g.b)().accountInfo,C=Lo(Object(o.useState)(!1),2),y=C[0],O=C[1],j=Lo(Object(o.useState)(Oo.Chats),2),k=j[0],D=j[1],S=Lo(Object(o.useState)(Ao([E])),1)[0],F=Lo(Object(o.useState)(((t={})[Oo.Contacts]=[],t[Oo.Chats]=[],t)),2),x=F[0],A=F[1],w=Lo(Object(o.useState)(((n={})[Oo.Contacts]=[],n[Oo.Chats]=[],n)),2),N=w[0],I=w[1],M=Lo(Object(o.useState)(((a={})[Oo.Contacts]=S,a[Oo.Chats]=S,a)),2),L=M[0],T=M[1],P=Object(l.Fb)("CreateCalls__list",{"CreateCalls__list--no-grouping":k===Oo.Chats,"CreateCalls__list--grouping":k!==Oo.Chats});Object(o.useEffect)((function(){Promise.all([_("education.searchFriends"),_("messages.getConversations",{count:200})]).then((function(e){var t,n=Lo(e,2),a=n[0],r=function(e){return e.map((function(e){return e.conversation})).filter((function(e){return e.chat_settings&&e.chat_settings.acl.can_call&&"chat"===e.peer.type}))}(n[1].items),o=((t={})[Oo.Contacts]=Ao(a.items),t[Oo.Chats]=function(e){return e.map((function(e){var t,n;return{id:e.peer.id,first_name:e.chat_settings.title,last_name:"",photo_100:null===(t=e.chat_settings.photo)||void 0===t?void 0:t.photo_100,photo_200:(null===(n=e.chat_settings.photo)||void 0===n?void 0:n.photo_200)||Fo.a,letters:e.chat_settings.title[0].toUpperCase(),color:Ht(e.peer.id),join_link:e.call_in_progress&&e.call_in_progress.join_link||""}}))}(r),t);A(o),I(o)})).finally((function(){O(!0)}))}),[]);var R=Object(o.useMemo)((function(){return i.a.createElement(B,{onClose:e.onClose},s("vkui_edu_calls_invite_to_call"))}),[]);return i.a.createElement(l.N,r()({},e,{header:R}),i.a.createElement(l.hb,{onChange:function(e){var t,n=e.currentTarget.value;k===Oo.Contacts&&(c&&window.clearTimeout(c),c=window.setTimeout((function(){O(!1),_("education.searchFriends",{q:n}).then((function(e){var t;A(Mo(Mo({},x),((t={})[Oo.Contacts]=Ao(e.items),t)))})).finally((function(){O(!0)}))}),400)),k===Oo.Chats&&A(Mo(Mo({},x),((t={})[Oo.Chats]=N[k].filter((function(e){return e.first_name.includes(n)})),t)))}}),i.a.createElement(l.ub,null,Bo.map((function(e){return i.a.createElement(l.vb,{key:e.type+"_"+e.title,"data-id":e.type,selected:k===e.type,onClick:function(){return D(e.type)}},s(e.title))}))),k===Oo.Chats&&i.a.createElement(l.kb,null),!y&&i.a.createElement(l.Y,null),y&&0===x[k].length&&i.a.createElement(l.t,null,s("vkui_common_nothing_found")),y&&x[k].length>0&&i.a.createElement(en.a,{selectable:!0,className:P,grouping:k===Oo.Contacts,users:x[k],selectedUsers:L[k],disabledUsers:S,onSelectChange:function(e){var t,n=S;e[0].id!==E.id&&(n=To(n,e)),T(Mo(Mo({},L),((t={})[k]=n,t)))}}),i.a.createElement(f.a,{fixed:!0},i.a.createElement(l.i,{type:"submit",size:"m",onClick:function(){var e=L[k][1],t=e.id;m(),k===Oo.Contacts&&b(t,e.first_name+" "+e.last_name),k===Oo.Chats&&(e.join_link?p(t,e.join_link):h(t,Mo(Mo({},e),{name:e.first_name})))},disabled:L[k].length<2},s(Po[k]))))},Uo=Object(o.memo)(Ro),zo=n(58),Ho=n(870),qo={insert:"head",singleton:!1},Wo=(S()(Ho.a,qo),Ho.a.locals,function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}),Jo=function(e){var t,n=e.id,a=e.onClose,r=Object(u.c)(),s=r.getLangKey,d=r.getLangNumeric,_=Object(g.b)().chatPreview,m=Object(o.useContext)(v.a),f=m.apiRequest,h=m.go,p=m.showErrorSnackbar,C=Object(l.Ib)().viewWidth,y=Object(b.a)(C),O=Object(g.a)(),j=_.preview,k=j.title,D=j.photo,S=j.members,F=j.admin_id,x=Wo(Object(o.useState)([]),2),A=x[0],w=x[1],N=Wo(Object(o.useState)({first_name:null,last_name:null}),2),I=N[0],M=N[1];Object(o.useEffect)((function(){S.length>0&&f("users.get",{user_ids:S.join(","),fields:"photo_50"}).then((function(e){w(e)}))}),[S]),Object(o.useEffect)((function(){F>0&&f("users.get",{user_ids:""+F}).then((function(e){M(e[0])}))}),[F]);var L=!_||0===A.length,T=I.first_name||I.last_name,B=A.map((function(e){return e.photo_50})),P=A.slice(1,3).reduce((function(e,t){return e+", "+t.first_name}),null===(t=A[0])||void 0===t?void 0:t.first_name),R=A.length>3&&d(A.length-3,"vkui_edu_preview_members");return i.a.createElement(l.M,{id:n,className:"Сonversation",onClose:a},i.a.createElement(ea.a,{isLoaded:!L,small:!0},i.a.createElement("div",{className:y&&"Conversation__center"},D&&i.a.createElement(l.h,{size:72,className:"Conversation__avatar",src:null==D?void 0:D.photo_100}),k&&i.a.createElement(l.zb,{level:"2",className:"Conversation__title",weight:"medium"},k),i.a.createElement(l.xb,{weight:"regular",className:"Conversation__text"},s("vkui_edu_chat_type_school"),i.a.createElement("br",null),T&&s("vkui_edu_member_role_teacher")+": "+I.first_name+" "+I.last_name),i.a.createElement(l.Ab,{photos:B,visibleCount:3,size:y?"m":"s",layout:"vertical",className:"Conversation__users"},P,R&&i.a.createElement("div",{dangerouslySetInnerHTML:{__html:R}})),i.a.createElement(l.i,{stretched:!y,type:"submit",size:y?"m":"l",onClick:function(){f("messages.joinChatByInviteLink",{link:_.invite_link}).then((function(e){var t=e.chat_id;if(Object(ka.b)({event_type:"chat_join",chat_id:t,chat_users_count:_.preview.members_count,chat_type:"class"}),t){var n={act:"show",peer:Oe.i+ +t};O(Object(E.t)({query:n,path:"/mail",url:"",isNewMail:!1})),h(c.h.MESSAGES,n)}})).catch((function(e){h(c.g.CHAT_ACCESS_RESTRICTED);var t="";e.error_code===zo.a?t="school":e.error_code===Oe.b&&(t="grade"),t?(h(c.g.CHAT_ACCESS_RESTRICTED),O(Object(E.f)(t))):p(e.error_text||e.error_msg)}))}},s("vkui_edu_messages_join_chat")))))},Ko=Object(o.memo)(Jo),Vo=n(762),Go=function(e){var t=Object(o.useContext)(l.Q).updateModalHeight,n=Object(u.c)().getLangKey,a=Object(g.b)().inviteLinkCreateInfo,r=Object(Vo.b)((function(){return e.onClose()})),c=r.isLoading,s=r.createLink;return Object(o.useEffect)((function(){t()}),[]),i.a.createElement(l.N,{id:e.id,header:i.a.createElement(B,{onClose:e.onClose},n("vkui_edu_invite_links_create_title")),onClose:e.onClose},i.a.createElement(Vo.a,{schoolId:a.schoolId}),i.a.createElement(f.a,null,i.a.createElement(l.i,{size:"m",onClick:function(){return s()},disabled:!a.canSubmit||c},n("vkui_common_save"))))},Yo=i.a.memo(Go),Qo=n(871),Xo=n.n(Qo),Zo=n(872),$o={insert:"head",singleton:!1},ei=(S()(Zo.a,$o),Zo.a.locals,function(e){var t=e.text,n=e.size,a=e.className,r=e.background,o=Xo.a.createQR(t,{qrSize:n,isShowBackground:r,backgroundColor:"#ffffff"});return i.a.createElement("div",{className:Object(l.Fb)("QRCode",a),dangerouslySetInnerHTML:{__html:o}})}),ti=i.a.memo(ei),ni=n(873),ai={insert:"head",singleton:!1},ri=(S()(ni.a,ai),ni.a.locals,n(874)),oi=function(e){var t=Object(b.b)(e.viewWidth),n=Object(u.c)().getLangKey,a=Object(g.b)().qrCodePreviewInfo;return i.a.createElement(l.M,e,i.a.createElement("div",{className:"QRCodePreview"},i.a.createElement(ti,{className:"QRCodePreview__qr",text:null==a?void 0:a.url,size:184,background:!0}),!!(null==a?void 0:a.title)&&i.a.createElement(l.zb,{weight:"semibold",level:"1",className:"QRCodePreview__title"},a.title),i.a.createElement(l.rb,{weight:"regular",className:"QRCodePreview__description"},n("vkui_edu_qr_code_preview_description")),i.a.createElement(l.i,{className:"QRCodePreview__button",mode:"secondary",size:t?"l":"m",onClick:function(){var e=document.querySelector(".QRCodePreview__qr svg");Object(ri.svgAsPngUri)(e,{scale:.2}).then((function(e){var t=document.createElement("a");t.href=e,t.download="qr"+Date.now()+".png",t.type="image/png",t.click()}))},stretched:t},n("vkui_edu_qr_code_preview_download_button"))))},ii=Object(l.Kb)(Object(o.memo)(oi),{viewWidth:!0}),li=n(79),ci=n(52),ui=function(){return(ui=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},si=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},di=function(e){var t=Object(u.c)().getLangKey,n=Object(ci.a)(),a=n.searchFilters,c=n.setFilterValues,s=si(Object(o.useState)(ui({},a.values)),2),d=s[0],_=s[1],m=Object(l.Ib)().viewWidth,f=Object(b.a)(m),h=Object(g.b)().searchFilterModalCallback,p=a.filters.reduce((function(e,t){var n,a=t.defaultValue;if(Array.isArray(t.options)&&t.options.length){var r=si(t.options,1)[0];r&&r.hasOwnProperty("value")&&(a=r.value)}return ui(ui({},e),((n={})[t.name]=a,n))}),{});return i.a.createElement(l.N,{id:e.id,header:i.a.createElement(B,{left:i.a.createElement(l.U,{onClick:function(){_(p),null==h||h.callback(p)}},t("vkui_edu_search_filters_clear")),onClose:e.onClose},t("vkui_edu_search_filters")),onClose:e.onClose},i.a.createElement(U,{minHeight:200},(null==a?void 0:a.values)&&i.a.createElement(li.a,r()({},a,{values:d,onChange:function(e){_((function(t){return ui(ui({},t),e)})),null==h||h.callback(ui(ui({},d),e))}}))),i.a.createElement(l.r,null,i.a.createElement(l.i,{size:f?"m":"l",stretched:!f,onClick:function(){c(d),e.onClose()}},t("vkui_edu_search_show_results"))))},_i=Object(o.memo)(di),mi=n(356),fi=function(){return(fi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},bi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},hi=function(e){var t,n=Object(l.Ib)().viewWidth,a=Object(b.b)(n),c=Object(u.c)().getLangKey,s=Object(g.b)().profileSchools,d=Object(mi.a)().getClassChat,_=s.filter((function(e){return e.isTeacherInSchool})),m=bi(Object(o.useState)(_[0].id),2),h=m[0],p=m[1],v=bi(Object(o.useState)(wo(_)),2),E=v[0],C=v[1],y=bi(Object(o.useState)(wo(_)),1)[0],O=bi(Object(o.useState)(wo(_,!0)),2),j=O[0],k=O[1],D=bi(j[h],1)[0],S=Object(o.useMemo)((function(){return i.a.createElement(B,{onClose:e.onClose},c("vkui_edu_modal_create_lesson_title"))}),[]);return Object(o.useEffect)((function(){var e=null,t=function(e){e.stopPropagation()};return a&&(e=document.querySelector(".CreateCallsLessonModal .HorizontalScroll__in"))&&e.addEventListener("touchmove",t),function(){e&&e.removeEventListener("touchmove",t)}}),[]),i.a.createElement(l.N,r()({},e,{header:S,className:"CreateCallsLessonModal"}),i.a.createElement(l.hb,{onChange:function(e){var n=e.currentTarget.value;t&&window.clearTimeout(t),t=window.setTimeout((function(){var e;C(fi(fi({},E),((e={})[h]=y[h].filter((function(e){return e.first_name.includes(n)})),e)))}),400)}}),i.a.createElement(l.E,{showArrows:!0,getScrollToLeft:function(e){return e-208},getScrollToRight:function(e){return e+208}},i.a.createElement(l.ub,null,_.map((function(e){return i.a.createElement(l.vb,{key:e.id,"data-id":e.id,selected:h===e.id,onClick:function(){return p(e.id)}},e.name)})))),i.a.createElement(l.kb,null),0===E[h].length&&i.a.createElement(l.t,null,c("vkui_common_nothing_found")),E[h].length>0&&i.a.createElement(en.a,{selectable:!0,grouping:!1,className:"CreateCalls__list--no-grouping",users:E[h],selectedUsers:j[h],onSelectChange:function(e){var t;k(fi(fi({},j),((t={})[h]=e,t)))}}),i.a.createElement(f.a,{fixed:!0,noShadow:a},i.a.createElement(l.i,{type:"submit",size:a?"l":"m",onClick:function(){d(h,D.id)},disabled:!D,stretched:a},c("vkui_edu_modal_create_lesson_btn"))))},pi=Object(o.memo)(hi),vi=n(434),gi=n(45),Ei=n(875),Ci={insert:"head",singleton:!1},yi=(S()(Ei.a,Ci),Ei.a.locals,function(e){var t=Object(u.c)().getLangKey,n=Object(o.useContext)(v.a).go,a=Object(o.useContext)(l.Q).updateModalHeight,s=Object(l.Ib)().viewWidth,d=Object(b.b)(s),_=Object(g.b)(),m=_.calls,f=_.profileSchools,h=_.callsLib,p=m.filter(gi.n),E=f.some((function(e){return e.isTeacherInSchool})),C=Object(gi.l)(p);Object(o.useEffect)((function(){a()}),[p.length]);var y=function(){n(c.g.CREATE_CALL_LESSON)},O=Object(o.useMemo)((function(){return i.a.createElement(B,{onClose:e.onClose},i.a.createElement("div",{className:"CallsListModal__content"},t("vkui_edu_calls_current_lessons")))}),[]),j=Object(o.useMemo)((function(){return E?i.a.createElement("div",{className:"CallsListModal__action"},i.a.createElement(l.i,{className:"CallsListModal__button",size:d?"l":"m",mode:"primary",stretched:!0,before:i.a.createElement(Jn.a,{width:24,height:24}),onClick:y,disabled:C},t("vkui_edu_calls_start_new_lesson"))):null}),[E,d,C]);return i.a.createElement(l.N,r()({},e,{header:O,className:"CallsListModal",settlingHeight:0}),i.a.createElement("div",{className:"CallsListModal__container"},i.a.createElement("div",{className:"CallsListModal__content"},d&&j,i.a.createElement(vi.a,{callsLib:h,calls:p}),!d&&j)))}),Oi=Object(o.memo)(yi),ji=n(720),ki=function(e){return i.a.createElement("svg",r()({width:"56",height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),i.a.createElement("path",{d:"M49 15a9.3 9.3 0 00-5.4-2.6c-.3-2.1-1.1-4-2.5-5.4A24 24 0 007 41a9.3 9.3 0 005.3 2.6c.3 2.1 1.1 4 2.5 5.4a24 24 0 0034-34z",fill:"url(#paint_0)"}),i.a.createElement("path",{d:"M22 22c7-7 15.5-10.6 21.6-9.6-.3-2.1-1.1-4-2.5-5.4-5.5-5.5-17.6-2.3-27 7.1-9.4 9.4-12.6 21.5-7 27a9.3 9.3 0 005.3 2.5C11.4 37.5 14.9 29 22 22z",fill:"url(#paint_1)"}),i.a.createElement("defs",null,i.a.createElement("radialGradient",{id:"paint_1",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"rotate(-129 25.4 9.2) scale(21.3139 31.4366)"},i.a.createElement("stop",{stopColor:"#0B25CE"}),i.a.createElement("stop",{offset:".5",stopColor:"#2C93DB"}),i.a.createElement("stop",{offset:".8",stopColor:"#42DCE4"}),i.a.createElement("stop",{offset:"1",stopColor:"#4BF9E8"})),i.a.createElement("linearGradient",{id:"paint_0",x1:"10.4",y1:"43.4",x2:"45.2",y2:"13",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#0000C9"}),i.a.createElement("stop",{offset:".1",stopColor:"#2006C9"}),i.a.createElement("stop",{offset:".3",stopColor:"#4A0EC8"}),i.a.createElement("stop",{offset:".5",stopColor:"#6B14C8"}),i.a.createElement("stop",{offset:".7",stopColor:"#8318C7"}),i.a.createElement("stop",{offset:".9",stopColor:"#911BC7"}),i.a.createElement("stop",{offset:"1",stopColor:"#961CC7"}))))},Di=n(125),Si=n(234),Fi=n(199),xi=n(40),Ai=n(876),wi={insert:"head",singleton:!1},Ni=(S()(Ai.a,wi),Ai.a.locals,function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}),Ii=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},Mi=function(e){var t=e.id,n=e.params,a=Ni(e,["id","params"]),c=!n.joinLink&&n.peerId,s=Object(p.i)(),d=Object(g.b)().accountInfo,_=Object(u.c)().getLangKey,m=Object(mi.a)(),f=m.callInClassChat,b=m.classChatInfo,h=Object(o.useContext)(v.a),E=h.showSnackbar,C=h.apiRequest,y=h.onCallJoinByLink,O=h.showErrorMessage,j=!0===Object(o.useRef)(null!==Object(ye.a)(Oe.p)).current,k=Ii(Object(o.useState)(!j),2),D=k[0],S=k[1],F=Object(o.useRef)(null);aa.d.OS===aa.c.MAC?F.current={url:xi.e[aa.c.MAC],filename:xi.f[aa.c.MAC]}:aa.d.OS===aa.c.WINDOWS&&(F.current={url:xi.e[aa.c.WINDOWS],filename:xi.f[aa.c.WINDOWS]});var x=null!==F.current,A=Ii(Object(o.useState)(!x&&!j),2),w=A[0],N=A[1],I=function(){return c?Object(Si.a)(Object(Fi.b)({peerId:n.peerId,userId:d.id})):Object(Si.a)(Object(Fi.a)({joinLink:n.joinLink,userId:d.id}))},M=function(){Object(ye.c)(Oe.p,"true")};return Object(o.useEffect)((function(){I().then((function(){S(!1)})).catch((function(){var e,t;x&&!j?(e=F.current.url,t=F.current.filename,E(i.a.createElement(kt.a,null,_("vkui_edu_download_file_snippet").replace("{filename}",t)),{before:aa.d.isChromeBased&&i.a.createElement(ji.a,{className:"JoinCallModal__snackbarIcon"}),duration:1e4,onClose:function(){return null}}),M(),Object(Di.a)(e,t),setTimeout((function(){S(!1)}),5e3)):S(!1)}))}),[]),i.a.createElement(l.M,r()({id:t,header:_(D&&x?"vkui_edu_download_started":j?"vkui_edu_calls_title":c?"vkui_edu_start_call_after_install_app":"vkui_edu_join_call_after_install_app"),subheader:w?_("vkui_edu_download_and_install_app_for_pc"):j?_(c?"vkui_edu_try_manual_start_lesson":"vkui_edu_try_manual_join_lesson"):D?_("vkui_edu_wait_until_app_downloaded"):"",icon:i.a.createElement(ki,null),className:"JoinCallModal"},a),D&&x?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.ob,{size:"large",className:"JoinCallModal__action"}),i.a.createElement("div",{className:"JoinCallModal__text"},_("vkui_edu_downloading_file").replace("{file}",F.current.filename))):w?i.a.createElement(l.i,{size:"l",before:i.a.createElement(ji.a,null),href:Oa.a,target:"_blank",onClick:function(){M(),N(!1)},className:"JoinCallModal__action"},_("vkui_edu_download_app")):i.a.createElement(l.i,{mode:"secondary",size:"l",before:i.a.createElement(Jn.a,null),onClick:I,className:"JoinCallModal__action"},_(c?"vkui_edu_callls_start_lesson":"vkui_edu_calls_join_lesson")),!w&&i.a.createElement(l.rb,{weight:"regular",className:"JoinCallModal__text"},i.a.createElement("div",null,_("vkui_edu_apps_for_all_platform")),i.a.createElement(l.J,{href:Oa.a,target:"_blank"},_("vkui_edu_open_app_list"))),i.a.createElement(l.rb,{weight:"regular",className:"JoinCallModal__text"},_("vkui_edu_calls_troubles_with_app"),i.a.createElement(l.J,{onClick:function(){if(s){var e=n.joinLink,t=n.peerId;(e||t)&&(c?f(b):e?y(t,e):C("messages.getConversationsById",{peer_ids:String(t)}).then((function(e){var n=e.items[0].call_in_progress.join_link;y(t,n)})))}else O(_("vkui_edu_unsupported_calls_browser"))}},_(c?"vkui_edu_calls_start_lesson_in_browser":"vkui_edu_calls_join_lesson_in_browser"))))},Li=n(877),Ti={insert:"head",singleton:!1},Bi=(S()(Li.a,Ti),Li.a.locals,function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}),Pi=function(e){var t,n=e.id,a=e.onClose,r=e.params,s=Object(u.c)().getLangKey,d=Bi(Object(o.useState)(!r.joinLink&&r.peerId),1)[0];Object(o.useEffect)((function(){Object(ye.c)(Oe.q,JSON.stringify({downloaded:!1,url:location.href}))}),[]);var _=function e(){t&&(t=null,window.clearTimeout(t)),window.removeEventListener("blur",e)};return i.a.createElement(l.M,{id:n,onClose:a},i.a.createElement(l.z,{className:"MobileJoinCallModal__gradient"},i.a.createElement(l.zb,{level:"2",weight:"medium"},s("vkui_edu_mobile_modal_select_app_title")),i.a.createElement(l.rb,{weight:"regular",className:"MobileJoinCallModal__subhead"},s(d?"vkui_edu_mobile_modal_select_app_desc_start":"vkui_edu_mobile_modal_select_app_desc_join"))),i.a.createElement("div",{className:"MobileJoinCallModal__content"},i.a.createElement(l.l,{disabled:!0,className:"MobileJoinCallModal__cell",before:i.a.createElement(ki,{className:"MobileJoinCallModal__icon",width:48,height:48}),after:i.a.createElement(l.i,{size:"s",href:(aa.d.OS===aa.c.IOS||aa.d.isIPad)&&(d?Object(Fi.d)({callPeerId:r.peerId}):r.callId?Object(Fi.e)(r.callId):Object(Fi.d)({callJoinLink:r.joinLink})),target:(aa.d.OS===aa.c.IOS||aa.d.isIPad)&&"_blank",onClick:aa.d.OS===aa.c.ANDROID&&function(){var e,n="";n=d?Object(Fi.c)("start",{peerId:r.peerId}):r.callId?Object(Fi.e)(r.callId):Object(Fi.c)("join",{call_link:r.joinLink}),e=c.b.buildUrl(c.h.DOWNLOAD_MOBILE_APP),window.addEventListener("blur",_),t=window.setTimeout((function(){t&&window.location.replace(e),_()}),2e3),window.location=n}},s("vkui_edu_mobile_modal_select_app_open_btn"))},s("vkui_edu_mobile_modal_select_app_name"))))},Ri=n(878),Ui={insert:"head",singleton:!1},zi=(S()(Ri.a,Ui),Ri.a.locals,function(e){var t=Object(u.c)().getLangKey,n=e.params.pladformType,a=n===aa.c.IOS?xi.a:xi.h;return i.a.createElement(l.M,e,i.a.createElement("div",{className:"DownloadAppModal"},i.a.createElement(ti,{className:"DownloadAppModal__qr",text:a,size:200,background:!0}),i.a.createElement(l.zb,{weight:"semibold",level:"1",className:"DownloadAppModal__title"},t(n===aa.c.IOS?"vkui_edu_download_app_modal_title_ios":"vkui_edu_download_app_modal_title_android")),i.a.createElement(l.rb,{weight:"regular",className:"DownloadAppModal__description"},t("vkui_edu_download_app_modal_description")),i.a.createElement(l.J,{className:"DownloadAppModal__link",target:"_blank",rel:"noreferrer",href:a},t("vkui_edu_download_app_link"))))}),Hi=Object(l.Kb)(Object(o.memo)(zi),{viewWidth:!0}),qi=n(438),Wi=n(879),Ji={insert:"head",singleton:!1},Ki=(S()(Wi.a,Ji),Wi.a.locals,function(e){var t=e.id,n=e.onClose,a=Object(o.useMemo)((function(){return i.a.createElement(B,{onClose:n},"Выберите платформу")}),[]);return i.a.createElement(l.N,{id:t,header:a,onClose:n},i.a.createElement(l.A,{className:"DownloadAppSelectModal__group"},aa.d.OS!==aa.c.MAC&&i.a.createElement("div",{className:"DownloadAppSelectModal__button"},i.a.createElement(qi.a,{size:"l",platform:aa.c.MAC})),aa.d.OS!==aa.c.WINDOWS&&i.a.createElement("div",{className:"DownloadAppSelectModal__button"},i.a.createElement(qi.a,{size:"l",platform:aa.c.WINDOWS})),aa.d.OS!==aa.c.LINUX&&i.a.createElement("div",{className:"DownloadAppSelectModal__button"},i.a.createElement(qi.a,{size:"l",platform:aa.c.LINUX}))))}),Vi=Object(o.memo)(Ki),Gi=n(881),Yi=n.n(Gi),Qi=n(880),Xi={insert:"head",singleton:!1},Zi=(S()(Qi.a,Xi),Qi.a.locals,function(e){var t,n,a=e.id,r=e.onClose,d=Object(u.c)().getLangKey,_=Object(o.useContext)(v.a),m=_.go,f=_.apiRequest,b=_.showError,h=_.showInfoSnackbar,p=_.getConversationsWithCalls,C=_.getUserOnboardingStatus,y=Object(g.a)(),O=Object(g.b)(),j=O.profileAddSchool,k=O.inviteLink,D=O.accountInfo,S=j.role===s.a.TEACHER,F=D?D.id:null,x=Object(xa.a)(F).getProfileSchoolGradeRequests,A=Object(Aa.a)(F).getProfileSchools,w=5,N=(j.classes||[]).map((function(e){return""+e.number+e.liter})),I=function(e,t){e?m(c.h.SCHOOL,{schoolId:t}):r(),setTimeout((function(){Object(pe.a)((function(){y(Object(E.V)(void 0)),y(Object(E.b)()),C()}))}),500)};Object(o.useEffect)((function(){return(null==k?void 0:k.linkId)&&Object(ye.b)(Oe.w),function(){clearInterval(n)}}),[]);return i.a.createElement(l.N,{id:a,onClose:function(){return I(!1)},header:null},i.a.createElement(l.A,null,i.a.createElement("section",{className:"JoinSchoolModal__content"},i.a.createElement(Yi.a,{className:"JoinSchoolModal__icon"}),i.a.createElement(l.zb,{weight:"medium",level:"2"},null===(t=j.school)||void 0===t?void 0:t.name),i.a.createElement("div",{className:"JoinSchoolModal__description"},d("vkui_edu_joinSchoolModal_descr"),i.a.createElement("div",{className:"JoinSchoolModal__joinRoles"},i.a.createElement("div",null,d("vkui_edu_joinSchoolModal_role"),": ",d(Object(Qn.a)(j.role))),1===N.length?i.a.createElement("div",null,d("vkui_edu_joinSchoolModal_grade"),": ",N.join(", ")):i.a.createElement("div",null,d("vkui_edu_joinSchoolModal_grades"),": ",N.join(", "))))),i.a.createElement("section",{className:"JoinSchoolModal__footer"},i.a.createElement(l.i,{className:"JoinSchoolModal__footerButton",type:"button",stretched:!0,size:"l",onClick:function(){if(S)m(c.g.JOIN_SCHOOL_TEACHER,{},{replace:!0});else{var e=S?j.object:"",t=(j.classes||[]).map((function(e){return e.id})).join(","),a={school_id:j.school.id,user_id:D.id,role_description:e,link_id:k.linkId,grade_ids:t};f("education.applyInviteLink",a,{showSpinner:!0}).then((function(e){x(),A(),p(),n=window.setInterval((function(){w>0&&(p(),w--)}),6e3),h(d(0===e?"vkui_edu_grade_request_registered":"vkui_edu_grade_request_sent")),Object(ke.a)({event_type:"join_school",edu_user_id:a.user_id,school_id:a.school_id}),na.a.isWebView()&&na.a.send("VKWebAppCustomMessage",{action:"updateSchools"}),I(!0,a.school_id)})).catch(b)}}},d("vkui_edu_joinSchoolModal_join")),i.a.createElement(l.i,{className:"JoinSchoolModal__footerButton",type:"button",stretched:!0,mode:"secondary",size:"l",onClick:r},d("vkui_common_cancel")))))}),$i=n(882),el={insert:"head",singleton:!1},tl=(S()($i.a,el),$i.a.locals,n(358)),nl=n(359),al=Object(tl.a)((function(e){var t=e.id,n=e.onClose,a=e.onStart,r=Object(o.useContext)(v.a),s=r.go,d=r.hideModal,_=r.isAuthorized,m=Object(u.c)().getLangKey,f=je(),b=_();return Object(o.useEffect)((function(){f()}),[]),i.a.createElement(l.N,{id:t,header:null,onClose:function(){n(),s(c.h.START)}},i.a.createElement(nl.a,{className:"WrongInvite",title:m("vkui_edu_wrong_invite_modal_title"),subTitle:m(b?"vkui_edu_wrong_invite_modal_desc_for_logged":"vkui_edu_wrong_invite_modal_desc"),buttonText:m(b?"vkui_edu_add_school_submit":"vkui_edu_promo_submit"),onButtonClick:b?function(){s(c.g.PROFILE_ADD_SCHOOL)}:function(){d(),a()}}))})),rl=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},ol=function(e){var t,n=e.id,a=e.onClose,s=rl(e,["id","onClose"]),d=Object(o.useContext)(v.a),_=d.go,m=d.apiRequest,f=d.showError,b=d.showInfoSnackbar,h=d.getConversationsWithCalls,p=d.getUserOnboardingStatus,C=Object(g.b)(),y=C.profileAddSchool,O=C.inviteLink,j=C.accountInfo,k=j?j.id:null,D=Object(g.a)(),S=Object(xa.a)(k).getProfileSchoolGradeRequests,F=Object(Aa.a)(k).getProfileSchools,x=Object(u.c)().getLangKey,A=5,w=function(e,t){e?_(c.h.SCHOOL,{schoolId:t}):a(),setTimeout((function(){Object(pe.a)((function(){D(Object(E.V)(void 0)),D(Object(E.b)()),p()}))}),500)};Object(o.useEffect)((function(){return(null==O?void 0:O.linkId)&&Object(ye.b)(Oe.w),y.school||w(!1),function(){clearInterval(t)}}),[]);return i.a.createElement(l.N,r()({id:n,header:"",onClose:function(){return w(!1)}},s),y.school&&i.a.createElement(Pe,r()({},y,{title:x("vkui_edu_registration_school_invite"),update:E.eb,submit:function(){var e=y.object,n=y.classes.map((function(e){return e.id})).join(","),a={school_id:y.school.id,user_id:j.id,role_description:e,link_id:O.linkId,grade_ids:n};m("education.applyInviteLink",a,{showSpinner:!0}).then((function(e){S(),F(),h(),t=window.setInterval((function(){A>0&&(h(),A--)}),6e3),b(x(0===e?"vkui_edu_grade_request_registered":"vkui_edu_grade_request_sent")),Object(ke.a)({event_type:"join_school",edu_user_id:a.user_id,school_id:a.school_id}),na.a.isWebView()&&na.a.send("VKWebAppCustomMessage",{action:"updateSchools"}),w(!0,a.school_id)})).catch(f)}})))},il=n(883),ll={insert:"head",singleton:!1},cl=(S()(il.a,ll),il.a.locals,n(884)),ul=n(885),sl=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},dl=Object(l.Kb)(Object(tl.a)((function(e){var t=e.id,n=e.onClose,a=e.viewWidth,r=e.onStart,c=e.callId,s=Object(o.useContext)(v.a),d=s.apiRequest,_=s.callInitAnonym,m=s.onCallJoinByPreview,f=s.isAuthorized,h=s.showErrorSnackbar,p=s.hideModal,E=sl(Object(o.useState)(null),2),C=E[0],y=E[1],O=sl(Object(o.useState)(!0),2),j=O[0],k=O[1],D=sl(Object(o.useState)(""),2),S=D[0],F=D[1],x=Object(b.b)(a),A=Object(o.useMemo)((function(){return/^[A-Za-zА-Яа-яЁё0-9_\- ]{2,25}$/}),[]),w=Object(o.useMemo)((function(){return f()}),[]),N=sl(Object(o.useState)(w),2),I=N[0],M=(N[1],"https://"+Oa.b.call_link_host+"/?call_link="+c),L=(Object(g.b)().accountInfo,Object(u.c)()),T=L.getLangKey,B=L.getLangNumeric;function P(e){var t=function(e){if(e){if(e.error_code){if(e.error_code===Oe.a)return T("vkui_edu_error_calls_not_found");if(e.error_code===Oe.d)return k(!1),T("vkui_edu_error_calls_invalid_name")}return e instanceof Error?e.stack||e.message||""+e:e.error_text||e.error_msg||""+e}return T("vkui_common_error_text_common")}(e);h(t)}Object(o.useEffect)((function(){I?Object(gi.c)(d,M).then((function(e){y(e)}),P):Object(gi.a)(d,M).then((function(e){y(e)}),P)}),[I]);var R=function(e){I?(m(C,e),setTimeout(n,100)):function(e){if(S){if(j){var t=C.user_id,a=S;Object(gi.b)(d,M,t,a,C.secret).then((function(r){return _({token:r.token,secret:r.secret,anonymUserId:t,anonymName:a,callTitle:C.preview.title,callPhoto:_l(C.preview.photo)}).then((function(t){t.joinCallByLink(C.join_link,null,e),setTimeout(n,100)}))}),P)}}else k(!1)}(e)};return i.a.createElement(l.N,{header:"",id:t,onClose:n},!C&&i.a.createElement(l.Y,{size:"regular"}),C&&x&&i.a.createElement(l.O,{separator:!1,className:"CallJoinModal__header",right:i.a.createElement(l.U,{onClick:n},i.a.createElement(Wn.a,null))}),C&&i.a.createElement(l.A,null,i.a.createElement(l.Z,{icon:i.a.createElement(l.h,{size:72,src:_l(C.preview.photo)}),header:T("vkui_edu_call_join_title")},i.a.createElement(l.rb,{weight:"regular",style:{marginTop:8}},C.preview.title),i.a.createElement(l.rb,{weight:"regular",style:{marginTop:8}},T("vkui_edu_call_join_info")),w&&i.a.createElement(i.a.Fragment,null,!!C.preview.members_count&&i.a.createElement(l.Ab,{style:{marginTop:20},photos:C.profiles.map((function(e){return _l(e)})),size:"m",visibleCount:3,layout:"vertical"},C.profiles.slice(0,3).map((function(e){return e.first_name})).join(", ")," ",C.profiles.length>3?B(C.profiles.length-3,"vkui_edu_call_join_people"):""),i.a.createElement(l.r,{style:{marginTop:16}},i.a.createElement(l.i,{size:"m",stretched:!0,before:i.a.createElement(cl.a,null),onClick:function(){return R(!0)}},T("vkui_edu_call_join_with_video")),i.a.createElement(l.i,{size:"m",mode:"secondary",before:i.a.createElement(ul.a,null),stretched:!0,style:{marginTop:8},onClick:function(){return R(!1)}},T("vkui_edu_call_join_with_audio"))))),!w&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.u,{status:j?"default":"error",bottom:T("vkui_edu_call_join_input_info"),style:{marginBottom:12,marginTop:-24}},i.a.createElement(l.I,{placeholder:T("vkui_edu_call_join_input_placeholder"),onChange:function(e){var t=e.target.value;F(t);var n=A.test(t);j!==n&&k(n)},value:S})),i.a.createElement(l.r,{style:{marginBottom:32}},i.a.createElement(l.i,{size:"m",stretched:!0,before:i.a.createElement(cl.a,null),onClick:function(){return R(!0)}},T("vkui_edu_call_join_with_video")),i.a.createElement(l.i,{size:"m",mode:"secondary",before:i.a.createElement(ul.a,null),stretched:!0,style:{marginTop:8},onClick:function(){return R(!1)}},T("vkui_edu_call_join_with_audio")),i.a.createElement(l.i,{mode:"tertiary",size:"m",stretched:!0,style:{marginTop:24},onClick:function(){p(),r()}},T("vkui_edu_promo_submit"))))))})),{viewWidth:!0});function _l(e){return e.photo_200||e.photo_100||e.photo_400||e.photo_400_orig||""}var ml=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},fl=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},bl=function(e){var t=e.id,n=e.params,a=ml(e,["id","params"]),c=!n.joinLink&&n.peerId,s=Object(p.i)(),d=Object(g.b)().accountInfo,_=Object(u.c)().getLangKey,m=Object(o.useContext)(v.a),f=m.showSnackbar,b=m.apiRequest,h=m.onCallJoinByLink,E=m.showErrorMessage,C=m.onCallUser,y=m.onCallGroup,O=!0===Object(o.useRef)(null!==Object(ye.a)(Oe.p)).current,j=fl(Object(o.useState)(!O),2),k=j[0],D=j[1],S=Object(o.useRef)(null);aa.d.OS===aa.c.MAC?S.current={url:xi.e[aa.c.MAC],filename:xi.f[aa.c.MAC]}:aa.d.OS===aa.c.WINDOWS&&(S.current={url:xi.e[aa.c.WINDOWS],filename:xi.f[aa.c.WINDOWS]});var F=null!==S.current,x=fl(Object(o.useState)(!F&&!O),2),A=x[0],w=x[1],N=function(){return c?Object(Si.a)(Object(Fi.b)({peerId:n.peerId,userId:d.id})):Object(Si.a)(Object(Fi.a)({joinLink:n.joinLink,userId:d.id}))},I=function(){Object(ye.c)(Oe.p,"true")};return Object(o.useEffect)((function(){N().then((function(){D(!1)})).catch((function(){var e,t;F&&!O?(e=S.current.url,t=S.current.filename,f(i.a.createElement(kt.a,null,_("vkui_edu_download_file_snippet").replace("{filename}",t)),{before:aa.d.isChromeBased&&i.a.createElement(ji.a,{className:"JoinCallModal__snackbarIcon"}),duration:1e4,onClose:function(){return null}}),I(),Object(Di.a)(e,t),setTimeout((function(){D(!1)}),5e3)):D(!1)}))}),[]),i.a.createElement(l.M,r()({id:t,header:_(k&&F?"vkui_edu_download_started":O?"vkui_edu_calls_title":c?"vkui_edu_start_message_call_after_install_app":"vkui_edu_join_message_call_after_install_app"),subheader:A?_("vkui_edu_download_and_install_app_for_pc"):O?_(c?"vkui_edu_try_manual_start_call":"vkui_edu_try_manual_join_call"):k?_("vkui_edu_wait_until_app_downloaded"):"",icon:i.a.createElement(ki,null),className:"JoinCallModal"},a),k&&F?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.ob,{size:"large",className:"JoinCallModal__action"}),i.a.createElement("div",{className:"JoinCallModal__text"},_("vkui_edu_downloading_file").replace("{file}",S.current.filename))):A?i.a.createElement(l.i,{size:"l",before:i.a.createElement(ji.a,null),href:Oa.a,target:"_blank",onClick:function(){I(),w(!1)},className:"JoinCallModal__action"},_("vkui_edu_download_app")):i.a.createElement(l.i,{mode:"secondary",size:"l",before:i.a.createElement(Jn.a,null),onClick:N,className:"JoinCallModal__action"},_(c?"vkui_edu_calls_start_call":"vkui_edu_calls_join_call")),!A&&i.a.createElement(l.rb,{weight:"regular",className:"JoinCallModal__text"},i.a.createElement("div",null,_("vkui_edu_apps_for_all_platform")),i.a.createElement(l.J,{href:Oa.a,target:"_blank"},_("vkui_edu_open_app_list"))),i.a.createElement(l.rb,{weight:"regular",className:"JoinCallModal__text"},_("vkui_edu_calls_troubles_with_app"),i.a.createElement(l.J,{onClick:function(){if(s){var e=n.joinLink,t=n.peerId,a=n.isGroup,r=n.peerTitle,o=n.peerPhoto;(e||t)&&(c&&(a?y(t,{peerId:t,name:r,photo:o,tab:r}):C(t,r)),e?h(t,e):b("messages.getConversationsById",{peer_ids:String(t)}).then((function(e){var n=e.items[0].call_in_progress.join_link;h(t,n)})))}else E(_("vkui_edu_unsupported_calls_browser"))}},_(c?"vkui_edu_calls_start_call_in_browser":"vkui_edu_calls_join_call_in_browser"))))};function hl(e){var t=e.activeModal,n=e.back,a=e.hideModal,o=e.getRouteSchoolId,u=e.params,s=e.getModalProps;return i.a.createElement(l.P,{activeModal:t},i.a.createElement(xe,{id:c.g.REGISTRATION_STEP_1,dynamicContentHeight:!0,onClose:a}),i.a.createElement(mt,{id:c.g.REGISTRATION_STEP_2,dynamicContentHeight:!0,onClose:a}),i.a.createElement(Ue,{id:c.g.REGISTRATION_TEACHER,dynamicContentHeight:!0,onClose:a}),i.a.createElement(nt,r()({id:c.g.ONBOARDING,onClose:a},u[c.g.ONBOARDING])),i.a.createElement(pt,{id:c.g.REGISTRATION_ADMIN,dynamicContentHeight:!0,onClose:a}),i.a.createElement(Ct,{id:c.g.CHAT_ACCESS_RESTRICTED,onClose:a}),i.a.createElement(Uo,{id:c.g.CREATE_CALL,onClose:a}),i.a.createElement(pi,{id:c.g.CREATE_CALL_LESSON,dynamicContentHeight:!0,onClose:c.b.closeModal}),i.a.createElement(Oi,{id:c.g.CALLS_LIST_MODAL,onClose:c.b.closeModal}),i.a.createElement(ga,{id:c.g.SCHOOL_EXTENDED_INFO,onClose:a,dynamicContentHeight:!0,schoolId:o(c.g.SCHOOL_EXTENDED_INFO)}),i.a.createElement(Pn,{id:c.g.SELECT_COUNTRY,onClose:n,dynamicContentHeight:!0}),i.a.createElement(zn,{id:c.g.SELECT_CITY,onClose:n,dynamicContentHeight:!0}),i.a.createElement(N,{id:c.g.EDIT_MEMBER,dynamicContentHeight:!0,onClose:n,params:u[c.g.EDIT_MEMBER]}),i.a.createElement(W,{id:c.g.SELECT_SCHOOL,dynamicContentHeight:!0,onClose:n}),i.a.createElement(ce,{id:c.g.SELECT_CLASSES,dynamicContentHeight:!0,onClose:n}),i.a.createElement(Lt,{id:c.g.DOCUMENT_EDIT,onClose:a,dynamicContentHeight:!0}),i.a.createElement(Ko,{id:c.g.CONVERSATION,onClose:a,dynamicContentHeight:!0}),i.a.createElement(Xt,r()({id:c.g.CREATE_GRADE,onClose:a},s(c.g.CREATE_GRADE))),i.a.createElement(An,r()({id:c.g.SELECT_PARTICIPANTS,onClose:a,dynamicContentHeight:!0},s(c.g.SELECT_PARTICIPANTS))),i.a.createElement(In,{id:c.g.DOCUMENT_UPLOAD,onClose:a}),i.a.createElement(Do,{id:c.g.VIDEO_EDIT,onBack:c.b.back,onClose:c.b.closeModal,params:u[c.g.VIDEO_EDIT],dynamicContentHeight:!0}),i.a.createElement(go,{id:c.g.VIDEO_UPLOAD,onClose:c.b.closeModal}),i.a.createElement(la,r()({id:c.g.PROFILE_COMPACT,onClose:a,dynamicContentHeight:!0},u[c.g.PROFILE_COMPACT])),i.a.createElement(Na,{id:c.g.PROFILE_ADD_SCHOOL,dynamicContentHeight:!0,onClose:c.b.closeModal}),i.a.createElement(Zi,{id:c.g.JOIN_SCHOOL,dynamicContentHeight:!0,onClose:c.b.closeModal}),i.a.createElement(ol,{id:c.g.JOIN_SCHOOL_TEACHER,dynamicContentHeight:!0,onClose:c.b.closeModal}),i.a.createElement(al,{id:c.g.WRONG_INVITE,dynamicContentHeight:!0,onClose:c.b.closeModal}),i.a.createElement(Ia,r()({id:c.g.PROFILE_EDIT_SCHOOL,onClose:a,dynamicContentHeight:!0},u[c.g.PROFILE_EDIT_SCHOOL])),i.a.createElement(Fa,r()({id:c.g.MESSAGES_EXTERNAL,onClose:a,dynamicContentHeight:!0},u[c.g.MESSAGES_EXTERNAL])),i.a.createElement(Ua,{id:c.g.CREATE_CHAT,dynamicContentHeight:!0,onClose:a}),i.a.createElement(Ja,{id:c.g.SELECT_CHAT_MEMEBERS,dynamicContentHeight:!0,onClose:a}),i.a.createElement(_r,{id:c.g.CHAT_ADD_MEMEBERS,dynamicContentHeight:!0,onClose:a}),i.a.createElement(jr,{id:c.g.CHAT_INFO,onClose:a,dynamicContentHeight:!0}),i.a.createElement(Lr,{id:c.g.CHAT_INFO_LINK,onClose:a,dynamicContentHeight:!0}),i.a.createElement(Br,{id:c.g.EDIT_CHAT_INFO,onClose:a}),i.a.createElement(Gr,{dynamicContentHeight:!0,id:c.g.CHAT_ATTACHMENTS,onClose:a,params:u[c.g.CHAT_ATTACHMENTS]}),i.a.createElement(bo,{id:c.g.USER_SCHEDULE,onClose:a,dynamicContentHeight:!0}),i.a.createElement(Yo,{id:c.g.INVITE_LINK_CREATE,onClose:a,dynamicContentHeight:!0}),i.a.createElement(ii,{id:c.g.QR_CODE_PREVIEW,onClose:a,dynamicContentHeight:!0}),i.a.createElement(_i,{id:c.g.SEARCH_FILTERS,onClose:a,dynamicContentHeight:!0}),i.a.createElement(Ft,{id:c.g.PRIVACY,onClose:a,dynamicContentHeight:!0}),i.a.createElement(It,{id:c.g.TERMS,onClose:a,dynamicContentHeight:!0}),i.a.createElement(Mi,{id:c.g.JOIN_CALL,onClose:c.b.closeModal,params:u[c.g.JOIN_CALL]}),i.a.createElement(bl,{id:c.g.JOIN_MESSAGE_CALL,onClose:c.b.closeModal,params:u[c.g.JOIN_MESSAGE_CALL]}),i.a.createElement(Pi,{id:c.g.MOBILE_JOIN_CALL,onClose:c.b.closeModal,params:u[c.g.MOBILE_JOIN_CALL]}),i.a.createElement(Hi,{id:c.g.DOWNLOAD_APP_MODAL,onClose:a,params:u[c.g.DOWNLOAD_APP_MODAL]}),i.a.createElement(Vi,{id:c.g.DOWNLOAD_APP_SELECT_MODAL,onClose:a}),i.a.createElement(dl,r()({id:c.g.CALL_JOIN,onClose:c.b.closeModal,dynamicContentHeight:!0},u[c.g.CALL_JOIN])))}}}]);